<!DOCTYPE html><html><head><title>Codedoc | ADReportingTools</title><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"><meta name="robots" content="index,follow"><meta name="theme-color" content="#212121"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><link rel="shortcut icon" href="/codedoc/docs/images/KostweinLogo.ico"><link href="https://fonts.googleapis.com/css?family=Roboto:300,400&amp;display=swap" rel="stylesheet"><link href="https://fonts.googleapis.com/css?family=Source+Code+Pro:300,400&amp;display=swap" rel="stylesheet"><link href="https://fonts.googleapis.com/icon?family=Material+Icons%7CMaterial+Icons+Outlined&amp;display=swap" rel="stylesheet"><style>
      body, input, button {
        font-family: 'Roboto', sans-serif;
      }

      code, .hljs {
        font-family: 'Source Code Pro', 'Courier New', Courier, monospace;
      }

      .icon-font {
        font-family: 'Material Icons';
        font-weight: normal;
        font-style: normal;
        font-size: 24px;  /* Preferred icon size */
        display: inline-block;
        line-height: 1;
        text-transform: none;
        letter-spacing: normal;
        word-wrap: normal;
        white-space: nowrap;
        direction: ltr;
      
        /* Support for all WebKit browsers. */
        -webkit-font-smoothing: antialiased;
        /* Support for Safari and Chrome. */
        text-rendering: optimizeLegibility;
      
        /* Support for Firefox. */
        -moz-osx-font-smoothing: grayscale;
      
        /* Support for IE. */
        font-feature-settings: 'liga';
      }

      .icon-font.outline {
        font-family: 'Material Icons Outlined';
      }
    </style><link href="/codedoc/docs/assets/codedoc-styles.css" rel="stylesheet"><script async="" defer="" src="/codedoc/docs/assets/codedoc-bundle.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css" integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq" crossorigin="anonymous"></head><body data-path="docs\PSModulesHelp\ADReportingTools\README.md"><div class="header-0-0-6"><script async="" defer="" src="https://buttons.github.io/buttons.js"></script><a class="github-button" data-color-scheme="no-preference: light; light: light; dark: dark;" data-icon="false" data-show-count="true" data-size="false" href="https://github.com/In-Pro-Org/codedoc/">Star</a><br><br><a class="watermark-0-0-5" href="https://github.com/CONNECT-platform/codedoc" target="_blank">Created With<svg viewBox="0 0 536 296" version="1.1" xmlns="http://www.w3.org/2000/svg"><g id="codedoc" transform="translate(-244.000000, -364.000000)" fill-rule="nonzero"><path d="M580,532 C615.346224,532 644,560.653776 644,596 C644,631.346224 615.346224,660 580,660 C544.653776,660 516,631.346224 516,596 C516,560.653776 544.653776,532 580,532 Z M716,532 C751.346224,532 780,560.653776 780,596 C780,631.346224 751.346224,660 716,660 L692,660 C687.581722,660 684,656.418278 684,652 C684,647.581722 687.581722,644 692,644 L716,644 C742.509668,644 764,622.509668 764,596 C764,569.490332 742.509668,548 716,548 L692,548 C687.581722,548 684,544.418278 684,540 C684,535.581722 687.581722,532 692,532 L716,532 Z M468,532 C472.418278,532 476,535.581722 476,540 L476,652 C476,656.418278 472.418278,660 468,660 L444,660 C408.653776,660 380,631.346224 380,596 C380,560.653776 408.653776,532 444,532 L468,532 Z M332,532 C336.418278,532 340,535.581722 340,540 L340,652 C340,656.418278 336.418278,660 332,660 L252,660 C247.581722,660 244,656.418278 244,652 L244,540 C244,535.581722 247.581722,532 252,532 L332,532 Z M580,548 C553.490332,548 532,569.490332 532,596 C532,622.509668 553.490332,644 580,644 C606.509668,644 628,622.509668 628,596 C628,569.490332 606.509668,548 580,548 Z M461,548 L444,548 C417.490332,548 396,569.490332 396,596 C396,622.509668 417.490332,644 444,644 L461,644 L461,548 Z M444,364 C479.346224,364 508,392.653776 508,428 C508,463.346224 479.346224,492 444,492 C408.653776,492 380,463.346224 380,428 C380,392.653776 408.653776,364 444,364 Z M332,364 C336.418278,364 340,367.581722 340,372 C340,376.418278 336.418278,380 332,380 L308,380 C281.490332,380 260,401.490332 260,428 C260,454.509668 281.490332,476 308,476 L332,476 C336.418278,476 340,479.581722 340,484 C340,488.418278 336.418278,492 332,492 L308,492 C272.653776,492 244,463.346224 244,428 C244,392.653776 272.653776,364 308,364 L332,364 Z M580,364 C615.346224,364 644,392.653776 644,428 C644,463.346224 615.346224,492 580,492 L556,492 C551.581722,492 548,488.418278 548,484 L548,372 C548,367.581722 551.581722,364 556,364 L580,364 Z M772,364 C776.418278,364 780,367.581722 780,372 C780,376.418278 776.418278,380 772,380 L700,380 L700,420 L772,420 C776.418278,420 780,423.581722 780,428 C780,432.418278 776.418278,436 772,436 L700,436 L700,476 L772,476 C776.418278,476 780,479.581722 780,484 C780,488.418278 776.418278,492 772,492 L692,492 C687.581722,492 684,488.418278 684,484 L684,372 C684,367.581722 687.581722,364 692,364 L772,364 Z M444,380 C417.490332,380 396,401.490332 396,428 C396,454.509668 417.490332,476 444,476 C470.509668,476 492,454.509668 492,428 C492,401.490332 470.509668,380 444,380 Z M580,380 L563,380 L563,476 L580,476 C606.509668,476 628,454.509668 628,428 C628,401.490332 606.509668,380 580,380 Z"></path></g></svg></a></div><div id="-codedoc-container" class="container"><h1 id="adreportingtools" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>ADReportingTools</h1><p><img src="https://img.shields.io/powershellgallery/v/ADReportingTools.png?style=plastic&amp;logo=powershell&amp;label=PowerShell%20Gallery" alt="PSGallery Version"><img src="https://img.shields.io/powershellgallery/dt/ADReportingTools.png?style=plastic&amp;&amp;logo=powershell&amp;label=Downloads" alt="PSGallery Downloads"></p><p><img src="images/2PopulatedDomain01.png" alt="ActiveDirectory"></p><p>This module contains a collection of PowerShell tools that you can use to generate reports and gather information about your Active Directory domain. Many of these commands will require the ActiveDirectory module, which you can get by installing the <a href="https://docs.microsoft.com/troubleshoot/windows-server/system-management-components/remote-server-administration-tools">Remote Server Administration Tools (RSAT)</a> for Active Directory on Windows 10.</p><pre class=""><code class="powershell -codedoc-code-snippet code-0-0-12" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span></span></span><div class="line-0-0-16  -codedoc-code-line" data-content="Get-WindowsCapability -Online -Name RSAT.Active* | Add-WindowsCapability -online" id="code1-l1"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">1<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token function">Get-WindowsCapability</span> <span class="token operator">-</span>Online <span class="token operator">-</span>Name RSAT<span class="token punctuation">.</span>Active* <span class="token punctuation">|</span> <span class="token function">Add-WindowsCapability</span> <span class="token operator">-</span>online</div><br></code></pre><p>The assumption is that you will run these commands with administrator credentials from a Windows 10 desktop. You should not need console access to a domain controller. Athough some module commands will use PowerShell remoting over WSMAN to gather information. These commands are designed to work with a <strong>local</strong> Active Directory infrastructure, not anything in Azure.</p><h2 id="installation" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>Installation</h2><p>This module is available in the PowerShell Gallery. Install it with <code>Install-Module</code> after you have installed the Active Directory RSAT capability.</p><pre class=""><code class="powershell -codedoc-code-snippet code-0-0-12" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span></span></span><div class="line-0-0-16  -codedoc-code-line" data-content="Install-Module -name ADReportingTools -force" id="code2-l1"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">1<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token function">Install-Module</span> <span class="token operator">-</span>name ADReportingTools <span class="token operator">-</span>force</div><br></code></pre><p>Once installed, you can run a command like <code>Get-ADReportingTools</code> to see list of commands. Or run <code>Open-ADReportingToolsHelp</code> to launch a PDF version of this file, as well as command documentation.</p><h2 id="design-philosophy" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>Design Philosophy</h2><p>The Active Directory module from Microsoft is not especially difficult to use. It is quite easy to get information from Active Directory.</p><pre class=""><code class="powershell -codedoc-code-snippet code-0-0-12" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span></span></span><div class="line-0-0-16  -codedoc-code-line" data-content="Get-ADuser -filter &quot;department -eq 'sales'&quot; -properties Title,Department" id="code3-l1"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">1<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token function">Get-ADuser</span> <span class="token operator">-</span><span class="token keyword">filter</span> <span class="token string">"department -eq 'sales'"</span> <span class="token operator">-</span>properties Title<span class="token punctuation">,</span>Department</div><br></code></pre><p>However, you have to be very explicit about what information you want to see. You might need to create complicated filters. You need to know the Active Directory property names. Finally, you need to format the results into something meaningful. It might be better to think of the ActiveDirectory module as a <em>framework</em>.</p><p>The ADReportingTools module is built on this framework. The goal is to create a set of commands and tools to make it very easy to get information out of Active Directory in meaningful and useful ways. Many of the functions in this module are wrappers for underlying ActiveDirectory module commands, written to be easy to use.</p><p>The ADReportingTools focuses primarily on working with Active Directory users, groups, and computers. The module includes commands designed to be true reporting commands. As the module name suggests, module commands are intended to <strong><em>get</em></strong> information from Active Directory. This module is not designed to manage it. There are <strong>no</strong> commands to set, create, or remove anything from Active Directory.</p><p>:warning:
<strong>These commands have not been tested in a large domain environment, or one with cross-domain trusts and/or nested groups that cross domains. If you have used the ActiveDirectory modules in the past and had poor performance due to these types of circumstances, the modules in this command most likely won't perform any better because they are still relying on the same Active Directory cmdlets..</strong></p><h2 id="module-commands" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>Module Commands</h2><p>The commands in this module, and may of the supporting files, are intended to be run from a PowerShell console host session. If you run some commands in the PwoerShell ISE or VS Code, you may see a warning about an incompatibility or your may have a poor experience. <em>There is no intention of making this module 100% compatible with the ISE or VSCode.</em></p><h3 id="get-adreportingtools" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span><a href="docs/Get-ADReportingTools.md">Get-ADReportingTools</a></h3><p><code>Get-ADReportingTools</code> is a meta-command. Run this command to get a formatted list of available commands in the ADReportingTools module.</p><p><img src="images/get-adreportingtools.png" alt="ADReportingTools"></p><h3 id="open-adreportingtoolshelp" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span><a href="docs/Open-ADReportingToolsHelp.md">Open-ADReportingToolsHelp</a></h3><p>All module documentation, including this README and command help, has been compiled into a PDF. Run <code>Open-ADReportingToolsHelp</code> to view the file.</p><p><img src="images/open-adreportingtoolshelp.png" alt="ADReportingToolsHelp"></p><p>The command will launch the application associated with PDF files.</p><h3 id="users" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>Users</h3><p><img src="images/Users01.png" alt="adusers"></p><h4 id="get-adcanonicaluser" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span><a href="docs/Get-ADCanonicalUser.md">Get-ADCanonicalUser</a></h4><p>Often you will find user names in the form domain\username. This command makes it easier to find the Active Directory user account using this value. If the Active Directory Recycle Bin feature is enabled, you can use the <code>IncludeDeletedObjects</code> parameter to search for the user account if it can't be found with the initial search.</p><p><img src="images/get-adcanonicaluser.png" alt="Get-ADCanonicalUser"></p><h4 id="get-aduseraudit" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span><a href="docs/Get-ADUserAudit.md">Get-ADUserAudit</a></h4><p>This command will search the Security event logs on your domain controllers for specific user-related events. These activities are not replicated, so you have to search each domain controller. Be aware that you may see related events for some actions. For example, if you create and enable a new user, you'll see multiple entries for the same event.</p><p>The output will show you the user accounts that match the search criteria, and the domain account that was responsible. Although, this command can't tell you which administrator is responsible for which activity. The best you can learn is that for a given time frame, these user accounts were managed. Or these administrators did something. You would need to search the event log on the domain controller for more information.</p><p><img src="images/get-aduseraudit.png" alt="Get-ADUserAudit"></p><h4 id="get-adusercategory" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span><a href="docs/Get-ADUserCategory.md">Get-ADUserCategory</a></h4><p><code>Get-ADUserCategory</code> is based on the concept of getting user information from a pre-defined category. For example, you might want to get the properties DisplayName, Name, Title, Department, and Manager for a Department category. The ADReportingTools module will define a set of pre-defined categories that you can reference through <code>$ADUserReportingConfiguration</code>.</p><pre class="with-bar"><code class="shell -codedoc-code-snippet code-0-0-12" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span></span></span><div class="line-0-0-16  -codedoc-code-line" data-content="PS C:\> $ADUserReportingConfiguration" id="code4-l1"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">1<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>PS C:<span class="token punctuation">\</span><span class="token operator">&gt;</span> <span class="token variable">$ADUserReportingConfiguration</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="" id="code4-l2"><span class="lineCounter-0-0-13 -codedoc-line-counter">2<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="Name         Properties" id="code4-l3"><span class="lineCounter-0-0-13 -codedoc-line-counter">3<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>Name         Properties</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="----         ----------" id="code4-l4"><span class="lineCounter-0-0-13 -codedoc-line-counter">4<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>----         ----------</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="Department   {DisplayName, Name, Title, Department...}" id="code4-l5"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">5<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>Department   <span class="token punctuation">{</span>DisplayName, Name, Title, Department<span class="token punctuation">..</span>.<span class="token punctuation">}</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="Basic        {DisplayName, Name, SamAccountname, UserPrincipalName...}" id="code4-l6"><span class="lineCounter-0-0-13 -codedoc-line-counter">6<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>Basic        <span class="token punctuation">{</span>DisplayName, Name, SamAccountname, UserPrincipalName<span class="token punctuation">..</span>.<span class="token punctuation">}</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="Address      {DisplayName, Name, TelephoneNumber, Office...}" id="code4-l7"><span class="lineCounter-0-0-13 -codedoc-line-counter">7<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>Address      <span class="token punctuation">{</span>DisplayName, Name, TelephoneNumber, Office<span class="token punctuation">..</span>.<span class="token punctuation">}</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="Organization {DisplayName, Name, Title, Department...}" id="code4-l8"><span class="lineCounter-0-0-13 -codedoc-line-counter">8<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>Organization <span class="token punctuation">{</span>DisplayName, Name, Title, Department<span class="token punctuation">..</span>.<span class="token punctuation">}</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="Pwinfo       {DisplayName, Name, PasswordExpired, PasswordLastSet...}" id="code4-l9"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">9<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>Pwinfo       <span class="token punctuation">{</span>DisplayName, Name, PasswordExpired, PasswordLastSet<span class="token punctuation">..</span>.<span class="token punctuation">}</span></div><br></code></pre><p><img src="images/get-adusercategory.png" alt="Get-ADUserCategory"></p><p>The module ships with a JSON file that defines the categories. You can easily modify this variable to define a new category.</p><pre class=""><code class="powershell -codedoc-code-snippet code-0-0-12" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span></span></span><div class="line-0-0-16  -codedoc-code-line" data-content="$ADUserReportingConfiguration += [pscustomobject]@{Name=&quot;Custom&quot;;Properties=&quot;DisplayName&quot;,&quot;Description&quot;}" id="code5-l1"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">1<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token variable">$ADUserReportingConfiguration</span> <span class="token operator">+=</span> <span class="token namespace">[pscustomobject]</span>@<span class="token punctuation">{</span>Name=<span class="token string">"Custom"</span><span class="token punctuation">;</span>Properties=<span class="token string">"DisplayName"</span><span class="token punctuation">,</span><span class="token string">"Description"</span><span class="token punctuation">}</span></div><br></code></pre><p>Or add a property to an existing category.</p><pre class="with-bar"><code class="shell -codedoc-code-snippet code-0-0-12" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span></span></span><div class="line-0-0-16  -codedoc-code-line" data-content="PS C:\> $ADUserReportingConfiguration.where({$_.name -eq 'basic'}).foreach({$_.properties+=&quot;SID&quot;})" id="code6-l1"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">1<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>PS C:<span class="token punctuation">\</span><span class="token operator">&gt;</span> <span class="token variable">$ADUserReportingConfiguration</span>.where<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token variable">$_</span>.name -eq <span class="token string">'basic'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>.foreach<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token variable">$_</span>.properties<span class="token operator">+=</span><span class="token string">"SID"</span><span class="token punctuation">}</span><span class="token punctuation">)</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="PS C:\> Get-ADUserCategory gladysk -Category Basic" id="code6-l2"><span class="lineCounter-0-0-13 -codedoc-line-counter">2<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>PS C:<span class="token punctuation">\</span><span class="token operator">&gt;</span> Get-ADUserCategory gladysk -Category Basic</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="" id="code6-l3"><span class="lineCounter-0-0-13 -codedoc-line-counter">3<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="" id="code6-l4"><span class="lineCounter-0-0-13 -codedoc-line-counter">4<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="DistinguishedName : CN=GladysK,OU=IT,DC=Company,DC=Pri" id="code6-l5"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">5<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>DistinguishedName <span class="token builtin class-name">:</span> <span class="token assign-left variable">CN</span><span class="token operator">=</span>GladysK,OU<span class="token operator">=</span>IT,DC<span class="token operator">=</span>Company,DC<span class="token operator">=</span>Pri</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="DisplayName       : Gladys Kravitz" id="code6-l6"><span class="lineCounter-0-0-13 -codedoc-line-counter">6<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>DisplayName       <span class="token builtin class-name">:</span> Gladys Kravitz</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="Name              : GladysK" id="code6-l7"><span class="lineCounter-0-0-13 -codedoc-line-counter">7<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>Name              <span class="token builtin class-name">:</span> GladysK</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="SamAccountname    : GladysK" id="code6-l8"><span class="lineCounter-0-0-13 -codedoc-line-counter">8<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>SamAccountname    <span class="token builtin class-name">:</span> GladysK</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="UserPrincipalName : gladysk@Company.Pri" id="code6-l9"><span class="lineCounter-0-0-13 -codedoc-line-counter">9<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>UserPrincipalName <span class="token builtin class-name">:</span> gladysk@Company.Pri</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="Enabled           : True" id="code6-l10"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">10<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>Enabled           <span class="token builtin class-name">:</span> True</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="WhenCreated       : 1/25/2021 1:32:35 PM" id="code6-l11"><span class="lineCounter-0-0-13 -codedoc-line-counter">11<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>WhenCreated       <span class="token builtin class-name">:</span> <span class="token number">1</span>/25/2021 <span class="token number">1</span>:32:35 PM</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="WhenChanged       : 3/8/2021 6:52:01 PM" id="code6-l12"><span class="lineCounter-0-0-13 -codedoc-line-counter">12<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>WhenChanged       <span class="token builtin class-name">:</span> <span class="token number">3</span>/8/2021 <span class="token number">6</span>:52:01 PM</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="SID               : S-1-5-21-493037332-564925384-1585924867-1105" id="code6-l13"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">13<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>SID               <span class="token builtin class-name">:</span> S-1-5-21-493037332-564925384-1585924867-1105</div><br></code></pre><p>The user's distinguished name is always included in the output.</p><h4 id="get-addepartment" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span><a href="docs/Get-ADDepartment.md">Get-ADDepartment</a></h4><p>A related command is <code>Get-ADDepartment</code>. This command will get members of a given department. When you import the ADReportingTools module, it will define a global variable called <code>ADReportingHash,</code> which is a hashtable. The variable has a key called <code>Departments</code>. This variable is used in an argument completer for the <code>Department</code> parameter so that you can tab-complete the parameter value.</p><p><img src="images/get-addept.png" alt="Get-ADDepartment"></p><p>Disabled accounts will be displayed in red. Or you can use one of the custom views.</p><p><img src="images/get-addept-manager.png" alt="Get-ADDepartment Manager"></p><h4 id="split-distinguishedname" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span><a href="docs/Split-DistinguishedName.md">Split-DistinguishedName</a></h4><p>This command will take an Active Directory distinguishedname and break it down into its component elements. The command does not test or verify any of the elements. It is merely parsing a text string.</p><pre class="with-bar"><code class="shell -codedoc-code-snippet code-0-0-12" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span></span></span><div class="line-0-0-16  -codedoc-code-line" data-content="PS C:\> Split-DistinguishedName &quot;CN=Foo,OU=Bar,OU=Oz,DC=Research,DC=Globomantics,DC=com&quot;" id="code7-l1"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">1<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>PS C:<span class="token punctuation">\</span><span class="token operator">&gt;</span> Split-DistinguishedName <span class="token string">"CN=Foo,OU=Bar,OU=Oz,DC=Research,DC=Globomantics,DC=com"</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="" id="code7-l2"><span class="lineCounter-0-0-13 -codedoc-line-counter">2<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="" id="code7-l3"><span class="lineCounter-0-0-13 -codedoc-line-counter">3<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="Name      : Foo" id="code7-l4"><span class="lineCounter-0-0-13 -codedoc-line-counter">4<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>Name      <span class="token builtin class-name">:</span> Foo</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="Branch    : Bar" id="code7-l5"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">5<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>Branch    <span class="token builtin class-name">:</span> Bar</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="BranchDN  : OU=Bar,OU=Oz,DC=Research,DC=Globomantics,DC=com" id="code7-l6"><span class="lineCounter-0-0-13 -codedoc-line-counter">6<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>BranchDN  <span class="token builtin class-name">:</span> <span class="token assign-left variable">OU</span><span class="token operator">=</span>Bar,OU<span class="token operator">=</span>Oz,DC<span class="token operator">=</span>Research,DC<span class="token operator">=</span>Globomantics,DC<span class="token operator">=</span>com</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="Domain    : Research" id="code7-l7"><span class="lineCounter-0-0-13 -codedoc-line-counter">7<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>Domain    <span class="token builtin class-name">:</span> Research</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="DomainDN  : DC=Research,DC=Globomantics,DC=com" id="code7-l8"><span class="lineCounter-0-0-13 -codedoc-line-counter">8<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>DomainDN  <span class="token builtin class-name">:</span> <span class="token assign-left variable">DC</span><span class="token operator">=</span>Research,DC<span class="token operator">=</span>Globomantics,DC<span class="token operator">=</span>com</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="DomainDNS : Research.Globomantics.com" id="code7-l9"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">9<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>DomainDNS <span class="token builtin class-name">:</span> Research.Globomantics.com</div><br></code></pre><h3 id="groups" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>Groups</h3><p><img src="images/Collection_DomainGroup01.png" alt="adgroups"></p><h4 id="get-adgroupuser" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span><a href="docs/Get-ADGroupUser.md">Get-ADGroupUser</a></h4><p>The <code>Get-ADGroupUser</code> command will display all users of a given Active Directory group. The search is automatically recursive. The default output is a formatted table that will highlight disabled accounts in red. The ANSI color coding will only work in a console session.</p><p><img src="images/get-adgroupuser.png" alt="Get-ADGroupUser"></p><p>Or you can use the default list view.</p><p><img src="images/get-adgroupuser-list.png" alt="Get-ADGroupUser list"></p><h4 id="get-adgroupreport" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span><a href="docs/Get-ADGroupReport.md">Get-ADGroupReport</a></h4><p><code>Get-ADGroupReport</code> will create a custom report for a group showing members. <code>Get-ADGroupUser</code> is intended to display group membership details <code>Get-ADGroupReport</code> focuses on the group, although members are also displayed. Members are always gathered recursively. You can filter for specific types of groups. You can also opt to exclude groups under CN=Users and CN=BuiltIn. The groups "Domain Users", "Domain Computers", and "Domain Guests" are always excluded from this command.</p><p><img src="images/get-adgroupreport.png" alt="get-adgroupreport"></p><p>If your PowerShell hosts supports it, ANSI color schemes will be used to highlight things such as Distribution groups and disabled user accounts.</p><p>You can also use a custom table view.</p><p><img src="images/get-adgroupreport-age.png" alt="get-adgroupreport age"></p><p>Distribution groups will be shown in green and member counts of 0 in red. The Age reflects how long since the group has been modified.</p><h3 id="computers" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>Computers</h3><p><img src="images/ComputerAccount01.png" alt="adcomputers"></p><h4 id="get-adcomputerreport" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span><a href="docs/Get-ADComputerReport.md">Get-ADComputerReport</a></h4><p><code>Get-ADComputerReport</code> will gather information about computer objects in Active Directory.</p><p><img src="images/get-adcomputerreport.png" alt="get-adcomputerreport"></p><p>If you are running in a PowerShell console, domain controllers and member servers will be highlighted with an ANSI sequence. Disabled computer accounts will be displayed in red. The default command behavior is to find all computer objects. But you can search name or filter on a category of Server or Desktop. The filtering is based on the operating system value.</p><p>The associated formatting for this command has several named table views. You should sort on the key property first. You can try commands like this:</p><pre class="with-bar"><code class="powershell -codedoc-code-snippet code-0-0-12" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span></span></span><div class="line-0-0-16  -codedoc-code-line" data-content="Get-ADComputerReport | Sort OperatingSystem | Format-Table -view os" id="code8-l1"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">1<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token function">Get-ADComputerReport</span> <span class="token punctuation">|</span> <span class="token function">Sort</span> OperatingSystem <span class="token punctuation">|</span> <span class="token function">Format-Table</span> <span class="token operator">-</span>view os</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="Get-ADComputerReport | Sort location | Format-Table -view location" id="code8-l2"><span class="lineCounter-0-0-13 -codedoc-line-counter">2<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token function">Get-ADComputerReport</span> <span class="token punctuation">|</span> <span class="token function">Sort</span> location <span class="token punctuation">|</span> <span class="token function">Format-Table</span> <span class="token operator">-</span>view location</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="Get-ADComputerReport | Sort ManagedBy | Format-Table -view managed" id="code8-l3"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">3<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token function">Get-ADComputerReport</span> <span class="token punctuation">|</span> <span class="token function">Sort</span> ManagedBy <span class="token punctuation">|</span> <span class="token function">Format-Table</span> <span class="token operator">-</span>view managed</div><br></code></pre><h4 id="get-addomaincontrollerhealth" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span><a href="docs/Get-ADDomainControllerHealth.md">Get-ADDomainControllerHealth</a></h4><p><code>Get-ADDomainControllerHealth</code> is intended to give you a quick summary of the overall health of your Active Directory domain controllers. The concept of "health" is based on the following:</p><ul><li>How much free space remains on drive C:?</li><li>How much free physical memory?</li><li>What percentage of the Security event log is in use?</li><li>Are any critical services not running? The services checked are ntds,kdc,adws,dfs,dfsr,netlogon,samss, and w32time. Not every organization runs DNS and/or DHCP on their domain controllers, so those services have been omitted.</li></ul><p>Output will be color-coded using ANSI escape sequences, if the PowerShell session supports it.</p><p><img src="images/get-addomaincontrollerhealth.png" alt="Get-ADDomainControllerHealth"></p><p>The domain controller services are a nested object, but if you expand them, they have a defined and formatted view.</p><p><img src="images/get-addomaincontrollerhealth-services.png" alt="Get-ADDomainControllerHealth info"></p><p>You can use additional custom views to format the results.</p><p><img src="images/get-addomaincontrollerhealth-info.png" alt="Get-ADDomainControllerHealth services"></p><h3 id="reports" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>Reports</h3><p><img src="images/Folder_FolderOpenWithDocumentWriting01.png" alt="reports"></p><p>The primary goal for this module is reporting. The intention is to provide easy-to-use commands that will provide at least a snapshot view of information you might want to know.</p><h4 id="get-adsummary" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span><a href="docs/Get-ADSummary.md">Get-ADSummary</a></h4><p>This simple command will give you a snapshot-sized summary of your Active Directory domain and forest.</p><p><img src="images/get-adsummary.png" alt="Get-ADSummary"></p><h4 id="get-ntdsinfo" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span><a href="docs/Get-NTDSInfo.md">Get-NTDSInfo</a></h4><p><code>Get-NTDSInfo</code> will query a domain controller using PowerShell remoting to get information about the NTDS.dit and related files. You might use this to track the size of the file or to check on backups. A high log count might indicate a backup is needed.</p><p><img src="images/get-ntdsinfo.png" alt="Get-NTDSInfo"></p><h4 id="get-adbackupstatus" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span><a href="docs/Get-ADBackupStatus.md">Get-ADBackupStatus</a></h4><p>There aren't any explicit PowerShell commands to tell if Active Directory has been backed up. One indirect approach is to use the command-line tool <code>repadmin.exe</code>. This command has a <code>/showbackup</code> parameter which will indicate when the different Active Directory partitions have been backed up. This command is a PowerShell wrapper for <code>repadmin.exe</code> that runs on the specified domain controller in a PowerShell remoting session.</p><p>If running in a console host, the date value may be shown in red, if the date is beyond the backup limit of 3 days.</p><p><img src="images/adbackup-status.png" alt="Get-ADBackupStatus"></p><p>The date limit is a user-customizable value in <code>$ADReportingHash</code>.</p><pre class=""><code class="powershell -codedoc-code-snippet code-0-0-12" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span></span></span><div class="line-0-0-16  -codedoc-code-line" data-content="$ADReportinghash.BackupLimit = 5" id="code9-l1"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">1<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token variable">$ADReportinghash</span><span class="token punctuation">.</span>BackupLimit = 5</div><br></code></pre><p>If you want a limit like this all the time, in your PowerShell profile script, import the module and add this line.</p><p>The command output also has a second formatted view.</p><p><img src="images/adbackup-age.png" alt="Get-ADBackupStatus Age"></p><h4 id="get-adbranch" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span><a href="docs/Get-ADBranch.md">Get-ADBranch</a></h4><p><code>Get-ADBranch</code> will get all users, groups, and computers from a given Active Directory organizational unit or container and display a hierarchical report. The search is recursive from the starting search base. The output is grouped by organizational unit or container. Within each level, Active Directory objects are grouped by type, e.g. User.</p><p><img src="images/get-adbranch.png" alt="Get-ADBranch"></p><p><strong>Note</strong>: There is a formatting bug that prevents the first item from being properly grouped.</p><h4 id="get-adfsmo" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span><a href="docs/Get-ADFSMO.md">Get-ADFSMO</a></h4><p><code>Get-ADFSMO</code> will display all FSMO role holders for the forest and domain at a glance.</p><p><img src="images/get-adfsmo.png" alt="Get-ADFSMO"></p><h4 id="get-adsitesummary" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span><a href="docs/Get-ADSiteSummary.md">Get-ADSiteSummary</a></h4><p><code>Get-ADSiteSummary</code> presents a quick view of your sites and subnets.</p><p><img src="images/get-adsitesummary.png" alt="Get-ADSiteSummary"></p><h4 id="get-adsitedetail" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span><a href="docs/Get-ADSiteDetail.md">Get-ADSiteDetail</a></h4><p><code>Get-ADSiteDetail</code> will present a summary report of your Active Directory sites with a bit more detail. This command will show the site description, associated subnets, and when the site object was created and last modified. Information is displayed in a formatted table.</p><p><img src="images/get-adsitedetail.png" alt="Get-ADSiteDetail"></p><h4 id="get-admanager" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span><a href="docs/Get-ADManager.md">Get-ADManager</a></h4><p>In Active Directory, you can designate a manager for users and objects. From the manager account's perspective, users are designated as DirectReports, and items such as Computers, Groups, and OrganizationalUnits are referred to as ManagedObjects. <code>Get-ADManager</code> is a simple way to get a manager account and view everything that they manage. The default is to get all users and all objects, but you can filter using command parameters.</p><p><img src="images/admanager-direct.png" alt="direct reports"></p><p>If you are running in a PowerShell console host, the default output will be colorized with ANSI escape sequences from <code>$ADReportingToolsOptions</code>. The following items will be highlighted with color</p><ul><li>Disabled accounts</li><li>Domain controller names</li><li>Member server names</li><li>Universal group scope</li><li>DomainLocal group scope</li><li>Distribution group category</li></ul><p><img src="images/admanager-managed.png" alt="managed objects"></p><h4 id="show-domaintree" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span><a href="docs/Show-DomainTree.md">Show-DomainTree</a></h4><p><code>Show-DomainTree</code> will display your domain in a tree view at the console. By default, the function will use color-coded ANSI formatting, assuming your PowerShell console supports it. The default display uses the organizational unit names. Although, you can use the distinguishedname of each branch. If you use -Containers, containers like Users will be included.</p><p><img src="images/show-domaintree.png" alt="Show-DomainTree"></p><h4 id="new-addomainreport" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span><a href="docs/New-ADDomainReport.md">New-ADDomainReport</a></h4><p><code>New-ADDomainReport</code> will create an HTML report of your domain. The report layout is by container and organizational unit. Underneath each branch will be a table display of users, computers, and groups. Beneath each group will be a table of recursive group members. You should get detail about users and computers if you hover the mouse over the distinguished name. The report includes javascript to enable collapsible regions.</p><p><img src="images/samplereport.png" alt="sample report"></p><p>The ADReportingTools module includes a CSS file, which will be used by default. But you can specify an alternate CSS file. If you want to make the file portable, you can opt to embed the CSS into the HTML file. You can only embed from a file, not a URL reference.</p><p>The module's CSS file can be found in the <a href="reports/domainreport.css">reports</a> folder. You can view a complete sample report <a href="reports/sampledomain.html">here</a>.</p><h4 id="new-adchangereport" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span><a href="docs/New-ADChangeReport.md">New-ADChangeReport</a></h4><p><code>New-ADChangeReport</code> will create an HTML report showing changes to Active Directory users, computers, and groups since a given date and time. The command uses <code>Get-ADObject</code> to query the <code>WhenChanged</code> property. The objects are organized by class and/or container and written to an HTML file. The command uses a CSS file from the ADReportingTools module, although you can specify your own. To make the HTML file portable, you can opt to embed the CSS content from a file source.</p><p><img src="images/samplechangereport.png" alt="sample change report"></p><p>You can view the default CSS file <a href="reports/changereport.css">here</a>. A complete sample report can be found <a href="reports/samplechange.html">here</a>.</p><h4 id="new-adgroupreport" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span><a href="docs/New-ADGroupReport.md">New-ADGroupReport</a></h4><p><code>New-ADGroupReport</code> will create an HTML report of specified groups from Active Directory. This function is based on <code>Get-ADGroupReport</code> and converts the output to an HTML file. You can specify a CSS file or use the default from the module.</p><p><img src="images/samplegroupreport.png" alt="sample group report"></p><p>Disabled user accounts will be highlighted in red when using the default CSS file from the module. User detail will pop-up when the mouse hovers over the user's distinguishedname.</p><p>A complete sample report can be found <a href="reports/samplegroup.html">here</a>.</p><h2 id="formats-type-extensions-and-other-features" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>Formats, Type Extensions, and Other Features</h2><p>The module includes format and type extensions to simplify using the commands in the Active Directory module. The extensions are automatically imported into your PowerShell session when you import the ADReportingTools module.</p><p>Currently, only AD User objects have been extended.</p><table><thead><th>Name</th><th>Type</th><th>Value</th></thead><tbody><tr><td>LastName</td><td>AliasProperty</td><td>Surname</td></tr><tr><td>DN</td><td>AliasProperty</td><td>DistinguishedName</td></tr><tr><td>FirstName</td><td>AliasProperty</td><td>GivenName</td></tr><tr><td>UPN</td><td>AliasProperty</td><td>UserPrincipalName</td></tr></tbody></table><p>These extensions have been grouped as a property set called <em>Names</em>.</p><pre class="with-bar"><code class="shell -codedoc-code-snippet code-0-0-12" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span></span></span><div class="line-0-0-16  -codedoc-code-line" data-content="PS C:\>Get-ADUser artd | Select-Object Names" id="code10-l1"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">1<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>PS C:<span class="token punctuation">\</span><span class="token operator">&gt;</span>Get-ADUser artd <span class="token operator">|</span> Select-Object Names</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="" id="code10-l2"><span class="lineCounter-0-0-13 -codedoc-line-counter">2<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="DN             : CN=ArtD,OU=IT,DC=Company,DC=Pri" id="code10-l3"><span class="lineCounter-0-0-13 -codedoc-line-counter">3<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>DN             <span class="token builtin class-name">:</span> <span class="token assign-left variable">CN</span><span class="token operator">=</span>ArtD,OU<span class="token operator">=</span>IT,DC<span class="token operator">=</span>Company,DC<span class="token operator">=</span>Pri</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="Name           : ArtD" id="code10-l4"><span class="lineCounter-0-0-13 -codedoc-line-counter">4<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>Name           <span class="token builtin class-name">:</span> ArtD</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="FirstName      : Art" id="code10-l5"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">5<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>FirstName      <span class="token builtin class-name">:</span> Art</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="LastName       : Deco" id="code10-l6"><span class="lineCounter-0-0-13 -codedoc-line-counter">6<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>LastName       <span class="token builtin class-name">:</span> Deco</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="SamAccountName : ArtD" id="code10-l7"><span class="lineCounter-0-0-13 -codedoc-line-counter">7<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>SamAccountName <span class="token builtin class-name">:</span> ArtD</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="UPN            : artd@company.com" id="code10-l8"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">8<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>UPN            <span class="token builtin class-name">:</span> artd@company.com</div><br></code></pre><p>Or use a defined view for Active Directory user objects.</p><pre class="with-bar"><code class="powershell -codedoc-code-snippet code-0-0-12" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span></span></span><div class="line-0-0-16  -codedoc-code-line" data-content="Get-ADUser -SearchBase &quot;ou=employees,dc=company,dc=pri&quot; -filter * |" id="code11-l1"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">1<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token function">Get-ADUser</span> <span class="token operator">-</span>SearchBase <span class="token string">"ou=employees,dc=company,dc=pri"</span> <span class="token operator">-</span><span class="token keyword">filter</span> <span class="token operator">*</span> <span class="token punctuation">|</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="Format-Table -view names" id="code11-l2"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">2<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token function">Format-Table</span> <span class="token operator">-</span>view names</div><br></code></pre><p><img src="images/get-aduser-names.png" alt="Get-ADUser names"></p><p>The module adds a default table view for AD group objects.</p><p><img src="images/get-adgroup.png" alt="ADGroup Format"></p><p>If your PowerShell console supports it, Distribution, Universal, and DomainLocal groups will be highlighted in color.</p><h3 id="adreportingtoolsoptions" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>ADReportingToolsOptions</h3><p>The ANSI sequences used in the format files are user-configurable. Values are stored in an exported variable called <code>ADReportingToolsOptions</code>, although you shouldn't try to access the variable directly. Use <code>Get-ADReportingToolsOptions</code> to see the current values.</p><p><img src="images/get-adreportingtoolsoptions.png" alt="ADReportingToolsOptions"></p><p>The module uses the <code>[char]0x1b</code> escape sequence because it works in both Windows PowerShell and PowerShell 7.x.</p><p>If you prefer to customize the sequence, use <code>Set-ADReportingToolsOptions</code>.</p><pre class=""><code class="powershell -codedoc-code-snippet code-0-0-12" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span></span></span><div class="line-0-0-16  -codedoc-code-line" data-content="Set-ADReportingToolsOptions DistributionList -ANSI &quot;$([char]0x1b)[38;5;50m&quot;" id="code12-l1"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">1<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token function">Set-ADReportingToolsOptions</span> DistributionList <span class="token operator">-</span>ANSI <span class="token string">"<span class="token function">$<span class="token punctuation">(</span><span class="token namespace">[char]</span>0x1b<span class="token punctuation">)</span></span>[38;5;50m"</span></div><br></code></pre><p>This change is only for the duration of your PowerShell session. Add the command to a PowerShell profile script to make it more permanent.</p><p><img src="images/octocat.png" alt="octocat"> If you would like to see what ANSI sequences look like, install the <a href="https://github.com/jdhitsolutions/PSScriptTools/blob/master/README.md">PSScriptTools</a> module from the PowerShell Gallery and use <a href="https://github.com/jdhitsolutions/PSScriptTools/blob/master/docs/Show-ANSISequence.md">Show-ANSISequence</a>.</p><h3 id="adreportinghash" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>ADReportingHash</h3><p>Several module configuration details are storing in a hashtable called <code>$ADReportingHash</code>. Here's a sample.</p><pre class="with-bar"><code class="powershell -codedoc-code-snippet code-0-0-12" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span></span></span><div class="line-0-0-16  -codedoc-code-line" data-content="Name                           Value" id="code13-l1"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">1<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>Name                           Value</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="----                           -----" id="code13-l2"><span class="lineCounter-0-0-13 -codedoc-line-counter">2<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token operator">--</span><span class="token operator">--</span>                           <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="Handle                         System.Management.Automation.PowerShellAsyncResult" id="code13-l3"><span class="lineCounter-0-0-13 -codedoc-line-counter">3<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>Handle                         System<span class="token punctuation">.</span>Management<span class="token punctuation">.</span>Automation<span class="token punctuation">.</span>PowerShellAsyncResult</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="Note                           This hashtable is used by the ADReportingTools module. Do not delete." id="code13-l4"><span class="lineCounter-0-0-13 -codedoc-line-counter">4<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>Note                           This hashtable is used by the ADReportingTools module<span class="token punctuation">.</span> <span class="token keyword">Do</span> not delete<span class="token punctuation">.</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="BackupLimit                    3" id="code13-l5"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">5<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>BackupLimit                    3</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="Departments                    {Accounting, Consumer Affairs, Customer Service, Dev...}" id="code13-l6"><span class="lineCounter-0-0-13 -codedoc-line-counter">6<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>Departments                    <span class="token punctuation">{</span>Accounting<span class="token punctuation">,</span> Consumer Affairs<span class="token punctuation">,</span> Customer Service<span class="token punctuation">,</span> Dev<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">}</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="LastUpdated                    3/29/2021 5:54:23 PM" id="code13-l7"><span class="lineCounter-0-0-13 -codedoc-line-counter">7<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>LastUpdated                    3/29/2021 5:54:23 PM</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="DomainControllers              {DOM1.Company.Pri, DOM2.Company.Pri}" id="code13-l8"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">8<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>DomainControllers              <span class="token punctuation">{</span>DOM1<span class="token punctuation">.</span>Company<span class="token punctuation">.</span>Pri<span class="token punctuation">,</span> DOM2<span class="token punctuation">.</span>Company<span class="token punctuation">.</span>Pri<span class="token punctuation">}</span></div><br></code></pre><p>Some of these items, such as the list of Departments and Domain Controllers, are gathered when you import the module. On import, a background runspace is invoked that uses a synchronized hashtable to surface information to your session.</p><h3 id="argument-completers" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>Argument Completers</h3><p>One way the data from <code>$ADReportingHash</code> is used is as argument completers. The <code>Department</code> parameter from <code>Get-ADDepartment</code>is one example. Of course, you need to wait until the background runspace is complete before this will give you any values.</p><p>All commands in this module, as well as the Get commands from the Active Directory module, that have a <code>Server</code> parameter, will use the DomainController list as argument completers. Note that the domain controller names are stored in their DNS format.</p><h3 id="css-files" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>CSS Files</h3><p>The HTML report commands rely on CSS for formatting. In some cases, CSS is defined in the function and embedded into the HTML file. Other CSS is imported from sample files in the Reports directory of this module. If you would like to define your own CSS, it is recommended you use the samples as templates for your own work. You might also need to view the source code of specific functions to see what style settings are being defined.</p><p>You are always welcome to create your own function or script based on code from this module.</p><h2 id="future-work" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>Future Work</h2><p>These are items under consideration and likely to be added to the module:</p><ul><li>Get-ADPasswordPending (look at Get-ADUserResultantPasswordPolicy).</li><li>An HTML computer report.</li><li>Enhanced output from <code>Search-ADAccount</code>. This might be several commands.</li><li>Add logo support to the HTML reporting functions.</li><li>Get items by site or location.</li><li>Get newest created item(s) created since a given date.</li></ul><p>These are items that I'm dreaming about and may add at some point in the future:</p><ul><li>A toolset to build HTML reports on the fly based on default formatting.</li><li>A WPF-based OU browser or a simplified version of ADUC.</li><li>A WPF-based password reporting tool.</li></ul><p>I welcome suggestions, feedback, and comments in the module repository's <a href="https://github.com/jdhitsolutions/ADReportingTools/discussions">Discussion</a> section.</p><p>last updated <em>2021-04-07 12:23:19Z</em></p><div class="contentnav-0-0-11" data-no-search=""><a href="#adreportingtools" class="h1" data-content-highlight="adreportingtools">ADReportingTools</a><a href="#installation" class="h2" data-content-highlight="installation">Installation</a><a href="#design-philosophy" class="h2" data-content-highlight="design-philosophy">Design Philosophy</a><a href="#module-commands" class="h2" data-content-highlight="module-commands">Module Commands</a><a href="#get-adreportingtools" class="h3" data-content-highlight="get-adreportingtools">Get-ADReportingTools</a><a href="#open-adreportingtoolshelp" class="h3" data-content-highlight="open-adreportingtoolshelp">Open-ADReportingToolsHelp</a><a href="#users" class="h3" data-content-highlight="users">Users</a><a href="#get-adcanonicaluser" class="h4" data-content-highlight="get-adcanonicaluser">Get-ADCanonicalUser</a><a href="#get-aduseraudit" class="h4" data-content-highlight="get-aduseraudit">Get-ADUserAudit</a><a href="#get-adusercategory" class="h4" data-content-highlight="get-adusercategory">Get-ADUserCategory</a><a href="#get-addepartment" class="h4" data-content-highlight="get-addepartment">Get-ADDepartment</a><a href="#split-distinguishedname" class="h4" data-content-highlight="split-distinguishedname">Split-DistinguishedName</a><a href="#groups" class="h3" data-content-highlight="groups">Groups</a><a href="#get-adgroupuser" class="h4" data-content-highlight="get-adgroupuser">Get-ADGroupUser</a><a href="#get-adgroupreport" class="h4" data-content-highlight="get-adgroupreport">Get-ADGroupReport</a><a href="#computers" class="h3" data-content-highlight="computers">Computers</a><a href="#get-adcomputerreport" class="h4" data-content-highlight="get-adcomputerreport">Get-ADComputerReport</a><a href="#get-addomaincontrollerhealth" class="h4" data-content-highlight="get-addomaincontrollerhealth">Get-ADDomainControllerHealth</a><a href="#reports" class="h3" data-content-highlight="reports">Reports</a><a href="#get-adsummary" class="h4" data-content-highlight="get-adsummary">Get-ADSummary</a><a href="#get-ntdsinfo" class="h4" data-content-highlight="get-ntdsinfo">Get-NTDSInfo</a><a href="#get-adbackupstatus" class="h4" data-content-highlight="get-adbackupstatus">Get-ADBackupStatus</a><a href="#get-adbranch" class="h4" data-content-highlight="get-adbranch">Get-ADBranch</a><a href="#get-adfsmo" class="h4" data-content-highlight="get-adfsmo">Get-ADFSMO</a><a href="#get-adsitesummary" class="h4" data-content-highlight="get-adsitesummary">Get-ADSiteSummary</a><a href="#get-adsitedetail" class="h4" data-content-highlight="get-adsitedetail">Get-ADSiteDetail</a><a href="#get-admanager" class="h4" data-content-highlight="get-admanager">Get-ADManager</a><a href="#show-domaintree" class="h4" data-content-highlight="show-domaintree">Show-DomainTree</a><a href="#new-addomainreport" class="h4" data-content-highlight="new-addomainreport">New-ADDomainReport</a><a href="#new-adchangereport" class="h4" data-content-highlight="new-adchangereport">New-ADChangeReport</a><a href="#new-adgroupreport" class="h4" data-content-highlight="new-adgroupreport">New-ADGroupReport</a><a href="#formats-type-extensions-and-other-features" class="h2" data-content-highlight="formats-type-extensions-and-other-features">Formats, Type Extensions, and Other Features</a><a href="#adreportingtoolsoptions" class="h3" data-content-highlight="adreportingtoolsoptions">ADReportingToolsOptions</a><a href="#adreportinghash" class="h3" data-content-highlight="adreportinghash">ADReportingHash</a><a href="#argument-completers" class="h3" data-content-highlight="argument-completers">Argument Completers</a><a href="#css-files" class="h3" data-content-highlight="css-files">CSS Files</a><a href="#future-work" class="h2" data-content-highlight="future-work">Future Work</a></div></div><div id="-codedoc-toc" class="toc-0-0-8"><div class="content-0-0-9"><div class="heading-0-0-3">Index</div><p><a href="/codedoc/">Home</a>
<a href="/codedoc/README">Index</a>
<a href="/codedoc/docs/Kostwein">Kostwein</a></p><div class="collapse-0-0-4 "><script id="VVEzJJuFwG">(function(){function load(){if (window.__sdh_transport){window.__sdh_transport("VVEzJJuFwG", "yAdNJkOJGbj52dvfV+HpdQ==", {});} }; if (document.readyState == 'complete') load(); else window.addEventListener('load', load); window.setImmediate = window.setImmediate || function(f){setTimeout(f, 0)}; })()</script><div class="label" onclick="this.parentElement.classList.toggle('open')"><span class="text">PSModulesHelp</span><span class="icon-font closed">chevron_right</span></div><div class="content"><p><a href="/codedoc/docs/PSModulesHelp/ModuleDoku">PS Modules Help</a></p><hr></div></div><div class="collapse-0-0-4 "><script id="bvvOjRzUsk">(function(){function load(){if (window.__sdh_transport){window.__sdh_transport("bvvOjRzUsk", "yAdNJkOJGbj52dvfV+HpdQ==", {});} }; if (document.readyState == 'complete') load(); else window.addEventListener('load', load); window.setImmediate = window.setImmediate || function(f){setTimeout(f, 0)}; })()</script><div class="label" onclick="this.parentElement.classList.toggle('open')"><span class="text">KnowledgeBase</span><span class="icon-font closed">chevron_right</span></div><div class="content"><blockquote><p><a href="/codedoc/docs/Knowledge/PowerShell/Index">PowerShell</a></p></blockquote></div></div><div class="collapse-0-0-4 "><script id="wXwDzKYoaL">(function(){function load(){if (window.__sdh_transport){window.__sdh_transport("wXwDzKYoaL", "yAdNJkOJGbj52dvfV+HpdQ==", {});} }; if (document.readyState == 'complete') load(); else window.addEventListener('load', load); window.setImmediate = window.setImmediate || function(f){setTimeout(f, 0)}; })()</script><div class="label" onclick="this.parentElement.classList.toggle('open')"><span class="text">Links</span><span class="icon-font closed">chevron_right</span></div><div class="content"><blockquote><p><a href="/codedoc/docs/Links/LinksWiki">Index</a></p></blockquote></div></div><div class="collapse-0-0-4 "><script id="CpXjQJHtbC">(function(){function load(){if (window.__sdh_transport){window.__sdh_transport("CpXjQJHtbC", "yAdNJkOJGbj52dvfV+HpdQ==", {});} }; if (document.readyState == 'complete') load(); else window.addEventListener('load', load); window.setImmediate = window.setImmediate || function(f){setTimeout(f, 0)}; })()</script><div class="label" onclick="this.parentElement.classList.toggle('open')"><span class="text">Veeam</span><span class="icon-font closed">chevron_right</span></div><div class="content"><blockquote><p><a href="/codedoc/docs/Knowledge/Veeam/Best%20Practices/index">Best Practices</a></p></blockquote></div></div><p><a href="/codedoc/docs/cheat-sheet">Markdown Cheat Sheet</a>
<a href="/codedoc/docs/code-features">Code Features</a></p><p><br><br></p><p>To add links to your other documents, simply
modify contents of <code>docs/md/_toc.md</code>.</p></div><div class="search-0-0-10"><script id="Qw_Vormedw">(function(){function load(){if (window.__sdh_transport){window.__sdh_transport("Qw_Vormedw", "EKtVWhWp+AfK3O64A4+bOg==", {"repo":"codedoc","user":"In-Pro-Org","root":"docs/md","pick":"\\.md$","drop":"(^_)|(\\/_)"});} }; if (document.readyState == 'complete') load(); else window.addEventListener('load', load); window.setImmediate = window.setImmediate || function(f){setTimeout(f, 0)}; })()</script></div></div><div class="footer-0-0-7"><div class="left"><script id="ukswngNB_y">(function(){function load(){if (window.__sdh_transport){window.__sdh_transport("ukswngNB_y", "wCsMx1XMyC4jNi3FxvjU4g==", {});} }; if (document.readyState == 'complete') load(); else window.addEventListener('load', load); window.setImmediate = window.setImmediate || function(f){setTimeout(f, 0)}; })()</script></div><div class="main"><div class="inside"><a href="https://github.com/In-Pro-Org/codedoc/" target="_blank">GitHub</a></div></div><div class="right"><script id="wrvqqOynQL">(function(){function load(){if (window.__sdh_transport){window.__sdh_transport("wrvqqOynQL", "6W59GcSTLBVXRr/Nl/rTkw==", {});} }; if (document.readyState == 'complete') load(); else window.addEventListener('load', load); window.setImmediate = window.setImmediate || function(f){setTimeout(f, 0)}; })()</script></div></div><script id="KiEvI_pKJL">(function(){function load(){if (window.__sdh_transport){window.__sdh_transport("KiEvI_pKJL", "zKXJ5zf13oJGCwAAI3JIIA==", {"namespace":"/codedoc"});} }; if (document.readyState == 'complete') load(); else window.addEventListener('load', load); window.setImmediate = window.setImmediate || function(f){setTimeout(f, 0)}; })()</script></body></html>