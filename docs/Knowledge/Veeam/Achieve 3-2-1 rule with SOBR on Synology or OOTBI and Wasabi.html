<!DOCTYPE html><html><head><title>Codedoc</title><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"><meta name="robots" content="index,follow"><meta name="theme-color" content="#212121"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><link rel="shortcut icon" href="/codedoc/docs/images/KostweinLogo.ico"><link href="https://fonts.googleapis.com/css?family=Roboto:300,400&amp;display=swap" rel="stylesheet"><link href="https://fonts.googleapis.com/css?family=Source+Code+Pro:300,400&amp;display=swap" rel="stylesheet"><link href="https://fonts.googleapis.com/icon?family=Material+Icons%7CMaterial+Icons+Outlined&amp;display=swap" rel="stylesheet"><style>
      body, input, button {
        font-family: 'Roboto', sans-serif;
      }

      code, .hljs {
        font-family: 'Source Code Pro', 'Courier New', Courier, monospace;
      }

      .icon-font {
        font-family: 'Material Icons';
        font-weight: normal;
        font-style: normal;
        font-size: 24px;  /* Preferred icon size */
        display: inline-block;
        line-height: 1;
        text-transform: none;
        letter-spacing: normal;
        word-wrap: normal;
        white-space: nowrap;
        direction: ltr;
      
        /* Support for all WebKit browsers. */
        -webkit-font-smoothing: antialiased;
        /* Support for Safari and Chrome. */
        text-rendering: optimizeLegibility;
      
        /* Support for Firefox. */
        -moz-osx-font-smoothing: grayscale;
      
        /* Support for IE. */
        font-feature-settings: 'liga';
      }

      .icon-font.outline {
        font-family: 'Material Icons Outlined';
      }
    </style><link href="/codedoc/docs/assets/codedoc-styles.css" rel="stylesheet"><script async="" defer="" src="/codedoc/docs/assets/codedoc-bundle.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css" integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq" crossorigin="anonymous"></head><body data-path="docs\Knowledge\Veeam\Achieve 3-2-1 rule with SOBR on Synology or OOTBI and Wasabi.md"><div class="header-0-0-6"><script async="" defer="" src="https://buttons.github.io/buttons.js"></script><a class="github-button" data-color-scheme="no-preference: light; light: light; dark: dark;" data-icon="false" data-show-count="true" data-size="false" href="https://github.com/In-Pro-Org/codedoc/">Star</a><br><br><a class="watermark-0-0-5" href="https://github.com/CONNECT-platform/codedoc" target="_blank">Created With<svg viewBox="0 0 536 296" version="1.1" xmlns="http://www.w3.org/2000/svg"><g id="codedoc" transform="translate(-244.000000, -364.000000)" fill-rule="nonzero"><path d="M580,532 C615.346224,532 644,560.653776 644,596 C644,631.346224 615.346224,660 580,660 C544.653776,660 516,631.346224 516,596 C516,560.653776 544.653776,532 580,532 Z M716,532 C751.346224,532 780,560.653776 780,596 C780,631.346224 751.346224,660 716,660 L692,660 C687.581722,660 684,656.418278 684,652 C684,647.581722 687.581722,644 692,644 L716,644 C742.509668,644 764,622.509668 764,596 C764,569.490332 742.509668,548 716,548 L692,548 C687.581722,548 684,544.418278 684,540 C684,535.581722 687.581722,532 692,532 L716,532 Z M468,532 C472.418278,532 476,535.581722 476,540 L476,652 C476,656.418278 472.418278,660 468,660 L444,660 C408.653776,660 380,631.346224 380,596 C380,560.653776 408.653776,532 444,532 L468,532 Z M332,532 C336.418278,532 340,535.581722 340,540 L340,652 C340,656.418278 336.418278,660 332,660 L252,660 C247.581722,660 244,656.418278 244,652 L244,540 C244,535.581722 247.581722,532 252,532 L332,532 Z M580,548 C553.490332,548 532,569.490332 532,596 C532,622.509668 553.490332,644 580,644 C606.509668,644 628,622.509668 628,596 C628,569.490332 606.509668,548 580,548 Z M461,548 L444,548 C417.490332,548 396,569.490332 396,596 C396,622.509668 417.490332,644 444,644 L461,644 L461,548 Z M444,364 C479.346224,364 508,392.653776 508,428 C508,463.346224 479.346224,492 444,492 C408.653776,492 380,463.346224 380,428 C380,392.653776 408.653776,364 444,364 Z M332,364 C336.418278,364 340,367.581722 340,372 C340,376.418278 336.418278,380 332,380 L308,380 C281.490332,380 260,401.490332 260,428 C260,454.509668 281.490332,476 308,476 L332,476 C336.418278,476 340,479.581722 340,484 C340,488.418278 336.418278,492 332,492 L308,492 C272.653776,492 244,463.346224 244,428 C244,392.653776 272.653776,364 308,364 L332,364 Z M580,364 C615.346224,364 644,392.653776 644,428 C644,463.346224 615.346224,492 580,492 L556,492 C551.581722,492 548,488.418278 548,484 L548,372 C548,367.581722 551.581722,364 556,364 L580,364 Z M772,364 C776.418278,364 780,367.581722 780,372 C780,376.418278 776.418278,380 772,380 L700,380 L700,420 L772,420 C776.418278,420 780,423.581722 780,428 C780,432.418278 776.418278,436 772,436 L700,436 L700,476 L772,476 C776.418278,476 780,479.581722 780,484 C780,488.418278 776.418278,492 772,492 L692,492 C687.581722,492 684,488.418278 684,484 L684,372 C684,367.581722 687.581722,364 692,364 L772,364 Z M444,380 C417.490332,380 396,401.490332 396,428 C396,454.509668 417.490332,476 444,476 C470.509668,476 492,454.509668 492,428 C492,401.490332 470.509668,380 444,380 Z M580,380 L563,380 L563,476 L580,476 C606.509668,476 628,454.509668 628,428 C628,401.490332 606.509668,380 580,380 Z"></path></g></svg></a></div><div id="-codedoc-container" class="container"><p><a href="https://techdirectarchive.com/2024/08/14/achieve-3-2-1-rule-with-sobr-on-synology-or-ootbi-and-wasabi/#google_vignette">https://techdirectarchive.com/2024/08/14/achieve-3-2-1-rule-with-sobr-on-synology-or-ootbi-and-wasabi/#google_vignette</a></p><blockquote><p>Discover how to achieve the 3-2-1 backup rule using Veeam's SOBR on Synology or OOTBI and Wasabi with the steps to configure your extents</p></blockquote><h1 id="achieve-3-2-1-rule-with-sobr-on-synology-or-ootbi-and-wasabi" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>Achieve 3-2-1 rule with SOBR on Synology or OOTBI and Wasabi</h1><p><img src="https://i0.wp.com/techdirectarchive.com/wp-content/uploads/2024/08/SOBR-implementing-3-2-1-Rule.jpg?resize=780%2C402&amp;ssl=1" alt="SOBR - implementing 3-2-1 Rule"></p><p>Veeam’s Scale-Out Backup Repository (SOBR) can be used to implement the 3-2-1 backup rule. The <a href="https://www.veeam.com/blog/321-backup-rule.html">3-2-1</a> backup rule recommends having <strong>three copies</strong> of your data, stored on two <strong>different types of media</strong>, with <strong>one copy kept off-site</strong>. SOBR is built upon collections of individual repositories as we will see very shortly. In this article, I will demonstrate how you can Achieve 3-2-1 rule with SOBR on Synology or OOTBI and Wasabi. Please see <a href="https://techdirectarchive.com/2024/07/02/how-to-configure-object-first-ootbi-appliance/">How to Configure Object First OOTBI Appliance</a>, how to <a href="https://techdirectarchive.com/2024/08/14/how-to-update-veeam-backup-and-replication-vbr/">update Veeam Backup and Replication [VBR]</a>, and how to <a href="https://techdirectarchive.com/2024/08/14/how-to-update-object-first-ootbi-cluster/">update Object First OOTBI Cluster</a>.</p><p>In a nutshell, a scale-out backup repository is an architecture that enables you to extend your backup storage by adding multiple repositories. Adding a new extent to an existing scale-out repository is an easy way to extend storage without relocating backup chains.</p><blockquote><p>Note: The focus of this article is using Synology DS923+ Appliance. But you can also achieve 3-2-1 with Object First OOTBI appliance. With the recent addition of 192TB, you are sure of 768- TB in a four-node OOTBI Cluster! With Veeam’s 12.1.2 release, you can get over 3PB of storage using OOTBI clusters as extents in a Veeam Scale-Out Backup Repository (SOBR).</p></blockquote><p>With the above information about OOTBI, you could deploy OOTBI appliance in the <strong><a href="https://objectfirst.com/help/evaluating-the-performance-of-backup-and-restore-operations-object-first-ootbi-as-performance-tier-of-sobr/">Performance Tier on the primary data center</a></strong> and as a <strong>Capacity Tier in the secondary data center</strong>, with immutability enabled in both tiers. Then deploying S3 public cloud services with immutability enabled in the Capacity Tier. This way, you will also achieve the 3-2-1 rule.</p><p>See <a href="https://techdirectarchive.com/2022/07/04/how-to-offload-individual-apps-on-iphone/">How to Offload Individual Apps on iPhone</a>, how to <a href="https://techdirectarchive.com/2022/07/03/automatically-offload-unused-apps-on-iphone-simplified-guide/">automatically offload unused Apps on iPhone</a>, and <a href="https://techdirectarchive.com/2022/08/24/disable-automatic-offloading-of-apps-on-iphones-a-how-to-guide/">how to Disable Automatic Offloading of Apps on iPhones</a>.</p><h2 id="tiers-in-scale-out-backup-repo" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>Tiers in Scale-out Backup Repo</h2><p>From the architecture below, these are the various repository types that make up a Scale-out Backup Repository (SOBR). In this article, we will focus on the Performance and Capacity Tier.</p><p><img src="https://i0.wp.com/techdirectarchive.com/wp-content/uploads/2024/08/SOBR.jpg?resize=780%2C388&amp;ssl=1" alt="SOBR"></p><p>SRC: Veeam</p><p>Below is a short description of these tiers. You can learn more about <a href="https://www.veeam.com/blog/server-backup-guide.html">backup strategy</a>.</p><ul><li>Performance tiers: Allows granular placement of backup on one or more extents based on a policy set by users or characteristic of the storage.</li><li>Capacities Tier: Extends the backup storage transparently and intelligently to the object storage. Cloud Tier is also referred to as the Capacity Tier.</li><li>Archive Tier: Archive tier is an additional tier of storage that can be attached to a scale-out backup repository. You can transfer data to the archive tier from From performance extents that consist of Amazon S3, Microsoft Azure, or S3 compatible with data archiving object storage repositories and capacity extents.</li></ul><p>Please see <a href="https://techdirectarchive.com/2024/08/12/how-to-create-a-tailscale-vpn-connection-to-my-synology-nas/">How to create a Tailscale VPN connection to Synology NAS</a>, how to <a href="https://techdirectarchive.com/2024/08/11/manage-user-permission-on-synology-with-active-directory-part-1/">Manage User Permission on Synology with Active Directory [Part 1]</a>, and how to <a href="https://techdirectarchive.com/2024/08/10/how-to-configure-synology-ds923-nas-for-file-sharing-part-2/">Configure Synology DS923+ NAS for File Sharing [Part 2]</a>.</p><h4 id="create-wasabi-storage-bucket" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>Create Wasabi Storage Bucket</h4><p>In this section, we will create an &nbsp;object storage repository to act as Capacity Tier. This will help us store backup in an off-site location, thereby complying to the 3-2-1 rule.</p><blockquote><p>Note: To help our customers choose an object storage platform which is compatible with Veeam Backup &amp; Replication, Veeam has a qualification program called “Veeam Ready”.</p></blockquote><p>Navigate to the Wasabi Management Console (dashboard). Click on Buck and then on “Create Bucket”.</p><p><img src="https://i0.wp.com/techdirectarchive.com/wp-content/uploads/2024/08/Create-wasabi-bucket-1.jpg?resize=780%2C350&amp;ssl=1" alt="Create wasabi bucket"></p><p>In the set Properties window, ensure “Object versioning” and “Object Lock” is selected. Click on Next to proceed.</p><p><img src="https://i0.wp.com/techdirectarchive.com/wp-content/uploads/2024/08/Object-lock-and-versioning.jpg?resize=734%2C688&amp;ssl=1" alt="Object lock and versioning"></p><p>I do not care about “Bucket logging for now”. Click Next to proceed.</p><p><img src="https://i0.wp.com/techdirectarchive.com/wp-content/uploads/2024/08/Bucket-logging.jpg?resize=732%2C415&amp;ssl=1" alt="Bucket logging"></p><p>I will skip Object replication also for now.</p><p><img src="https://i0.wp.com/techdirectarchive.com/wp-content/uploads/2024/08/Object-replication.jpg?resize=735%2C561&amp;ssl=1" alt="Object replication"></p><p>I do not need Tags, so I will click Next to proceed.</p><p><img src="https://i0.wp.com/techdirectarchive.com/wp-content/uploads/2024/08/Apply-tags-to-bucket.jpg?resize=737%2C537&amp;ssl=1" alt="Apply tags to bucket"></p><p>As you can see, the bucket has been created.</p><p><img src="https://i0.wp.com/techdirectarchive.com/wp-content/uploads/2024/08/Create-Bucket-1.jpg?resize=739%2C696&amp;ssl=1" alt="Create Bucket"></p><p>Below is the bucket we have created. You can start creating folders and uploads if you wish. But I will do this over the VBR.</p><p><img src="https://i0.wp.com/techdirectarchive.com/wp-content/uploads/2024/08/bucket-created-1.jpg?resize=780%2C395&amp;ssl=1" alt="bucket created"></p><blockquote><p>Do&nbsp;<strong>not configure any tiering or lifecycle rules</strong>&nbsp;on object storage buckets used for Veeam Object Storage Repositories. They are&nbsp;<strong><a href="https://docs.aws.amazon.com/prescriptive-guidance/latest/patterns/back-up-and-archive-data-to-amazon-s3-with-veeam-backup-replication.html">unsupported</a></strong> at the time of writing this article.</p></blockquote><h4 id="create-an-access-key" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>Create an Access Key</h4><p>To do this, log into the Wasabi console and click on Access Key. Then, click on “create New Access key”</p><p><img src="https://i0.wp.com/techdirectarchive.com/wp-content/uploads/2024/08/create-wasabi-access-key.jpg?resize=780%2C289&amp;ssl=1" alt="create wasabi access key"></p><p>Ensure you download the CSV or copy keys to clipboard and save in a safe location. Else, when this window is closed, you will never be able to access the Secret key anymore.</p><p><img src="https://i0.wp.com/techdirectarchive.com/wp-content/uploads/2024/08/access-key.jpg?resize=742%2C394&amp;ssl=1" alt="access key"></p><p>Learn <a href="https://techdirectarchive.com/2024/08/02/how-to-determine-tombstone-lifetime-in-active-directory/">how to determine Tombstone Lifetime in Active Directory</a>, steps in <a href="https://techdirectarchive.com/2024/08/01/enabling-and-configuring-winrm-via-gpo/">Enabling and Configuring WinRM via GPO</a>, and how to <a href="https://techdirectarchive.com/2024/07/29/implement-split-brain-dns-policies-in-active-directory/">Implement Split-Brain DNS Policies in Active Directory</a>.</p><h3 id="setup-wasabi-s3-veeam-repository" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>Setup Wasabi S3 Veeam Repository</h3><p>This process is pretty straight forward. Launch Veeam backup and Replication console and navigate to the Backup Infrastructure. Click on Backup Repository and select “Add Repository”.</p><p>On the add backup repository wizard, select “Object Storage’.</p><p><img src="https://i0.wp.com/techdirectarchive.com/wp-content/uploads/2024/08/create-repositories-1.jpg?resize=780%2C448&amp;ssl=1" alt="create repositories"></p><p>Select S3 Compatible</p><p><img src="https://i0.wp.com/techdirectarchive.com/wp-content/uploads/2024/08/s3-compatible.jpg?resize=780%2C666&amp;ssl=1" alt="s3 compatible"></p><p>On the S3 compatible wizard, select S3 Compatible as this will add an S3 compatible storage.</p><p><img src="https://i0.wp.com/techdirectarchive.com/wp-content/uploads/2024/08/s3-object-storage.jpg?resize=780%2C675&amp;ssl=1" alt="s3 object storage"></p><p>From the “New Object Storage repository’ wizard, enter the name and click next.</p><p><img src="https://i0.wp.com/techdirectarchive.com/wp-content/uploads/2024/08/Object-stoage-repo.jpg?resize=780%2C563&amp;ssl=1" alt="Object stoage repo"></p><p>On the Account section, specify the Service point, region and credential. You can learn more about the service <a href="https://docs.wasabi.com/docs/what-are-the-service-urls-for-wasabis-different-storage-regions">URLs for Wasabi’s Storage Regions</a>.</p><blockquote><p>Note: Object storage not limited to Wasabi as used in this article includes Amazon S3, Microsoft Azure Blob Storage, and other S3-compatible storage services such as Wasabi.</p></blockquote><p><img src="https://i0.wp.com/techdirectarchive.com/wp-content/uploads/2024/08/Create-Setup.jpg?resize=780%2C558&amp;ssl=1" alt="Create Setup"></p><p>Enter the Access Key and Secret key you have configured above.</p><p><img src="https://i0.wp.com/techdirectarchive.com/wp-content/uploads/2024/08/Credentials.jpg?resize=780%2C459&amp;ssl=1" alt="Credentials"></p><p>Click Next to continue.</p><p><img src="https://i0.wp.com/techdirectarchive.com/wp-content/uploads/2024/08/Account-settings.jpg?resize=780%2C564&amp;ssl=1" alt="Account settings"></p><p>Here we will have to browse to the Bucket and also create a Folder from here as discussed above.</p><p><img src="https://i0.wp.com/techdirectarchive.com/wp-content/uploads/2024/08/Add-buckets-and-folders.jpg?resize=780%2C565&amp;ssl=1" alt="Add buckets and folders"></p><p>I will select one of the buckets I have on Wasabi which I created above.</p><p><img src="https://i0.wp.com/techdirectarchive.com/wp-content/uploads/2024/08/Select-Bucket.jpg?resize=780%2C607&amp;ssl=1" alt="Select Bucket"></p><p>I will click on “New Folder” and then specify the name and then click on OK.</p><p><img src="https://i0.wp.com/techdirectarchive.com/wp-content/uploads/2024/08/Folder.jpg?resize=780%2C581&amp;ssl=1" alt="Folder"></p><p>Complies with 3-2-1 rule as a copy of data will be stored off-site.</p><p>Do not forget to check the button “make recent backup immutable” and click next.</p><blockquote><p>Note: Immutability provides protection from ransomware attacks by locking the objects which prevents them from being modified or deleted by malicious software or humans.</p></blockquote><p><img src="https://i0.wp.com/techdirectarchive.com/wp-content/uploads/2024/08/Bucket.jpg?resize=780%2C558&amp;ssl=1" alt="Bucket"></p><p>Here, you must specify to “make the recent backup immutable for x-number of days as you wish”. You bucket must have the object lock and versioning enabled for this to work. Else, you will have to create a new bucket if not enabled previously during creation.</p><p><img src="https://i0.wp.com/techdirectarchive.com/wp-content/uploads/2024/08/Bucket-1.jpg?resize=780%2C558&amp;ssl=1" alt="Bucket"></p><p>Hit the Next button to continue or specify a different mount server.</p><p><img src="https://i0.wp.com/techdirectarchive.com/wp-content/uploads/2024/08/Mount-server.jpg?resize=780%2C560&amp;ssl=1" alt="Mount server"></p><p>Select Apply to continue.</p><p><img src="https://i0.wp.com/techdirectarchive.com/wp-content/uploads/2024/08/Apply-componnets.jpg?resize=780%2C564&amp;ssl=1" alt="Apply componnets"></p><p>Click on Next as shown below</p><p><img src="https://i0.wp.com/techdirectarchive.com/wp-content/uploads/2024/08/settings-applied.jpg?resize=780%2C563&amp;ssl=1" alt="settings applied"></p><p>Lastly, click on Finish to complete the Object Storage creation.</p><p><img src="https://i0.wp.com/techdirectarchive.com/wp-content/uploads/2024/08/finish-object-storage-repo-creation.jpg?resize=780%2C561&amp;ssl=1" alt="finish object storage repo creation"></p><h2 id="create-scale-out-backup-repository" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>Create scale Out Backup Repository</h2><p>Launch the Open Veeam Backup &amp; Replication. Navigate to the “Backup Infrastructure” tab. Right-click on “Scale-Out Repositories” and select “Add Scale-Out Backup Repository.”</p><p><img src="https://i0.wp.com/techdirectarchive.com/wp-content/uploads/2024/08/Create-Scale-out-backup-Repo.jpg?resize=780%2C480&amp;ssl=1" alt="Create Scale out backup Repo"></p><p>SOBR allows you to aggregate multiple backup repositories into a single scalable pool. You can configure your backups to be stored in multiple locations within this pool, effectively creating redundant copies.  </p><h4 id="performance-tier" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>Performance Tier</h4><p>After you add a backup repository or an object storage repository to the scale-out backup repository, they no longer exist as individual backup repositories. When a backup repository or an object storage repository is added as a performance extent, some of its original settings are kept, and some are not.</p><blockquote><p>Note: The performance extents of the scale-out backup repository should be located in the same site. Please refer to Veeam User Guide for what is technically possible when performance extents resides in a different site. Also, you cannot have a mixed configuration and use different types of repositories within one performance tier.</p></blockquote><p>To add some “Extents” (Backup Repositories), click on the Add button.</p><p><img src="https://i0.wp.com/techdirectarchive.com/wp-content/uploads/2024/08/Add-performance-tiers.jpg?resize=780%2C559&amp;ssl=1" alt="Add performance tiers"></p><p>Here you can add your local storage, NAS, and cloud storage as backup repositories as you wish</p><p>I will be selecting two repositories to act as the Performance Tier. These are on two different Synology DS923+ NAS. Click Ok to proceed.</p><p>Please see ‘<a href="https://techdirectarchive.com/2024/04/13/setup-ds923-synology-nas-as-a-backup-repository-for-vbr/">Setup DS923+ Synology NAS as a Backup Repository for VBR</a>“, and how to <a href="https://techdirectarchive.com/2024/04/15/setup-iscsi-target-and-storage-lun-on-synology-ds923-for-vbr/">Setup iSCSI Target and Storage LUN on Synology DS923+ for VBR</a>.</p><blockquote><p>Note: We will be storing backup in two separate media and this help us comply with the 3-2-1, and another offsite to Wasabi Object storage.</p></blockquote><p><img src="https://i0.wp.com/techdirectarchive.com/wp-content/uploads/2024/08/select-extent-1024x732.jpg?resize=780%2C558&amp;ssl=1" alt="select extent"></p><p>Here I am utilizing the Network Attached Storage ((SMB (CIFS)Share), and via Direct Attached Storage (Windows Server) by iSCSI LUN</p><p>Having selected the two repositories, I will click Next to proceed. This ensure you have at least two different types of media and thereby complies to the 3-2-1. we will add the capacity tier extent very soon.</p><p><img src="https://i0.wp.com/techdirectarchive.com/wp-content/uploads/2024/08/Performance-tier.jpg?resize=780%2C563&amp;ssl=1" alt="Performance tier"></p><p>Click on “Yes” in order for the jobs to be automatically updated to point to SOBR.</p><p><img src="https://i0.wp.com/techdirectarchive.com/wp-content/uploads/2024/08/Confirm-auto-update.jpg?resize=780%2C561&amp;ssl=1" alt="Confirm auto update"></p><p>When you configure a scale-out backup repository, you must set the backup file placement policy for backup repositories. The backup file placement policy describes how backup files are distributed between extents.</p><blockquote><p>Note: The&nbsp;Data locality&nbsp;policy does not put any limitations to backup chains. A new backup chain can be stored on the same extent or another extent. For example, if you create an active full backup, Veeam&nbsp;Backup&nbsp;&amp;&nbsp;Replication may store the full backup file to another extent, and all dependent incremental backup files will be stored together with this full backup file.</p></blockquote><p>Select “Data locality” and click on Next.</p><p><img src="https://i0.wp.com/techdirectarchive.com/wp-content/uploads/2024/08/Data-locality.jpg?resize=780%2C560&amp;ssl=1" alt="Data locality"></p><p>If you set the&nbsp;Data locality&nbsp;policy for a scale-out backup repository, all backup files that belong to the same backup chain are stored on the same extent of the scale-out backup repository. A new backup chain can be stored on the same extent or<br>another extent as described in this image.</p><h4 id="capacity-tier" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>Capacity Tier</h4><blockquote><p>Note: You cannot use the same object storage repository as a performance extent and as a capacity extent.</p></blockquote><p>For the Capacity Tier, I will check the button to extend “Scale-out backup repository capacity with object storage”.</p><p><img src="https://i0.wp.com/techdirectarchive.com/wp-content/uploads/2024/08/extend-scale-out-repo.jpg?resize=780%2C557&amp;ssl=1" alt="extend scale out repo"></p><p>Then I will have the option to choose the S3 compatible object storage I have added above and then click on OK.</p><p><img src="https://i0.wp.com/techdirectarchive.com/wp-content/uploads/2024/08/capacity-tier-extent-1024x737.jpg?resize=780%2C561&amp;ssl=1" alt="capacity tier extent"></p><p>Do not forget to check the “<strong>Copy backup to object storage as soon as they are created</strong>“. This help comply with the 3-2-1 rule.</p><blockquote><p>Note: Veeam Backup and Replication uses a “SOBR Offload” background task to copy and/or move the backup data to the Capacity Tier. The SOBR Offload background task uses “Repository Tasks” to transfer the data to the object storage.</p></blockquote><p><img src="https://i0.wp.com/techdirectarchive.com/wp-content/uploads/2024/08/copy-and-move-backup.jpg?resize=780%2C558&amp;ssl=1" alt="copy and move backup"></p><p>The COPY mode ensures 3-2-1 rule unlike the move mode</p><p>Note: If you use some existing REPO for SOBR, Veeam Backup and Replication will detect the existing backup file in your Performance Tier extents (REPO). You will then be asked if you want to copy all existing backups to the Capacity Tier or just the latest backup chains.</p><p>I am fine with the latest backup and will then click on Next to proceed. Here, Veeam Backup &amp; Replication will copy the active backup chain only to the Capacity Tier.</p><p><img src="https://i0.wp.com/techdirectarchive.com/wp-content/uploads/2024/08/Latest-.jpg?resize=780%2C561&amp;ssl=1" alt="Latest"></p><h4 id="sobr-archive-tier" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>SOBR Archive Tier</h4><p>With version 11 of VBR we now are able to integrate a third type of storage into the SOBR called the called “archive tier”.</p><blockquote><p>According to Michael M. and I quote ‘From V10 we already saw the “copy mode”. This now allowed us to fully leverage the capacity tier of the SOBR to obey the 3-2-1 rule by having a copy of the backups in another site. It could even be considered an air-gapped backup as it is only accessible via an API and no direct access to disks whatsoever is possible”. Direct deletion from within Veeam by a rogue admin though is still possible.</p></blockquote><p><img src="https://i0.wp.com/techdirectarchive.com/wp-content/uploads/2024/08/Enable-archive-GFS.jpg?resize=780%2C557&amp;ssl=1" alt="Enable archive GFS"></p><p>If you wish to implement the Archive Tier, please check the button and click on Add as shown below.</p><blockquote><p>Note: Wasabi can be also utilized as an archive tier.&nbsp;Archive data is usually stored on less expensive, slower-performing storage media such as tape, inexpensive disks, or in a remote cloud storage tier that typically has delayed data retrieval time association.</p></blockquote><p><img src="https://i0.wp.com/techdirectarchive.com/wp-content/uploads/2024/08/Add-backup-to-object-storage.jpg?resize=780%2C558&amp;ssl=1" alt="Add backup to object storage"></p><p>For me, I will be testing this feature at a later time. So I have unselected it and will click on Apply to save the SOBR.</p><p><img src="https://i0.wp.com/techdirectarchive.com/wp-content/uploads/2024/08/Apply.jpg?resize=780%2C566&amp;ssl=1" alt="Apply"></p><p>As we can see, the Scale Out Backup Repository (SOBR) is being saved.</p><p><img src="https://i0.wp.com/techdirectarchive.com/wp-content/uploads/2024/08/saving-sobr.jpg?resize=780%2C560&amp;ssl=1" alt="saving sobr"></p><p>Click on finish to close the Scale-out Backup Repository wizard.</p><p><img src="https://i0.wp.com/techdirectarchive.com/wp-content/uploads/2024/08/sobr-complete.jpg?resize=780%2C557&amp;ssl=1" alt="sobr complete"></p><p><img src="https://i0.wp.com/techdirectarchive.com/wp-content/uploads/2024/08/sobr-extents-1024x563.jpg?resize=780%2C429&amp;ssl=1" alt="sobr extents"></p><h2 id="create-backup-job" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>Create Backup Job</h2><p>In the Veeam Backup and Replication console, and click on the Home view. Then select “Backup Job” on the ribbon. I am interested in backing up a Virtual Machine at the moment.</p><p><img src="https://i0.wp.com/techdirectarchive.com/wp-content/uploads/2024/08/Create-backup-job.jpg?resize=780%2C455&amp;ssl=1" alt="Create backup job"></p><p>Enter the Backup name and click next.</p><p><img src="https://i0.wp.com/techdirectarchive.com/wp-content/uploads/2024/08/Backup-job-name.jpg?resize=780%2C558&amp;ssl=1" alt="Backup job name"></p><p>Click on Add and in the “Add Objects” wizard, select the VM and click on OK.</p><p><img src="https://i0.wp.com/techdirectarchive.com/wp-content/uploads/2024/08/Select-VM.jpg?resize=780%2C561&amp;ssl=1" alt="Select VM"></p><p>Click on Next to proceed</p><p><img src="https://i0.wp.com/techdirectarchive.com/wp-content/uploads/2024/08/VM-selected.jpg?resize=780%2C553&amp;ssl=1" alt="VM selected"></p><p>Select the Backup Repository we created above. This is the Scale-out Backup Repository.</p><p><img src="https://i0.wp.com/techdirectarchive.com/wp-content/uploads/2024/08/SOBR-selected.jpg?resize=780%2C556&amp;ssl=1" alt="SOBR selected"></p><p>I am okay with the recommended Backup mode.</p><p><img src="https://i0.wp.com/techdirectarchive.com/wp-content/uploads/2024/08/incrmentaal-recommended.jpg?resize=780%2C609&amp;ssl=1" alt="incrmentaal recommended"></p><p>In this field, you must ensure that the right Object Storage Repository is selected. In this case, the Repository that we have created.</p><p><img src="https://i0.wp.com/techdirectarchive.com/wp-content/uploads/2024/08/Storage-settings.jpg?resize=780%2C563&amp;ssl=1" alt="Storage settings"></p><p>Configuring a secondary backup location is important to ensure redundancy and reliability in case the primary backup location fails or becomes inaccessible. But this is not inline with the scope of this article.</p><p>On Guess processing, I will click next to proceed. If you select “Enable application-aware processing”. This will require you to enter the Guest OS credentials. Click on Next to proceed.</p><p><img src="https://i0.wp.com/techdirectarchive.com/wp-content/uploads/2024/08/Guest-processing.jpg?resize=780%2C557&amp;ssl=1" alt="Guest processing"></p><p>At this time, I do not care about automatic job schedule because this is different for everyone. Click on Apply.</p><p><img src="https://i0.wp.com/techdirectarchive.com/wp-content/uploads/2024/08/Apply-1.jpg?resize=780%2C557&amp;ssl=1" alt="Apply"></p><p>In order to run the job, click on “Run the job when I click Finish”.</p><p><img src="https://i0.wp.com/techdirectarchive.com/wp-content/uploads/2024/08/Run-job-when-I-click-Finish.jpg?resize=780%2C560&amp;ssl=1" alt="Run job when I click Finish"></p><h3 id="vbr-job-progress" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>VBR Job Progress</h3><blockquote><p>To discover on which performance extent of the scale-out backup repository a particular backup file is stored, you can examine the job session statistics or check the backup properties from the inventory pane. Click&nbsp;<strong>Backup</strong>&nbsp;under&nbsp;<strong>Jobs</strong>, in the working area, right-click the job and select&nbsp;<strong>Statistics</strong>. In the bottom left pane of the window, click the VM name. In the&nbsp;<strong>Action</strong>&nbsp;pane, locate the message:&nbsp;“Using ….. repository extent*.</p></blockquote><p>As you can see, the full backup has completed</p><p><img src="https://i0.wp.com/techdirectarchive.com/wp-content/uploads/2024/08/Full-backup.jpg?resize=780%2C427&amp;ssl=1" alt="Full backup"></p><p><img src="https://i0.wp.com/techdirectarchive.com/wp-content/uploads/2024/08/Backup-complete.jpg?resize=780%2C539&amp;ssl=1" alt="Backup complete"></p><p>The client backup offload is running and the Scale-out Backup Repository will kick off as well.</p><p><img src="https://i0.wp.com/techdirectarchive.com/wp-content/uploads/2024/08/Client-backup-offload.jpg?resize=780%2C450&amp;ssl=1" alt="Client backup offload"></p><p>This ensures we achieve the 3-2-1 rule with SOBR on Synology or OOTBI and Wasabi.</p><p>By leveraging SOBR, you can effectively adhere to the 3-2-1 backup rule, enhancing your data protection strategy.</p><p><img src="https://i0.wp.com/techdirectarchive.com/wp-content/uploads/2024/08/offload-to-wasabi.jpg?resize=780%2C425&amp;ssl=1" alt="offload to wasabi"></p><p><img src="https://i0.wp.com/techdirectarchive.com/wp-content/uploads/2024/08/offload.jpg?resize=780%2C548&amp;ssl=1" alt="offload"></p><p>Now you can perform restore also from the Capacity Tier as the backup is available in the object storage.</p><p><img src="https://i0.wp.com/techdirectarchive.com/wp-content/uploads/2024/08/Capacity-Tier-Obkect-storage.jpg?resize=780%2C427&amp;ssl=1" alt="Capacity Tier - Obkect storage"></p><p>Note: Data located in object storage repository is organised into a separate backup chain for every machine in a job.</p><h2 id="start-veeam-sobr-offload-job-manually" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>Start Veeam SOBR Offload Job Manually</h2><p>As already discussed above, Veeam SOBR Offload job is a storage management job to offload the backup from performance tier to capacity tier in SOBR. By default, this job will be kicked off every 4 hour by Veeam server. Below is a “<strong>Hidden</strong>” feature to run the offload job as below.</p><p>To do this, hold down the control button and right-click on the SOBR. Then , click on “Run tiering job now”.</p><p><img src="https://i0.wp.com/techdirectarchive.com/wp-content/uploads/2024/08/Manually-run-tering-job.jpg?resize=780%2C418&amp;ssl=1" alt="Manually run tering job"></p><p>Note: &nbsp;SOBR Offload has the lowest priority. So, if you have any of the other job types running during your SOBR Offload window.<br>The SOBR Offload job(s) may not get assigned enough repository slots to finish within your preferred time frame.</p><h4 id="vm-restore" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>VM Restore</h4><p>Since our backup succeeded without errors, it makes sense to test restoration from the backup we have created. We can perform restore from any of the repository backup. Please take a look at the summary below below for the importance of backup testing.</p><h2 id="implement-3-2-1-rule-with-sobr-summary" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>Implement 3-2-1 Rule with SOBR [Summary]</h2><p>As you can see, we have been able to maintain three copies of our data (original data and two copies), with two different media types (Synology DS923+) NAS, and one kept off-site for redundancy.</p><blockquote><p>In summary, leveraging SOBR in your backup strategy allows you to easily meet the 3-2-1 backup rule by creating multiple copies of your data across different types of storage, including at least one offsite location. This approach enhances data redundancy and ensures data availability in case of local failures or disasters by avoiding a single points of failure. This plays a pivotal role in disaster recovery, adapting to evolving technologies, and meeting compliance requirements</p></blockquote><p>This rule ensure data resiliency, redundancy and provides the ability to recover data even in the face of unexpected events or disasters.</p><p>Note: In today’s digital age, the 3-2-1 Rule has evolved and expanded and we have the 3-2-1-1-0 Rule with at least three backups of your data on two different media, with one off-site and one that is offline, air-gapped, or immutable for zero errors after automated backup testing and recoverability verification with Veeam Data Platform as shown in the image below.</p><p><img src="https://i0.wp.com/techdirectarchive.com/wp-content/uploads/2024/08/3-2-1-1-0-rule.jpg?resize=780%2C311&amp;ssl=1" alt="3-2-1-1-0 rule"></p><p>Backing up your data is not enough – you must ensure that each backup is recoverable, complete, and uncorrupted. Recovery testing is critical because it ensures that you really are protected against disasters and ransomware attacks. SureBackup recovery verification by Veeam is a great way to confidently know that you can restore data.</p><p>I hope you find this article very useful on how to achieve 3-2-1 rule with SOBR on Synology or OOTBI and Wasabi. Please feel free to leave a comment below.</p><div class="contentnav-0-0-11" data-no-search=""><a href="#achieve-3-2-1-rule-with-sobr-on-synology-or-ootbi-and-wasabi" class="h1" data-content-highlight="achieve-3-2-1-rule-with-sobr-on-synology-or-ootbi-and-wasabi">Achieve 3-2-1 rule with SOBR on Synology or OOTBI and Wasabi</a><a href="#tiers-in-scale-out-backup-repo" class="h2" data-content-highlight="tiers-in-scale-out-backup-repo">Tiers in Scale-out Backup Repo</a><a href="#create-wasabi-storage-bucket" class="h4" data-content-highlight="create-wasabi-storage-bucket">Create Wasabi Storage Bucket</a><a href="#create-an-access-key" class="h4" data-content-highlight="create-an-access-key">Create an Access Key</a><a href="#setup-wasabi-s3-veeam-repository" class="h3" data-content-highlight="setup-wasabi-s3-veeam-repository">Setup Wasabi S3 Veeam Repository</a><a href="#create-scale-out-backup-repository" class="h2" data-content-highlight="create-scale-out-backup-repository">Create scale Out Backup Repository</a><a href="#performance-tier" class="h4" data-content-highlight="performance-tier">Performance Tier</a><a href="#capacity-tier" class="h4" data-content-highlight="capacity-tier">Capacity Tier</a><a href="#sobr-archive-tier" class="h4" data-content-highlight="sobr-archive-tier">SOBR Archive Tier</a><a href="#create-backup-job" class="h2" data-content-highlight="create-backup-job">Create Backup Job</a><a href="#vbr-job-progress" class="h3" data-content-highlight="vbr-job-progress">VBR Job Progress</a><a href="#start-veeam-sobr-offload-job-manually" class="h2" data-content-highlight="start-veeam-sobr-offload-job-manually">Start Veeam SOBR Offload Job Manually</a><a href="#vm-restore" class="h4" data-content-highlight="vm-restore">VM Restore</a><a href="#implement-3-2-1-rule-with-sobr-summary" class="h2" data-content-highlight="implement-3-2-1-rule-with-sobr-summary">Implement 3-2-1 Rule with SOBR [Summary]</a></div></div><div id="-codedoc-toc" class="toc-0-0-8"><div class="content-0-0-9"><div class="heading-0-0-3">Index</div><p><a href="/codedoc/">Home</a>
<a href="/codedoc/README">Index</a>
<a href="/codedoc/docs/Kostwein">Kostwein</a></p><div class="collapse-0-0-4 "><script id="aoGaMXPISc">(function(){function load(){if (window.__sdh_transport){window.__sdh_transport("aoGaMXPISc", "yAdNJkOJGbj52dvfV+HpdQ==", {});} }; if (document.readyState == 'complete') load(); else window.addEventListener('load', load); window.setImmediate = window.setImmediate || function(f){setTimeout(f, 0)}; })()</script><div class="label" onclick="this.parentElement.classList.toggle('open')"><span class="text">PSModulesHelp</span><span class="icon-font closed">chevron_right</span></div><div class="content"><p><a href="/codedoc/docs/PSModulesHelp/ModuleDoku">PS Modules Help</a></p><hr></div></div><div class="collapse-0-0-4 "><script id="nYuwoEYYnR">(function(){function load(){if (window.__sdh_transport){window.__sdh_transport("nYuwoEYYnR", "yAdNJkOJGbj52dvfV+HpdQ==", {});} }; if (document.readyState == 'complete') load(); else window.addEventListener('load', load); window.setImmediate = window.setImmediate || function(f){setTimeout(f, 0)}; })()</script><div class="label" onclick="this.parentElement.classList.toggle('open')"><span class="text">KnowledgeBase</span><span class="icon-font closed">chevron_right</span></div><div class="content"><blockquote><p><a href="/codedoc/docs/Knowledge/PowerShell/Index">PowerShell</a></p></blockquote></div></div><div class="collapse-0-0-4 "><script id="YbLzjTjDRm">(function(){function load(){if (window.__sdh_transport){window.__sdh_transport("YbLzjTjDRm", "yAdNJkOJGbj52dvfV+HpdQ==", {});} }; if (document.readyState == 'complete') load(); else window.addEventListener('load', load); window.setImmediate = window.setImmediate || function(f){setTimeout(f, 0)}; })()</script><div class="label" onclick="this.parentElement.classList.toggle('open')"><span class="text">Links</span><span class="icon-font closed">chevron_right</span></div><div class="content"><blockquote><p><a href="/codedoc/docs/Links/LinksWiki">Index</a></p></blockquote></div></div><div class="collapse-0-0-4 "><script id="XKHhWWQYkP">(function(){function load(){if (window.__sdh_transport){window.__sdh_transport("XKHhWWQYkP", "yAdNJkOJGbj52dvfV+HpdQ==", {});} }; if (document.readyState == 'complete') load(); else window.addEventListener('load', load); window.setImmediate = window.setImmediate || function(f){setTimeout(f, 0)}; })()</script><div class="label" onclick="this.parentElement.classList.toggle('open')"><span class="text">Veeam</span><span class="icon-font closed">chevron_right</span></div><div class="content"><blockquote><p><a href="/codedoc/docs/Knowledge/Veeam/Best%20Practices/index">Best Practices</a></p></blockquote></div></div><p><a href="/codedoc/docs/cheat-sheet">Markdown Cheat Sheet</a>
<a href="/codedoc/docs/code-features">Code Features</a></p><p><br><br></p><p>To add links to your other documents, simply
modify contents of <code>docs/md/_toc.md</code>.</p></div><div class="search-0-0-10"><script id="ZoKNWNnoDh">(function(){function load(){if (window.__sdh_transport){window.__sdh_transport("ZoKNWNnoDh", "EKtVWhWp+AfK3O64A4+bOg==", {"repo":"codedoc","user":"In-Pro-Org","root":"docs/md","pick":"\\.md$","drop":"(^_)|(\\/_)"});} }; if (document.readyState == 'complete') load(); else window.addEventListener('load', load); window.setImmediate = window.setImmediate || function(f){setTimeout(f, 0)}; })()</script></div></div><div class="footer-0-0-7"><div class="left"><script id="ZFPxpvHzxH">(function(){function load(){if (window.__sdh_transport){window.__sdh_transport("ZFPxpvHzxH", "wCsMx1XMyC4jNi3FxvjU4g==", {});} }; if (document.readyState == 'complete') load(); else window.addEventListener('load', load); window.setImmediate = window.setImmediate || function(f){setTimeout(f, 0)}; })()</script></div><div class="main"><div class="inside"><a href="https://github.com/In-Pro-Org/codedoc/" target="_blank">GitHub</a></div></div><div class="right"><script id="hUvUlcUfBW">(function(){function load(){if (window.__sdh_transport){window.__sdh_transport("hUvUlcUfBW", "6W59GcSTLBVXRr/Nl/rTkw==", {});} }; if (document.readyState == 'complete') load(); else window.addEventListener('load', load); window.setImmediate = window.setImmediate || function(f){setTimeout(f, 0)}; })()</script></div></div><script id="zuYuzpJQWZ">(function(){function load(){if (window.__sdh_transport){window.__sdh_transport("zuYuzpJQWZ", "zKXJ5zf13oJGCwAAI3JIIA==", {"namespace":"/codedoc"});} }; if (document.readyState == 'complete') load(); else window.addEventListener('load', load); window.setImmediate = window.setImmediate || function(f){setTimeout(f, 0)}; })()</script></body></html>