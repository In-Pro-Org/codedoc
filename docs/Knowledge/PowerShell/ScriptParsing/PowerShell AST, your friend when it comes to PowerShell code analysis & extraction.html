<!DOCTYPE html><html><head><title>Codedoc</title><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"><meta name="robots" content="index,follow"><meta name="theme-color" content="#212121"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><link rel="shortcut icon" href="/codedoc/docs/images/KostweinLogo.ico"><link href="https://fonts.googleapis.com/css?family=Roboto:300,400&amp;display=swap" rel="stylesheet"><link href="https://fonts.googleapis.com/css?family=Source+Code+Pro:300,400&amp;display=swap" rel="stylesheet"><link href="https://fonts.googleapis.com/icon?family=Material+Icons%7CMaterial+Icons+Outlined&amp;display=swap" rel="stylesheet"><style>
      body, input, button {
        font-family: 'Roboto', sans-serif;
      }

      code, .hljs {
        font-family: 'Source Code Pro', 'Courier New', Courier, monospace;
      }

      .icon-font {
        font-family: 'Material Icons';
        font-weight: normal;
        font-style: normal;
        font-size: 24px;  /* Preferred icon size */
        display: inline-block;
        line-height: 1;
        text-transform: none;
        letter-spacing: normal;
        word-wrap: normal;
        white-space: nowrap;
        direction: ltr;
      
        /* Support for all WebKit browsers. */
        -webkit-font-smoothing: antialiased;
        /* Support for Safari and Chrome. */
        text-rendering: optimizeLegibility;
      
        /* Support for Firefox. */
        -moz-osx-font-smoothing: grayscale;
      
        /* Support for IE. */
        font-feature-settings: 'liga';
      }

      .icon-font.outline {
        font-family: 'Material Icons Outlined';
      }
    </style><link href="/codedoc/docs/assets/codedoc-styles.css" rel="stylesheet"><script async="" defer="" src="/codedoc/docs/assets/codedoc-bundle.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css" integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq" crossorigin="anonymous"></head><body data-path="docs\Knowledge\PowerShell\ScriptParsing\PowerShell AST, your friend when it comes to PowerShell code analysis &amp; extraction.md"><div class="header-0-0-6"><script async="" defer="" src="https://buttons.github.io/buttons.js"></script><a class="github-button" data-color-scheme="no-preference: light; light: light; dark: dark;" data-icon="false" data-show-count="true" data-size="false" href="https://github.com/In-Pro-Org/codedoc/">Star</a><br><br><a class="watermark-0-0-5" href="https://github.com/CONNECT-platform/codedoc" target="_blank">Created With<svg viewBox="0 0 536 296" version="1.1" xmlns="http://www.w3.org/2000/svg"><g id="codedoc" transform="translate(-244.000000, -364.000000)" fill-rule="nonzero"><path d="M580,532 C615.346224,532 644,560.653776 644,596 C644,631.346224 615.346224,660 580,660 C544.653776,660 516,631.346224 516,596 C516,560.653776 544.653776,532 580,532 Z M716,532 C751.346224,532 780,560.653776 780,596 C780,631.346224 751.346224,660 716,660 L692,660 C687.581722,660 684,656.418278 684,652 C684,647.581722 687.581722,644 692,644 L716,644 C742.509668,644 764,622.509668 764,596 C764,569.490332 742.509668,548 716,548 L692,548 C687.581722,548 684,544.418278 684,540 C684,535.581722 687.581722,532 692,532 L716,532 Z M468,532 C472.418278,532 476,535.581722 476,540 L476,652 C476,656.418278 472.418278,660 468,660 L444,660 C408.653776,660 380,631.346224 380,596 C380,560.653776 408.653776,532 444,532 L468,532 Z M332,532 C336.418278,532 340,535.581722 340,540 L340,652 C340,656.418278 336.418278,660 332,660 L252,660 C247.581722,660 244,656.418278 244,652 L244,540 C244,535.581722 247.581722,532 252,532 L332,532 Z M580,548 C553.490332,548 532,569.490332 532,596 C532,622.509668 553.490332,644 580,644 C606.509668,644 628,622.509668 628,596 C628,569.490332 606.509668,548 580,548 Z M461,548 L444,548 C417.490332,548 396,569.490332 396,596 C396,622.509668 417.490332,644 444,644 L461,644 L461,548 Z M444,364 C479.346224,364 508,392.653776 508,428 C508,463.346224 479.346224,492 444,492 C408.653776,492 380,463.346224 380,428 C380,392.653776 408.653776,364 444,364 Z M332,364 C336.418278,364 340,367.581722 340,372 C340,376.418278 336.418278,380 332,380 L308,380 C281.490332,380 260,401.490332 260,428 C260,454.509668 281.490332,476 308,476 L332,476 C336.418278,476 340,479.581722 340,484 C340,488.418278 336.418278,492 332,492 L308,492 C272.653776,492 244,463.346224 244,428 C244,392.653776 272.653776,364 308,364 L332,364 Z M580,364 C615.346224,364 644,392.653776 644,428 C644,463.346224 615.346224,492 580,492 L556,492 C551.581722,492 548,488.418278 548,484 L548,372 C548,367.581722 551.581722,364 556,364 L580,364 Z M772,364 C776.418278,364 780,367.581722 780,372 C780,376.418278 776.418278,380 772,380 L700,380 L700,420 L772,420 C776.418278,420 780,423.581722 780,428 C780,432.418278 776.418278,436 772,436 L700,436 L700,476 L772,476 C776.418278,476 780,479.581722 780,484 C780,488.418278 776.418278,492 772,492 L692,492 C687.581722,492 684,488.418278 684,484 L684,372 C684,367.581722 687.581722,364 692,364 L772,364 Z M444,380 C417.490332,380 396,401.490332 396,428 C396,454.509668 417.490332,476 444,476 C470.509668,476 492,454.509668 492,428 C492,401.490332 470.509668,380 444,380 Z M580,380 L563,380 L563,476 L580,476 C606.509668,476 628,454.509668 628,428 C628,401.490332 606.509668,380 580,380 Z"></path></g></svg></a></div><div id="-codedoc-container" class="container"><hr><p>created: 2025-02-20T18:57:11 (UTC +01:00)
tags: []
source: <a href="https://doitpshway.com/powershell-ast-your-friend-when-it-comes-to-powershell-code-analysis-and-extraction">https://doitpshway.com/powershell-ast-your-friend-when-it-comes-to-powershell-code-analysis-and-extraction</a>
author: Ondrej Sebela</p><hr><h1 id="powershell-ast-your-friend-when-it-comes-to-powershell-code-analysis--extraction" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>PowerShell AST, your friend when it comes to PowerShell code analysis &amp; extraction</h1><hr><p>In my previous post about <a href="https://doitpsway.com/automate-powershell-module-creation-the-smart-way">automating PowerShell module creation</a> I've mentioned usage of AST for code analysis. Mainly for extracting information like function definition, aliases etc.</p><p>So today I will show you some basics, plus give you several real world examples, so you can start your own AST journey :).</p><h2 id="table-of-contents" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>Table of contents</h2><ul><li><a href="https://doitpshway.com/powershell-ast-your-friend-when-it-comes-to-powershell-code-analysis-and-extraction#introduction">Introduction</a></li><li><a href="https://doitpshway.com/powershell-ast-your-friend-when-it-comes-to-powershell-code-analysis-and-extraction#what-are-the-necessary-steps-to-use-ast">What are the necessary steps, to use AST?</a><ul><li><a href="https://doitpshway.com/powershell-ast-your-friend-when-it-comes-to-powershell-code-analysis-and-extraction#1-get-ast-object-for-your-code">1. Get AST object for your code</a></li><li><a href="https://doitpshway.com/powershell-ast-your-friend-when-it-comes-to-powershell-code-analysis-and-extraction#2-decide-what-ast-class-type-you-are-looking-for">2. Decide what AST class type you are looking for</a></li><li><a href="https://doitpshway.com/powershell-ast-your-friend-when-it-comes-to-powershell-code-analysis-and-extraction#3-find-specific-type-of-ast-object">3. Find specific type of AST object</a></li></ul></li><li><a href="https://doitpshway.com/powershell-ast-your-friend-when-it-comes-to-powershell-code-analysis-and-extraction#real-world-examples">Real world examples</a><ul><li><a href="https://doitpshway.com/powershell-ast-your-friend-when-it-comes-to-powershell-code-analysis-and-extraction#1-how-to-get-variables">1. How to get variables</a></li><li><a href="https://doitpshway.com/powershell-ast-your-friend-when-it-comes-to-powershell-code-analysis-and-extraction#2-how-to-get-aliases">2. How to get aliases</a></li><li><a href="https://doitpshway.com/powershell-ast-your-friend-when-it-comes-to-powershell-code-analysis-and-extraction#3-how-to-get-function-definition">3. How to get function definition</a></li><li><a href="https://doitpshway.com/powershell-ast-your-friend-when-it-comes-to-powershell-code-analysis-and-extraction#4-how-to-get-function-parameters">4. How to get function parameters</a></li><li><a href="https://doitpshway.com/powershell-ast-your-friend-when-it-comes-to-powershell-code-analysis-and-extraction#5-how-to-get-script-requirements">5. How to get script requirements</a></li></ul></li><li><a href="https://doitpshway.com/powershell-ast-your-friend-when-it-comes-to-powershell-code-analysis-and-extraction#summary">Summary</a></li></ul><h2 id="introduction" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>Introduction</h2><p><strong>AST</strong> is abbreviation of <strong>A</strong>bstract <strong>S</strong>yntax <strong>T</strong>ree and it is built-in PowerShell feature for code analysis. In general it will create hierarchic tree of AST objects, representing given code. You can use it for example to extract various information from the code like variables, function definitions, function parameters, aliases, begin/process/end blocks or to self-aware code analysis (code checks itself).</p><h2 id="what-are-the-necessary-steps-to-use-ast" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>What are the necessary steps, to use AST?</h2><h2 id="1-get-ast-object-for-your-code" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>1. Get AST object for your code</h2><ul><li><p>get AST object from script file</p><pre class="with-bar"><code class="undefined -codedoc-code-snippet code-0-0-12" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span></span></span><div class="line-0-0-16  -codedoc-code-line" data-content="<span># get AST object from script file</span>" id="code1-l1"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">1<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span># get AST object from script file</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="$script = <span>'C:\Scripts\SomeScript.ps1'</span>" id="code1-l2"><span class="lineCounter-0-0-13 -codedoc-line-counter">2<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>$script = <span>'C:\Scripts\SomeScript.ps1'</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="$AST = [System.Management.Automation.Language.Parser]::ParseFile($script, [<span>ref</span>]$null, [<span>ref</span>]$null)" id="code1-l3"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">3<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>$AST = [System.Management.Automation.Language.Parser]::ParseFile($script, [<span>ref</span>]$null, [<span>ref</span>]$null)</div><br></code></pre></li><li><p>get AST object from PowerShell code</p><pre class="with-bar"><code class="undefined -codedoc-code-snippet code-0-0-12" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span></span></span><div class="line-0-0-16  -codedoc-code-line" data-content="<span># get AST object from PowerShell code</span>" id="code2-l1"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">1<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span># get AST object from PowerShell code</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="<span># btw to analyze code from which you call this command, use $MyInvocation.MyCommand.ScriptContents instead $code</span>" id="code2-l2"><span class="lineCounter-0-0-13 -codedoc-line-counter">2<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span># btw to analyze code from which you call this command, use $MyInvocation.MyCommand.ScriptContents instead $code</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="$code = @<span>'" id="code2-l3"><span class="lineCounter-0-0-13 -codedoc-line-counter">3<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>$code = @<span>'</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="some powershell code here" id="code2-l4"><span class="lineCounter-0-0-13 -codedoc-line-counter">4<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>some powershell code here</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="'</span>@" id="code2-l5"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">5<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>'@</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="$AST = [System.Management.Automation.Language.Parser]::ParseInput($code, [ref]$null, [ref]$null)" id="code2-l6"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">6<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>$AST = [System.Management.Automation.Language.Parser]::ParseInput($code, [ref]$null, [ref]$null)</div><br></code></pre><h2 id="2-decide-what-ast-class-type-you-are-looking-for" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>2. Decide what AST class type you are looking for</h2><ul><li><p>for beginners I recommend using great <a href="https://github.com/lzybkr/ShowPSAst">ShowPSAst module</a></p><pre class="with-bar"><code class="undefined -codedoc-code-snippet code-0-0-12" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span></span></span><div class="line-0-0-16  -codedoc-code-line" data-content="<span># install ShowPSAst module</span>" id="code3-l1"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">1<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span># install ShowPSAst module</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="<span>Install</span>-<span>Module</span> -<span>Name</span> ShowPSAst -<span>Scope</span> CurrentUser -<span>Force</span>" id="code3-l2"><span class="lineCounter-0-0-13 -codedoc-line-counter">2<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span>Install</span>-<span>Module</span> -<span>Name</span> ShowPSAst -<span>Scope</span> CurrentUser -<span>Force</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="<span># import commands from ShowPSAst  module</span>" id="code3-l3"><span class="lineCounter-0-0-13 -codedoc-line-counter">3<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span># import commands from ShowPSAst  module</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="<span>Import</span>-<span>Module</span> ShowPSAst" id="code3-l4"><span class="lineCounter-0-0-13 -codedoc-line-counter">4<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span>Import</span>-<span>Module</span> ShowPSAst</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="<span># show the AST of a script or script module</span>" id="code3-l5"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">5<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span># show the AST of a script or script module</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="<span>Show</span>-Ast C:\Scripts\someScript.ps1" id="code3-l6"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">6<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span>Show</span>-Ast C:\Scripts\someScript.ps1</div><br></code></pre><p>It will give you graphical representation of AST object like this <img src="https://cdn.hashnode.com/res/hashnode/image/upload/v1619420083247/ktowNWztF.gif?auto=format,compress&amp;gif-q=60&amp;format=webm" alt="AST_cover.gif"> So it is super easy to find AST type. Just go through the middle column items and corresponding counterparts in analyzed code will be highlighted in the right column.</p></li></ul></li><li><p>Btw there is also more universal tool called <a href="https://devblogs.microsoft.com/scripting/spelunking-with-show-object/">Show-Object</a>, that can visualize <strong>any</strong> PowerShell object</p></li><li><p>Check official documentation <a href="https://docs.microsoft.com/en-us/dotnet/api/system.management.automation.language?redirectedfrom=MSDN&amp;view=powershellsdk-7.0.0">for complete list of AST class types</a></p></li></ul><p>Anyway I've chosen to find function parameters i.e. <strong>ParameterAst</strong>, so lets move on to...</p><h2 id="3-find-specific-type-of-ast-object" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>3. Find specific type of AST object</h2><ul><li>there are two main methods to search the AST object: <code>Find()</code> (return just first result) and <code>FindAll()</code> (return all results)<ul><li>So how to use <code>FindAll()</code>? This method needs two parameters. First one (<em>predicate</em>) is for filtering the results and second one (<em>recurse</em>) is just switch for searching nested scriptBlocks too.</li></ul></li></ul><pre class="with-bar"><code class="undefined -codedoc-code-snippet code-0-0-12" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span></span></span><div class="line-0-0-16  -codedoc-code-line" data-content="<span># search criteria for filtering what AST objects will be returned</span>" id="code4-l1"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">1<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span># search criteria for filtering what AST objects will be returned</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="<span># it has to be scriptBlock which will be evaluated and if the result will be $true, object will be included</span>" id="code4-l2"><span class="lineCounter-0-0-13 -codedoc-line-counter">2<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span># it has to be scriptBlock which will be evaluated and if the result will be $true, object will be included</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="$predicate = {param($astObject) $astObject -is [System.Management.Automation.Language.&amp;lt;placeASTTypeHere&amp;gt;] }" id="code4-l3"><span class="lineCounter-0-0-13 -codedoc-line-counter">3<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>$predicate = {param($astObject) $astObject -is [System.Management.Automation.Language.&lt;placeASTTypeHere&gt;] }</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="" id="code4-l4"><span class="lineCounter-0-0-13 -codedoc-line-counter">4<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="<span># search nested scriptBlocks too</span>" id="code4-l5"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">5<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span># search nested scriptBlocks too</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="$recurse = $true" id="code4-l6"><span class="lineCounter-0-0-13 -codedoc-line-counter">6<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>$recurse = $true</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="" id="code4-l7"><span class="lineCounter-0-0-13 -codedoc-line-counter">7<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="<span># traverse the tree and return all AST objects that match $predicate</span>" id="code4-l8"><span class="lineCounter-0-0-13 -codedoc-line-counter">8<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span># traverse the tree and return all AST objects that match $predicate</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="$AST.FindAll($predicate, $recurse)" id="code4-l9"><span class="lineCounter-0-0-13 -codedoc-line-counter">9<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>$AST.FindAll($predicate, $recurse)</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="" id="code4-l10"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">10<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="" id="code4-l11"><span class="lineCounter-0-0-13 -codedoc-line-counter">11<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="<span># to get all AST objects</span>" id="code4-l12"><span class="lineCounter-0-0-13 -codedoc-line-counter">12<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span># to get all AST objects</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="$AST.FindAll($true, $true)" id="code4-l13"><span class="lineCounter-0-0-13 -codedoc-line-counter">13<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>$AST.FindAll($true, $true)</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="" id="code4-l14"><span class="lineCounter-0-0-13 -codedoc-line-counter">14<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="<span># to get only ParameterAst AST objects</span>" id="code4-l15"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">15<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span># to get only ParameterAst AST objects</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="<span># remember this syntax and just customize the last class part (i.e. ParameterAst in this example)</span>" id="code4-l16"><span class="lineCounter-0-0-13 -codedoc-line-counter">16<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span># remember this syntax and just customize the last class part (i.e. ParameterAst in this example)</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="$AST.FindAll({ param($astObject) $astObject -is [System.Management.Automation.Language.ParameterAst] }, $true)" id="code4-l17"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">17<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>$AST.FindAll({ param($astObject) $astObject -is [System.Management.Automation.Language.ParameterAst] }, $true)</div><br></code></pre><p><img src="https://cdn.hashnode.com/res/hashnode/image/upload/v1619334006377/Jug3XQ2Pb.webp?auto=compress,format&amp;format=webp" alt="ast_findall.webp"></p><h2 id="real-world-examples" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>Real world examples</h2><blockquote><p>I will use this script Hello-World.ps1 for all examples bellow!</p></blockquote><pre class="with-bar"><code class="undefined -codedoc-code-snippet code-0-0-12" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span></span></span><div class="line-0-0-16  -codedoc-code-line" data-content="<span>#Requires -Version 5.1</span>" id="code5-l1"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">1<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span>#Requires -Version 5.1</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="" id="code5-l2"><span class="lineCounter-0-0-13 -codedoc-line-counter">2<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="<span><span>function</span> <span>Hello</span>-<span>World</span> </span>{" id="code5-l3"><span class="lineCounter-0-0-13 -codedoc-line-counter">3<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span><span>function</span> <span>Hello</span>-<span>World</span> </span>{</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="    [Alias(<span>&quot;Invoke-Something&quot;</span>)]" id="code5-l4"><span class="lineCounter-0-0-13 -codedoc-line-counter">4<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    [Alias(<span>"Invoke-Something"</span>)]</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="    param (" id="code5-l5"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">5<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    param (</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="        [<span>string</span>] $name = <span>&quot;Karel&quot;</span>" id="code5-l6"><span class="lineCounter-0-0-13 -codedoc-line-counter">6<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>        [<span>string</span>] $name = <span>"Karel"</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="        ," id="code5-l7"><span class="lineCounter-0-0-13 -codedoc-line-counter">7<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>        ,</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="        [<span>switch</span>] $force" id="code5-l8"><span class="lineCounter-0-0-13 -codedoc-line-counter">8<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>        [<span>switch</span>] $force</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="    )" id="code5-l9"><span class="lineCounter-0-0-13 -codedoc-line-counter">9<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    )</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="" id="code5-l10"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">10<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="    $someInnerVariable = <span>&quot;homeSweetHome&quot;</span>" id="code5-l11"><span class="lineCounter-0-0-13 -codedoc-line-counter">11<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    $someInnerVariable = <span>"homeSweetHome"</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="" id="code5-l12"><span class="lineCounter-0-0-13 -codedoc-line-counter">12<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="    Get-Process -Name $name" id="code5-l13"><span class="lineCounter-0-0-13 -codedoc-line-counter">13<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    Get-Process -Name $name</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="}" id="code5-l14"><span class="lineCounter-0-0-13 -codedoc-line-counter">14<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>}</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="" id="code5-l15"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">15<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="Set-Alias -Name Invoke-SomethingElse -Value Hello-World" id="code5-l16"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">16<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>Set-Alias -Name Invoke-SomethingElse -Value Hello-World</div><br></code></pre><blockquote><p>And create AST object like this</p></blockquote><pre class=""><code class="undefined -codedoc-code-snippet code-0-0-12" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span></span></span><div class="line-0-0-16  -codedoc-code-line" data-content="$AST = [System.Management.Automation.Language.Parser]::ParseFile(<span>'C:\Scripts\Hello-World.ps1'</span>, [<span>ref</span>]$null, [<span>ref</span>]$null)" id="code6-l1"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">1<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>$AST = [System.Management.Automation.Language.Parser]::ParseFile(<span>'C:\Scripts\Hello-World.ps1'</span>, [<span>ref</span>]$null, [<span>ref</span>]$null)</div><br></code></pre><ul><li><h3 id="1-how-to-get-variables" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>1. How to get variables</h3><ul><li>I am using this for <a href="https://github.com/ztrhgf/Powershell_CICD_repository">pre-commit validations</a> of changes made in our company central Variables.psm1 PowerShell module. Specifically to cancel commit, in case, when newly created variable name, doesn't start with underscore. Or to warn the user, if he modify or delete variable, that is used elsewhere in our central repository.</li></ul></li></ul><pre class="with-bar"><code class="undefined -codedoc-code-snippet code-0-0-12" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span></span></span><div class="line-0-0-16  -codedoc-code-line" data-content="<span><span>function</span> <span>_getVariableAST</span> </span>{" id="code7-l1"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">1<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span><span>function</span> <span>_getVariableAST</span> </span>{</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="    param ($AST, $varToExclude, [<span>switch</span>] $raw)" id="code7-l2"><span class="lineCounter-0-0-13 -codedoc-line-counter">2<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    param ($AST, $varToExclude, [<span>switch</span>] $raw)</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="" id="code7-l3"><span class="lineCounter-0-0-13 -codedoc-line-counter">3<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="    $variable = $AST.FindAll( { $args[<span>0</span>] -is [System.Management.Automation.Language.VariableExpressionAst ] }, $true)" id="code7-l4"><span class="lineCounter-0-0-13 -codedoc-line-counter">4<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    $variable = $AST.FindAll( { $args[<span>0</span>] -is [System.Management.Automation.Language.VariableExpressionAst ] }, $true)</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="    $variable = $variable | Where-<span>Object</span> { $_.<span>parent</span>.left -<span>or</span> $_.<span>parent</span>.type -<span>and</span> ($_.<span>parent</span>.operator -eq <span>'Equals'</span> -<span>or</span> $_.<span>parent</span>.<span>parent</span>.operator -eq <span>'Equals'</span>) }" id="code7-l5"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">5<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    $variable = $variable | Where-<span>Object</span> { $_.<span>parent</span>.left -<span>or</span> $_.<span>parent</span>.type -<span>and</span> ($_.<span>parent</span>.operator -eq <span>'Equals'</span> -<span>or</span> $_.<span>parent</span>.<span>parent</span>.operator -eq <span>'Equals'</span>) }</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="" id="code7-l6"><span class="lineCounter-0-0-13 -codedoc-line-counter">6<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="    <span>if</span> ($raw) {" id="code7-l7"><span class="lineCounter-0-0-13 -codedoc-line-counter">7<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span>if</span> ($raw) {</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="        <span>return</span> $variable" id="code7-l8"><span class="lineCounter-0-0-13 -codedoc-line-counter">8<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>        <span>return</span> $variable</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="    }" id="code7-l9"><span class="lineCounter-0-0-13 -codedoc-line-counter">9<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    }</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="" id="code7-l10"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">10<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="    $variable = $variable | Select-<span>Object</span> @{n = <span>&quot;name&quot;</span>; e = { $_.variablepath.userPath } }, @{n = <span>&quot;value&quot;</span>; e = {" id="code7-l11"><span class="lineCounter-0-0-13 -codedoc-line-counter">11<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    $variable = $variable | Select-<span>Object</span> @{n = <span>"name"</span>; e = { $_.variablepath.userPath } }, @{n = <span>"value"</span>; e = {</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="            <span>if</span> ($value = $_.<span>parent</span>.right.extent.text) {" id="code7-l12"><span class="lineCounter-0-0-13 -codedoc-line-counter">12<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>            <span>if</span> ($value = $_.<span>parent</span>.right.extent.text) {</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="                $value" id="code7-l13"><span class="lineCounter-0-0-13 -codedoc-line-counter">13<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>                $value</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="            } <span>else</span> {" id="code7-l14"><span class="lineCounter-0-0-13 -codedoc-line-counter">14<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>            } <span>else</span> {</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="                <span># it is typed variable</span>" id="code7-l15"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">15<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>                <span># it is typed variable</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="                $_.<span>parent</span>.<span>parent</span>.right.extent.text" id="code7-l16"><span class="lineCounter-0-0-13 -codedoc-line-counter">16<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>                $_.<span>parent</span>.<span>parent</span>.right.extent.text</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="            }" id="code7-l17"><span class="lineCounter-0-0-13 -codedoc-line-counter">17<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>            }</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="        }" id="code7-l18"><span class="lineCounter-0-0-13 -codedoc-line-counter">18<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>        }</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="    }" id="code7-l19"><span class="lineCounter-0-0-13 -codedoc-line-counter">19<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    }</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="" id="code7-l20"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">20<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="    <span># because of later comparison unify newline symbol (CRLF vs LF)</span>" id="code7-l21"><span class="lineCounter-0-0-13 -codedoc-line-counter">21<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span># because of later comparison unify newline symbol (CRLF vs LF)</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="    $variable = $variable | Select-<span>Object</span> name, @{n = <span>&quot;value&quot;</span>; e = { $_.value.Replace(<span>&quot;`r`n&quot;</span>, <span>&quot;`n&quot;</span>) } }" id="code7-l22"><span class="lineCounter-0-0-13 -codedoc-line-counter">22<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    $variable = $variable | Select-<span>Object</span> name, @{n = <span>"value"</span>; e = { $_.value.Replace(<span>"`r`n"</span>, <span>"`n"</span>) } }</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="" id="code7-l23"><span class="lineCounter-0-0-13 -codedoc-line-counter">23<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="    <span>if</span> ($varToExclude) {" id="code7-l24"><span class="lineCounter-0-0-13 -codedoc-line-counter">24<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span>if</span> ($varToExclude) {</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="        $variable = $variable | Where-<span>Object</span> { $_.name -notmatch $varToExclude }" id="code7-l25"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">25<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>        $variable = $variable | Where-<span>Object</span> { $_.name -notmatch $varToExclude }</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="    }" id="code7-l26"><span class="lineCounter-0-0-13 -codedoc-line-counter">26<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    }</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="" id="code7-l27"><span class="lineCounter-0-0-13 -codedoc-line-counter">27<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="    <span>return</span> $variable" id="code7-l28"><span class="lineCounter-0-0-13 -codedoc-line-counter">28<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span>return</span> $variable</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="}" id="code7-l29"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">29<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>}</div><br></code></pre><p><img src="https://cdn.hashnode.com/res/hashnode/image/upload/v1619383804384/0A1Ps9FeF.png?auto=compress,format&amp;format=webp" alt="image.png"></p><h3 id="2-how-to-get-aliases" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>2. How to get aliases</h3><p>This is essential for my <a href="https://doitpsway.com/automate-powershell-module-creation-the-smart-way">Export-ScriptToModule</a> function to get all aliases defined in script file, to be able to later export them in generated PowerShell module using Export-ModuleMember.</p><pre class="with-bar"><code class="undefined -codedoc-code-snippet code-0-0-12" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span></span></span><div class="line-0-0-16  -codedoc-code-line" data-content="<span><span>function</span> <span>_getAliasAST</span> </span>{" id="code8-l1"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">1<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span><span>function</span> <span>_getAliasAST</span> </span>{</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="    param ($AST, $functionName)" id="code8-l2"><span class="lineCounter-0-0-13 -codedoc-line-counter">2<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    param ($AST, $functionName)</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="" id="code8-l3"><span class="lineCounter-0-0-13 -codedoc-line-counter">3<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="    $alias = @()" id="code8-l4"><span class="lineCounter-0-0-13 -codedoc-line-counter">4<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    $alias = @()</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="" id="code8-l5"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">5<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="    <span># aliases defined by Set-Alias</span>" id="code8-l6"><span class="lineCounter-0-0-13 -codedoc-line-counter">6<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span># aliases defined by Set-Alias</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="    $AST.EndBlock.Statements | ? { $_ -match <span>&quot;^\s*Set-Alias .+&quot;</span> -<span>and</span> $_ -match [regex]::Escape($functionName) } | % { $_.extent.text } | % {" id="code8-l7"><span class="lineCounter-0-0-13 -codedoc-line-counter">7<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    $AST.EndBlock.Statements | ? { $_ -match <span>"^\s*Set-Alias .+"</span> -<span>and</span> $_ -match [regex]::Escape($functionName) } | % { $_.extent.text } | % {</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="        $parts = $_ -split <span>&quot;\s+&quot;</span>" id="code8-l8"><span class="lineCounter-0-0-13 -codedoc-line-counter">8<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>        $parts = $_ -split <span>"\s+"</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="" id="code8-l9"><span class="lineCounter-0-0-13 -codedoc-line-counter">9<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="        $content += <span>&quot;`n<span>$_</span>&quot;</span>" id="code8-l10"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">10<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>        $content += <span>"`n<span>$_</span>"</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="" id="code8-l11"><span class="lineCounter-0-0-13 -codedoc-line-counter">11<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="        <span>if</span> ($_ -match <span>&quot;-na&quot;</span>) {" id="code8-l12"><span class="lineCounter-0-0-13 -codedoc-line-counter">12<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>        <span>if</span> ($_ -match <span>"-na"</span>) {</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="            <span># alias set by named parameter</span>" id="code8-l13"><span class="lineCounter-0-0-13 -codedoc-line-counter">13<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>            <span># alias set by named parameter</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="            <span># get parameter value</span>" id="code8-l14"><span class="lineCounter-0-0-13 -codedoc-line-counter">14<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>            <span># get parameter value</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="            $i = <span>0</span>" id="code8-l15"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">15<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>            $i = <span>0</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="            $parPosition" id="code8-l16"><span class="lineCounter-0-0-13 -codedoc-line-counter">16<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>            $parPosition</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="            $parts | % {" id="code8-l17"><span class="lineCounter-0-0-13 -codedoc-line-counter">17<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>            $parts | % {</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="                <span>if</span> ($_ -match <span>&quot;-na&quot;</span>) {" id="code8-l18"><span class="lineCounter-0-0-13 -codedoc-line-counter">18<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>                <span>if</span> ($_ -match <span>"-na"</span>) {</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="                    $parPosition = $i" id="code8-l19"><span class="lineCounter-0-0-13 -codedoc-line-counter">19<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>                    $parPosition = $i</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="                }" id="code8-l20"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">20<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>                }</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="                ++$i" id="code8-l21"><span class="lineCounter-0-0-13 -codedoc-line-counter">21<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>                ++$i</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="            }" id="code8-l22"><span class="lineCounter-0-0-13 -codedoc-line-counter">22<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>            }</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="" id="code8-l23"><span class="lineCounter-0-0-13 -codedoc-line-counter">23<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="            $alias += $parts[$parPosition + <span>1</span>]" id="code8-l24"><span class="lineCounter-0-0-13 -codedoc-line-counter">24<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>            $alias += $parts[$parPosition + <span>1</span>]</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="        } <span>else</span> {" id="code8-l25"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">25<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>        } <span>else</span> {</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="            <span># alias set by positional parameter</span>" id="code8-l26"><span class="lineCounter-0-0-13 -codedoc-line-counter">26<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>            <span># alias set by positional parameter</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="            $alias += $parts[<span>1</span>]" id="code8-l27"><span class="lineCounter-0-0-13 -codedoc-line-counter">27<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>            $alias += $parts[<span>1</span>]</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="        }" id="code8-l28"><span class="lineCounter-0-0-13 -codedoc-line-counter">28<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>        }</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="    }" id="code8-l29"><span class="lineCounter-0-0-13 -codedoc-line-counter">29<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    }</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="" id="code8-l30"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">30<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="    <span># aliases defined by [Alias(&quot;Some-Alias&quot;)]</span>" id="code8-l31"><span class="lineCounter-0-0-13 -codedoc-line-counter">31<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span># aliases defined by [Alias("Some-Alias")]</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="    $AST.FindAll( {" id="code8-l32"><span class="lineCounter-0-0-13 -codedoc-line-counter">32<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    $AST.FindAll( {</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="            param([System.Management.Automation.Language.Ast] $AST)" id="code8-l33"><span class="lineCounter-0-0-13 -codedoc-line-counter">33<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>            param([System.Management.Automation.Language.Ast] $AST)</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="" id="code8-l34"><span class="lineCounter-0-0-13 -codedoc-line-counter">34<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="            $AST -is [System.Management.Automation.Language.AttributeAst]" id="code8-l35"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">35<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>            $AST -is [System.Management.Automation.Language.AttributeAst]</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="        }, $true) | ? { $_.<span>parent</span>.extent.text -match <span>'^param'</span> } | Select-<span>Object</span> -ExpandProperty PositionalArguments | Select-<span>Object</span> -ExpandProperty Value -ErrorAction SilentlyContinue | % { $alias += $_ }" id="code8-l36"><span class="lineCounter-0-0-13 -codedoc-line-counter">36<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>        }, $true) | ? { $_.<span>parent</span>.extent.text -match <span>'^param'</span> } | Select-<span>Object</span> -ExpandProperty PositionalArguments | Select-<span>Object</span> -ExpandProperty Value -ErrorAction SilentlyContinue | % { $alias += $_ }</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="" id="code8-l37"><span class="lineCounter-0-0-13 -codedoc-line-counter">37<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="    <span>return</span> $alias" id="code8-l38"><span class="lineCounter-0-0-13 -codedoc-line-counter">38<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span>return</span> $alias</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="}" id="code8-l39"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">39<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>}</div><br></code></pre><p><img src="https://cdn.hashnode.com/res/hashnode/image/upload/v1619385173214/nAlw75wEK.png?auto=compress,format&amp;format=webp" alt="image.png"></p><h3 id="3-how-to-get-function-definition" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>3. How to get function definition</h3><p>This is also essential for my <a href="https://doitpsway.com/automate-powershell-module-creation-the-smart-way">Export-ScriptToModule</a> function to validate number of defined functions in script file (it has to be exactly one), defined function name (it has to match with ps1 name and will be used in Export-ModuleMember) and content (it will be used to generate PowerShell module).</p><pre class="with-bar"><code class="undefined -codedoc-code-snippet code-0-0-12" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span></span></span><div class="line-0-0-16  -codedoc-code-line" data-content="<span><span>function</span> <span>_getFunctionAST</span> </span>{" id="code9-l1"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">1<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span><span>function</span> <span>_getFunctionAST</span> </span>{</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="    param ($AST)" id="code9-l2"><span class="lineCounter-0-0-13 -codedoc-line-counter">2<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    param ($AST)</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="" id="code9-l3"><span class="lineCounter-0-0-13 -codedoc-line-counter">3<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="    $AST.FindAll( {" id="code9-l4"><span class="lineCounter-0-0-13 -codedoc-line-counter">4<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    $AST.FindAll( {</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="            param([System.Management.Automation.Language.Ast] $AST)" id="code9-l5"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">5<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>            param([System.Management.Automation.Language.Ast] $AST)</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="" id="code9-l6"><span class="lineCounter-0-0-13 -codedoc-line-counter">6<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="            $AST -is [System.Management.Automation.Language.FunctionDefinitionAst] -<span>and</span>" id="code9-l7"><span class="lineCounter-0-0-13 -codedoc-line-counter">7<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>            $AST -is [System.Management.Automation.Language.FunctionDefinitionAst] -<span>and</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="            <span># Class methods have a FunctionDefinitionAst under them as well, but we don't want them.</span>" id="code9-l8"><span class="lineCounter-0-0-13 -codedoc-line-counter">8<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>            <span># Class methods have a FunctionDefinitionAst under them as well, but we don't want them.</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="            ($PSVersionTable.PSVersion.Major -lt <span>5</span> -<span>or</span>" id="code9-l9"><span class="lineCounter-0-0-13 -codedoc-line-counter">9<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>            ($PSVersionTable.PSVersion.Major -lt <span>5</span> -<span>or</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="                $AST.<span>Parent</span> -isnot [System.Management.Automation.Language.FunctionMemberAst])" id="code9-l10"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">10<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>                $AST.<span>Parent</span> -isnot [System.Management.Automation.Language.FunctionMemberAst])</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="        }, $true)" id="code9-l11"><span class="lineCounter-0-0-13 -codedoc-line-counter">11<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>        }, $true)</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="}" id="code9-l12"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">12<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>}</div><br></code></pre><p><img src="https://cdn.hashnode.com/res/hashnode/image/upload/v1619385224112/2edk-GiD0.png?auto=compress,format&amp;format=webp" alt="image.png"></p><h3 id="4-how-to-get-function-parameters" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>4. How to get function parameters</h3><ul><li><p>I am using this for <a href="https://github.com/ztrhgf/Powershell_CICD_repository">pre-commit validations</a>. In particular to warn the user, in case he made change in parameter of function, that is used elsewhere in our repository. So he can check, this commit won't break anything.</p><pre class="with-bar"><code class="undefined -codedoc-code-snippet code-0-0-12" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span></span></span><div class="line-0-0-16  -codedoc-code-line" data-content="<span><span>function</span> <span>_getParameterAST</span> </span>{" id="code10-l1"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">1<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span><span>function</span> <span>_getParameterAST</span> </span>{</div><br><div class="line-0-0-16  -codedoc-code-line" data-content=" param ($AST, $functionName)" id="code10-l2"><span class="lineCounter-0-0-13 -codedoc-line-counter">2<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span> param ($AST, $functionName)</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="" id="code10-l3"><span class="lineCounter-0-0-13 -codedoc-line-counter">3<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content=" $parameter = $AST.FindAll( { $args[<span>0</span>] -is [System.Management.Automation.Language.ParamBlockAst] }, $true) | Where-<span>Object</span> { $_.<span>parent</span>.<span>parent</span>.name -eq $functionName }" id="code10-l4"><span class="lineCounter-0-0-13 -codedoc-line-counter">4<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span> $parameter = $AST.FindAll( { $args[<span>0</span>] -is [System.Management.Automation.Language.ParamBlockAst] }, $true) | Where-<span>Object</span> { $_.<span>parent</span>.<span>parent</span>.name -eq $functionName }</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="" id="code10-l5"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">5<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content=" $parameter.parameters | Select-<span>Object</span> @{n = <span>'name'</span>; e = { $_.name.variablepath.userpath } }, @{n = <span>'value'</span>; e = { $_.defaultvalue.extent.text } }, @{ n = <span>'type'</span>; e = { $_.staticType.name } }" id="code10-l6"><span class="lineCounter-0-0-13 -codedoc-line-counter">6<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span> $parameter.parameters | Select-<span>Object</span> @{n = <span>'name'</span>; e = { $_.name.variablepath.userpath } }, @{n = <span>'value'</span>; e = { $_.defaultvalue.extent.text } }, @{ n = <span>'type'</span>; e = { $_.staticType.name } }</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="}" id="code10-l7"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">7<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>}</div><br></code></pre><p><img src="https://cdn.hashnode.com/res/hashnode/image/upload/v1619385286513/K4XELueFR.png?auto=compress,format&amp;format=webp" alt="image.png"></p></li></ul><h3 id="5-how-to-get-script-requirements" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>5. How to get script requirements</h3><p>Again, this is used in <a href="https://doitpsway.com/automate-powershell-module-creation-the-smart-way">Export-ScriptToModule</a> function to have option to exclude requirements from generated PowerShell module.</p><pre class=""><code class="undefined -codedoc-code-snippet code-0-0-12" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span></span></span><div class="line-0-0-16  -codedoc-code-line" data-content="$AST.scriptRequirements.requiredModules.name" id="code11-l1"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">1<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>$AST.scriptRequirements.requiredModules.name</div><br></code></pre><p><img src="https://cdn.hashnode.com/res/hashnode/image/upload/v1619385461705/32MY8DWVa.png?auto=compress,format&amp;format=webp" alt="image.png"></p><h2 id="summary" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>Summary</h2><p>I hope that you've find some useful new information here. In case of any questions, <strong>don't hesitate to write me some comments</strong>! And for those, who want to go deeper into AST, check this <a href="https://powershell.one/powershell-internals/parsing-and-tokenization/abstract-syntax-tree">detailed article about AST</a>.</p><p>PS: I will be talking about GIT hooks automation, and my CI/CD solution in some of upcoming blog posts, don't worry :)</p><div class="contentnav-0-0-11" data-no-search=""><a href="#powershell-ast-your-friend-when-it-comes-to-powershell-code-analysis--extraction" class="h1" data-content-highlight="powershell-ast-your-friend-when-it-comes-to-powershell-code-analysis--extraction">PowerShell AST, your friend when it comes to PowerShell code analysis &amp; extraction</a><a href="#table-of-contents" class="h2" data-content-highlight="table-of-contents">Table of contents</a><a href="#introduction" class="h2" data-content-highlight="introduction">Introduction</a><a href="#what-are-the-necessary-steps-to-use-ast" class="h2" data-content-highlight="what-are-the-necessary-steps-to-use-ast">What are the necessary steps, to use AST?</a><a href="#1-get-ast-object-for-your-code" class="h2" data-content-highlight="1-get-ast-object-for-your-code">1. Get AST object for your code</a><a href="#2-decide-what-ast-class-type-you-are-looking-for" class="h2" data-content-highlight="2-decide-what-ast-class-type-you-are-looking-for">2. Decide what AST class type you are looking for</a><a href="#3-find-specific-type-of-ast-object" class="h2" data-content-highlight="3-find-specific-type-of-ast-object">3. Find specific type of AST object</a><a href="#real-world-examples" class="h2" data-content-highlight="real-world-examples">Real world examples</a><a href="#1-how-to-get-variables" class="h3" data-content-highlight="1-how-to-get-variables">1. How to get variables</a><a href="#2-how-to-get-aliases" class="h3" data-content-highlight="2-how-to-get-aliases">2. How to get aliases</a><a href="#3-how-to-get-function-definition" class="h3" data-content-highlight="3-how-to-get-function-definition">3. How to get function definition</a><a href="#4-how-to-get-function-parameters" class="h3" data-content-highlight="4-how-to-get-function-parameters">4. How to get function parameters</a><a href="#5-how-to-get-script-requirements" class="h3" data-content-highlight="5-how-to-get-script-requirements">5. How to get script requirements</a><a href="#summary" class="h2" data-content-highlight="summary">Summary</a></div></div><div id="-codedoc-toc" class="toc-0-0-8"><div class="content-0-0-9"><div class="heading-0-0-3">Index</div><p><a href="/codedoc/">Home</a>
<a href="/codedoc/README">Index</a>
<a href="/codedoc/docs/Kostwein">Kostwein</a></p><div class="collapse-0-0-4 "><script id="PtpuCBTsLj">(function(){function load(){if (window.__sdh_transport){window.__sdh_transport("PtpuCBTsLj", "yAdNJkOJGbj52dvfV+HpdQ==", {});} }; if (document.readyState == 'complete') load(); else window.addEventListener('load', load); window.setImmediate = window.setImmediate || function(f){setTimeout(f, 0)}; })()</script><div class="label" onclick="this.parentElement.classList.toggle('open')"><span class="text">PSModulesHelp</span><span class="icon-font closed">chevron_right</span></div><div class="content"><p><a href="/codedoc/docs/PSModulesHelp/ModuleDoku">PS Modules Help</a></p><hr></div></div><div class="collapse-0-0-4 "><script id="tOMaCgzfuT">(function(){function load(){if (window.__sdh_transport){window.__sdh_transport("tOMaCgzfuT", "yAdNJkOJGbj52dvfV+HpdQ==", {});} }; if (document.readyState == 'complete') load(); else window.addEventListener('load', load); window.setImmediate = window.setImmediate || function(f){setTimeout(f, 0)}; })()</script><div class="label" onclick="this.parentElement.classList.toggle('open')"><span class="text">KnowledgeBase</span><span class="icon-font closed">chevron_right</span></div><div class="content"><blockquote><p><a href="/codedoc/docs/Knowledge/PowerShell/Index">PowerShell</a></p></blockquote></div></div><div class="collapse-0-0-4 "><script id="ZwGblCnP_q">(function(){function load(){if (window.__sdh_transport){window.__sdh_transport("ZwGblCnP_q", "yAdNJkOJGbj52dvfV+HpdQ==", {});} }; if (document.readyState == 'complete') load(); else window.addEventListener('load', load); window.setImmediate = window.setImmediate || function(f){setTimeout(f, 0)}; })()</script><div class="label" onclick="this.parentElement.classList.toggle('open')"><span class="text">Links</span><span class="icon-font closed">chevron_right</span></div><div class="content"><blockquote><p><a href="/codedoc/docs/Links/LinksWiki">Index</a></p></blockquote></div></div><div class="collapse-0-0-4 "><script id="FczxKmvTgK">(function(){function load(){if (window.__sdh_transport){window.__sdh_transport("FczxKmvTgK", "yAdNJkOJGbj52dvfV+HpdQ==", {});} }; if (document.readyState == 'complete') load(); else window.addEventListener('load', load); window.setImmediate = window.setImmediate || function(f){setTimeout(f, 0)}; })()</script><div class="label" onclick="this.parentElement.classList.toggle('open')"><span class="text">Veeam</span><span class="icon-font closed">chevron_right</span></div><div class="content"><blockquote><p><a href="/codedoc/docs/Knowledge/Veeam/Best%20Practices/index">Best Practices</a></p></blockquote></div></div><p><a href="/codedoc/docs/cheat-sheet">Markdown Cheat Sheet</a>
<a href="/codedoc/docs/code-features">Code Features</a></p><p><br><br></p><p>To add links to your other documents, simply
modify contents of <code>docs/md/_toc.md</code>.</p></div><div class="search-0-0-10"><script id="DKCEGRjFXO">(function(){function load(){if (window.__sdh_transport){window.__sdh_transport("DKCEGRjFXO", "EKtVWhWp+AfK3O64A4+bOg==", {"repo":"codedoc","user":"In-Pro-Org","root":"docs/md","pick":"\\.md$","drop":"(^_)|(\\/_)"});} }; if (document.readyState == 'complete') load(); else window.addEventListener('load', load); window.setImmediate = window.setImmediate || function(f){setTimeout(f, 0)}; })()</script></div></div><div class="footer-0-0-7"><div class="left"><script id="LZn_KdSHVu">(function(){function load(){if (window.__sdh_transport){window.__sdh_transport("LZn_KdSHVu", "wCsMx1XMyC4jNi3FxvjU4g==", {});} }; if (document.readyState == 'complete') load(); else window.addEventListener('load', load); window.setImmediate = window.setImmediate || function(f){setTimeout(f, 0)}; })()</script></div><div class="main"><div class="inside"><a href="https://github.com/In-Pro-Org/codedoc/" target="_blank">GitHub</a></div></div><div class="right"><script id="rUAacExXbq">(function(){function load(){if (window.__sdh_transport){window.__sdh_transport("rUAacExXbq", "6W59GcSTLBVXRr/Nl/rTkw==", {});} }; if (document.readyState == 'complete') load(); else window.addEventListener('load', load); window.setImmediate = window.setImmediate || function(f){setTimeout(f, 0)}; })()</script></div></div><script id="IdLBrpIkvQ">(function(){function load(){if (window.__sdh_transport){window.__sdh_transport("IdLBrpIkvQ", "zKXJ5zf13oJGCwAAI3JIIA==", {"namespace":"/codedoc"});} }; if (document.readyState == 'complete') load(); else window.addEventListener('load', load); window.setImmediate = window.setImmediate || function(f){setTimeout(f, 0)}; })()</script></body></html>