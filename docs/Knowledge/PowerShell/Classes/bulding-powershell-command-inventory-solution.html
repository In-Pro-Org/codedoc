<!DOCTYPE html><html><head><title>Codedoc</title><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"><meta name="robots" content="index,follow"><meta name="theme-color" content="#212121"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><link rel="shortcut icon" href="/codedoc/docs/images/KostweinLogo.ico"><link href="https://fonts.googleapis.com/css?family=Hind:400,700&amp;display=swap" rel="stylesheet"><link href="https://fonts.googleapis.com/css?family=Source+Code+Pro:300,400&amp;display=swap" rel="stylesheet"><link href="https://fonts.googleapis.com/icon?family=Material+Icons%7CMaterial+Icons+Outlined&amp;display=swap" rel="stylesheet"><style>
      body, input, button {
        font-family: 'Hind', sans-serif;
      }

      code, .hljs {
        font-family: 'Source Code Pro', 'Courier New', Courier, monospace;
      }

      .icon-font {
        font-family: 'Material Icons';
        font-weight: normal;
        font-style: normal;
        font-size: 24px;  /* Preferred icon size */
        display: inline-block;
        line-height: 1;
        text-transform: none;
        letter-spacing: normal;
        word-wrap: normal;
        white-space: nowrap;
        direction: ltr;
      
        /* Support for all WebKit browsers. */
        -webkit-font-smoothing: antialiased;
        /* Support for Safari and Chrome. */
        text-rendering: optimizeLegibility;
      
        /* Support for Firefox. */
        -moz-osx-font-smoothing: grayscale;
      
        /* Support for IE. */
        font-feature-settings: 'liga';
      }

      .icon-font.outline {
        font-family: 'Material Icons Outlined';
      }
    </style><link href="/codedoc/docs/assets/codedoc-styles.css" rel="stylesheet"><script async="" defer="" src="/codedoc/docs/assets/codedoc-bundle.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css" integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq" crossorigin="anonymous"></head><body><div class="header-0-0-6"><script async="" defer="" src="https://buttons.github.io/buttons.js"></script><a class="github-button" data-color-scheme="no-preference: light; light: light; dark: dark;" data-icon="false" data-show-count="true" data-size="false" href="https://github.com/In-Pro-Org/codedoc/">Star</a><br><br><a class="watermark-0-0-5" href="https://github.com/CONNECT-platform/codedoc" target="_blank">Created With<svg viewBox="0 0 536 296" version="1.1" xmlns="http://www.w3.org/2000/svg"><g id="codedoc" transform="translate(-244.000000, -364.000000)" fill-rule="nonzero"><path d="M580,532 C615.346224,532 644,560.653776 644,596 C644,631.346224 615.346224,660 580,660 C544.653776,660 516,631.346224 516,596 C516,560.653776 544.653776,532 580,532 Z M716,532 C751.346224,532 780,560.653776 780,596 C780,631.346224 751.346224,660 716,660 L692,660 C687.581722,660 684,656.418278 684,652 C684,647.581722 687.581722,644 692,644 L716,644 C742.509668,644 764,622.509668 764,596 C764,569.490332 742.509668,548 716,548 L692,548 C687.581722,548 684,544.418278 684,540 C684,535.581722 687.581722,532 692,532 L716,532 Z M468,532 C472.418278,532 476,535.581722 476,540 L476,652 C476,656.418278 472.418278,660 468,660 L444,660 C408.653776,660 380,631.346224 380,596 C380,560.653776 408.653776,532 444,532 L468,532 Z M332,532 C336.418278,532 340,535.581722 340,540 L340,652 C340,656.418278 336.418278,660 332,660 L252,660 C247.581722,660 244,656.418278 244,652 L244,540 C244,535.581722 247.581722,532 252,532 L332,532 Z M580,548 C553.490332,548 532,569.490332 532,596 C532,622.509668 553.490332,644 580,644 C606.509668,644 628,622.509668 628,596 C628,569.490332 606.509668,548 580,548 Z M461,548 L444,548 C417.490332,548 396,569.490332 396,596 C396,622.509668 417.490332,644 444,644 L461,644 L461,548 Z M444,364 C479.346224,364 508,392.653776 508,428 C508,463.346224 479.346224,492 444,492 C408.653776,492 380,463.346224 380,428 C380,392.653776 408.653776,364 444,364 Z M332,364 C336.418278,364 340,367.581722 340,372 C340,376.418278 336.418278,380 332,380 L308,380 C281.490332,380 260,401.490332 260,428 C260,454.509668 281.490332,476 308,476 L332,476 C336.418278,476 340,479.581722 340,484 C340,488.418278 336.418278,492 332,492 L308,492 C272.653776,492 244,463.346224 244,428 C244,392.653776 272.653776,364 308,364 L332,364 Z M580,364 C615.346224,364 644,392.653776 644,428 C644,463.346224 615.346224,492 580,492 L556,492 C551.581722,492 548,488.418278 548,484 L548,372 C548,367.581722 551.581722,364 556,364 L580,364 Z M772,364 C776.418278,364 780,367.581722 780,372 C780,376.418278 776.418278,380 772,380 L700,380 L700,420 L772,420 C776.418278,420 780,423.581722 780,428 C780,432.418278 776.418278,436 772,436 L700,436 L700,476 L772,476 C776.418278,476 780,479.581722 780,484 C780,488.418278 776.418278,492 772,492 L692,492 C687.581722,492 684,488.418278 684,484 L684,372 C684,367.581722 687.581722,364 692,364 L772,364 Z M444,380 C417.490332,380 396,401.490332 396,428 C396,454.509668 417.490332,476 444,476 C470.509668,476 492,454.509668 492,428 C492,401.490332 470.509668,380 444,380 Z M580,380 L563,380 L563,476 L580,476 C606.509668,476 628,454.509668 628,428 C628,401.490332 606.509668,380 580,380 Z"></path></g></svg></a></div><div id="-codedoc-container" class="container"><hr><p>title: Building a PowerShell Command Inventory Solution
description: Learn the basics of regular expressions and how I used them to solve this Iron Scripter challenge.
image: /images/ironscripter/command-inventory/code-type-count.png
published: 2020-06-15
tags: ["regex", "regular expressions", "powershell", "learn powershell", "iron scripter", "iron scripter challenge", "iron scripter solution"]
categories: ["PowerShell"]</p><hr><h2 id="introduction" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>Introduction</h2><p>The latest IronScripter challenge, <a href="https://ironscripter.us/building-a-powershell-command-inventory/">Building a PowerShell Command Inventory</a>,
helps us to understand our library of PowerShell code.</p><p>It is also a good way to introduce regular expressions, most commonly called <em>regex</em>.</p><h2 id="regex-and-powershell" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>Regex and PowerShell</h2><p>Before we tackle the challenge, let's briefly discuss regex and how you can use (<em>or probably already have used</em>) regex in PowerShell.</p><h3 id="what-is-regex" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>What is Regex</h3><p>Regex is a pattern used to match text.
A regex pattern can contain letters, numbers, spaces, other characters, operators, and other constructs.</p><p>The regex engine contains categories, like characters, escape characters, character classes, anchors, grouping constructs, quantifiers, and more.
This allows regex patterns to be very simple or incredibly complex.</p><p>There are numerous articles on regex and several questions on public forums.
<em>StackOverflow over <strong>227,700</strong> <a href="https://stackoverflow.com/questions/tagged/regex">questions tagged with regex</a>.</em></p><p>{{&lt; notice type="note" &gt;}}
 This article will only cover a few concepts, just enough to create the solution for the challenge.
{{&lt; /notice &gt;}}</p><h3 id="how-powershell-uses-regex" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>How PowerShell Uses Regex</h3><p>If you've ever used <code>Select-String</code>, <code>-match</code>, <code>-replace</code>, or <code>-split</code>, you have used regex.
You may have used <code>switch</code> before, but many have realized you could use regex patterns as conditions with <code>switch -regex</code>.</p><h4 id="match-text" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>Match Text</h4><p>Consider following comparisons:</p><pre class="with-bar"><code class="powershell -codedoc-code-snippet code-0-0-12" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span></span></span><div class="line-0-0-16  -codedoc-code-line" data-content="PS> 'Challenge' -match 'hall'" id="code1-l1"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">1<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token function">PS</span>&gt; <span class="token string">'Challenge'</span> <span class="token operator">-match</span> <span class="token string">'hall'</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="true" id="code1-l2"><span class="lineCounter-0-0-13 -codedoc-line-counter">2<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>true</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="PS> 'Challenge' -match 'chall'" id="code1-l3"><span class="lineCounter-0-0-13 -codedoc-line-counter">3<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token function">PS</span>&gt; <span class="token string">'Challenge'</span> <span class="token operator">-match</span> <span class="token string">'chall'</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="true" id="code1-l4"><span class="lineCounter-0-0-13 -codedoc-line-counter">4<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>true</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="PS> 'Challenge' -cmatch 'chall'" id="code1-l5"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">5<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token function">PS</span>&gt; <span class="token string">'Challenge'</span> <span class="token operator">-</span>cmatch <span class="token string">'chall'</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="false" id="code1-l6"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">6<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>false</div><br></code></pre><p>In the first statement, the <code>-match</code> operator checks if the text <code>hall</code> is contained in <code>Challenge</code> and returns <code>true</code>.
The next statement also returns <code>true</code> because regular expressions are case-insensitive by default in PowerShell.
In the last statement, we force case sensitivity by using <code>-cmatch</code>.</p><h4 id="regex-character-classes" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>Regex Character Classes</h4><p>Regex places special meaning on some characters.</p><p>For instance, the period <code>.</code> is treated as a wildcard for a single character.
The backslash <code>\</code> character escapes a character or is used to denote a character class.
To match on a period, you can't use <code>.</code> alone; you must escape it like this: <code>\.</code>.</p><p>Word <code>\w</code>, white-space <code>\s</code>, and digit <code>\d</code> are character classes that will match on a single character of the respective types.
To match on the opposite, use the uppercase, like <code>\W</code> for any non-word character such as white-space or punctuation.</p><p>Also, brackets can surround a character group.
To match on any character <code>a</code> through <code>e</code>, you can use the <code>[a-e]</code> character set.</p><p>You can also negate a character set using the caret <code>^</code> after the first bracket, such as <code>[^abcd]</code>.
This negated character set will match on anything without the letters a, b, c, or d.</p><p>{{&lt; notice type="note" &gt;}}
Don't confuse this character class with a table-top roleplaying game class, such as cleric, fighter, wizard, or rogue.
{{&lt; /notice &gt;}}</p><h4 id="regex-quantifiers" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>Regex Quantifiers</h4><p>In the previous section, you may have noticed that many of the classes match on single character.
Regex has quantifiers that can be applied immediately after the class.</p><p>Here are the some common quantifiers:</p><ul><li><code>*</code> - matches the previous element zero or more times</li><li><code>+</code> - matches the previous element one or more times</li><li><code>?</code> - matches the previous element zero or one times</li><li><code>{*n*}</code> - matches the previous element exactly <em>n</em> times</li></ul><p>Using the <code>-Split</code> operator, let's examine how we can combine quantifiers with a character class for specific results.</p><pre class="with-bar"><code class="powershell -codedoc-code-snippet code-0-0-12" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span></span></span><div class="line-0-0-16  -codedoc-code-line" data-content="PS> 'This is my test sentence. And this is another.' -split '\W+'" id="code2-l1"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">1<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token function">PS</span>&gt; <span class="token string">'This is my test sentence. And this is another.'</span> <span class="token operator">-</span>split <span class="token string">'\W+'</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="This" id="code2-l2"><span class="lineCounter-0-0-13 -codedoc-line-counter">2<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>This</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="is" id="code2-l3"><span class="lineCounter-0-0-13 -codedoc-line-counter">3<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>is</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="my" id="code2-l4"><span class="lineCounter-0-0-13 -codedoc-line-counter">4<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>my</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="test" id="code2-l5"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">5<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>test</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="sentence" id="code2-l6"><span class="lineCounter-0-0-13 -codedoc-line-counter">6<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>sentence</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="And" id="code2-l7"><span class="lineCounter-0-0-13 -codedoc-line-counter">7<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>And</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="this" id="code2-l8"><span class="lineCounter-0-0-13 -codedoc-line-counter">8<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>this</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="is" id="code2-l9"><span class="lineCounter-0-0-13 -codedoc-line-counter">9<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>is</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="another" id="code2-l10"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">10<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>another</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="" id="code2-l11"><span class="lineCounter-0-0-13 -codedoc-line-counter">11<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="PS>" id="code2-l12"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">12<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token function">PS</span>&gt;</div><br></code></pre><p><code>-Split</code> returns substrings by splitting the text by <code>\W+</code>, or one or more non-word characters.
Spaces, or white-spaces, and periods are non-word characters.
The first sentence's period and following space is matched with the <code>\W+</code> pattern because of the <code>+</code>.</p><p>Here's another simple <code>-Split</code> example.</p><pre class="with-bar"><code class="powershell -codedoc-code-snippet code-0-0-12" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span></span></span><div class="line-0-0-16  -codedoc-code-line" data-content="PS> 'Anna ate the banana' -split 'n'" id="code3-l1"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">1<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token function">PS</span>&gt; <span class="token string">'Anna ate the banana'</span> <span class="token operator">-</span>split <span class="token string">'n'</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="A" id="code3-l2"><span class="lineCounter-0-0-13 -codedoc-line-counter">2<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>A</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="" id="code3-l3"><span class="lineCounter-0-0-13 -codedoc-line-counter">3<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="a ate the ba" id="code3-l4"><span class="lineCounter-0-0-13 -codedoc-line-counter">4<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>a ate the ba</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="a" id="code3-l5"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">5<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>a</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="a" id="code3-l6"><span class="lineCounter-0-0-13 -codedoc-line-counter">6<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>a</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="PS> 'Anna ate the banana' -split 'n+'" id="code3-l7"><span class="lineCounter-0-0-13 -codedoc-line-counter">7<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token function">PS</span>&gt; <span class="token string">'Anna ate the banana'</span> <span class="token operator">-</span>split <span class="token string">'n+'</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="A" id="code3-l8"><span class="lineCounter-0-0-13 -codedoc-line-counter">8<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>A</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="a ate the ba" id="code3-l9"><span class="lineCounter-0-0-13 -codedoc-line-counter">9<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>a ate the ba</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="a" id="code3-l10"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">10<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>a</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="a" id="code3-l11"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">11<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>a</div><br></code></pre><p>The second pattern matches on <em>nn</em> in Anna and it is treated as a character set to split on.</p><h4 id="regex-anchors-and-alternation" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>Regex Anchors and Alternation</h4><p>The next two regex constructs were the first ones that I used many years ago when I supported Linux.</p><p>A regex pattern with an anchor matches when the text is in the position or grouping indicated by the anchor.</p><p>Here are the meta-character anchors:</p><ul><li><code>^</code> - match must start at the beginning of the string</li><li><code>$</code> - match must be at the end of the string before a newline</li><li><code>\b</code> - match must occur on boundary between a word character and a non-word character</li><li><code>\B</code> - match must not occur on a <code>\b</code> boundary</li></ul><p>Alternation constructs enables either/or matching.
The most common alternation construct is the vertical bar <code>|</code>, sometimes called the pipeline especially in PowerShell.</p><p>You may have come across some code that looks like the following.</p><pre class=""><code class="powershell -codedoc-code-snippet code-0-0-12" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span></span></span><div class="line-0-0-16  -codedoc-code-line" data-content="PS> 'The quick brown fox jumped over the lazy dog.' | Select-String -Pattern 'fox|dog' -AllMatches" id="code4-l1"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">1<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token function">PS</span>&gt; <span class="token string">'The quick brown fox jumped over the lazy dog.'</span> <span class="token punctuation">|</span> <span class="token function">Select-String</span> <span class="token operator">-</span>Pattern <span class="token string">'fox|dog'</span> <span class="token operator">-</span>AllMatches</div><br></code></pre><p>The regex pattern will match on the words (<em>actually each letter is matched</em>) fox and dog.
"The quick brown <code>fox</code> jumped over the lazy <code>dog</code>."</p><h4 id="regex-grouping" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>Regex Grouping</h4><p>The last regex topic we need to cover before delving into the solution for the challenge is grouping.
As in math and PowerShell expression statements, parentheses, <code>(</code> and <code>)</code>, provide the foundation for grouping.</p><p>Each sub-expression in between <code>( )</code> is captured.
The advanced solution uses named groups, which are in the form of <code>(?&lt;group-name&gt;)</code>.
You can define a non-capturing group using <code>(?: sub-expression)</code>.</p><p>{{&lt; notice type="note" &gt;}}
Any regex specifics beyond what we've covered above will be addressed as the topic comes up during examination of the solution.
{{&lt; /notice &gt;}}</p><h2 id="intermediate-challenge" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>Intermediate Challenge</h2><p>With a regex primer behind us, we can now turn to the the first challenge which asks us to count how many lines of code
we have in our repertoire.
Regex will play a role in the part that requires us to skip empty or blank lines.</p><h3 id="sample-output" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>Sample Output</h3><pre class="with-bar"><code class="powershell -codedoc-code-snippet code-0-0-12" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span></span></span><div class="line-0-0-16  -codedoc-code-line" data-content="D:\> $Path = 'D:\GitHub\Workshop\PowerShell'" id="code5-l1"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">1<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>D:\&gt; <span class="token variable">$Path</span> = <span class="token string">'D:\GitHub\Workshop\PowerShell'</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="D:\> $Path | Measure-PSCodeLine" id="code5-l2"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">2<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>D:\&gt; <span class="token variable">$Path</span> <span class="token punctuation">|</span> <span class="token function">Measure-PSCodeLine</span></div><br></code></pre><pre class="with-bar"><code class="shell -codedoc-code-snippet code-0-0-12" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span></span></span><div class="line-0-0-16  -codedoc-code-line" data-content="ParentPath     : D:\GitHub\Workshop" id="code6-l1"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">1<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>ParentPath     <span class="token builtin class-name">:</span> D:<span class="token punctuation">\</span>GitHub<span class="token punctuation">\</span>Workshop</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="TotalFiles     : 62" id="code6-l2"><span class="lineCounter-0-0-13 -codedoc-line-counter">2<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>TotalFiles     <span class="token builtin class-name">:</span> <span class="token number">62</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="TotalCodeLines : 6593" id="code6-l3"><span class="lineCounter-0-0-13 -codedoc-line-counter">3<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>TotalCodeLines <span class="token builtin class-name">:</span> <span class="token number">6593</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="TotalLines     : 7620" id="code6-l4"><span class="lineCounter-0-0-13 -codedoc-line-counter">4<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>TotalLines     <span class="token builtin class-name">:</span> <span class="token number">7620</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="Date           : 6/13/2020 1:21:28 AM" id="code6-l5"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">5<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>Date           <span class="token builtin class-name">:</span> <span class="token number">6</span>/13/2020 <span class="token number">1</span>:21:28 AM</div><br></code></pre><p>This one was fairly simple.</p><p>I used <code>Get-ChildItem</code> with <code>-Recurse</code> to get a list of all the PowerShell files,
as designated by extensions <em>ps1</em> and <em>psm1</em>.
Then, within a <code>Foreach-Object</code> loop, I read each file with <code>Get-Content</code>.</p><p>Next, I pipe the file contents into a <code>Where-Object</code> clause that performs a <code>match</code> on any non-whitespace characters.
In regex terms, this is a <code>\S</code> (<em>uppercase S</em>).
This gets me the non-empty or blank lines.</p><pre class=""><code class="powershell -codedoc-code-snippet code-0-0-12" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span></span></span><div class="line-0-0-16  -codedoc-code-line" data-content="$CodeComments = $Content | Where-Object { $_ -match '\S' }" id="code7-l1"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">1<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token variable">$CodeComments</span> = <span class="token variable">$Content</span> <span class="token punctuation">|</span> <span class="token function">Where-Object</span> <span class="token punctuation">{</span> <span class="token variable">$_</span> <span class="token operator">-match</span> <span class="token string">'\S'</span> <span class="token punctuation">}</span></div><br></code></pre><p>Lastly, I return a <code>PSCustomObject</code> with the required fields and counts.</p><p>{{&lt; notice type="tip" &gt;}}
By default, <code>Get-Content</code> will read a file line-by-line and produces an array of strings.
If you want to read the complete file as a single string object, you must include the <code>-Raw</code> switch.
This really useful when you are reading the contents of a JSON file, as the <code>ConvertFrom-Json</code> command
will only work on a string object, not the array that you get without the <code>-Raw</code> switch.
{{&lt; /notice &gt;}}</p><h2 id="advanced-challenge" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>Advanced Challenge</h2><p>The advanced challenge wants us to get a list of commands that we use in the same scripts that we just inventoried.
This list of commands should be sorted by the number of times used.</p><p>For extra credit, we should be able to detect and expand aliases and, as an extra challenge, provide a array of files
that contain the command.</p><p>I thought about the heart of this challenge.
Getting a command, in the <code>Verb-Noun</code> format, would be relatively simple with the right regex.
Discovering aliases used would be a bit harder.</p><p>But, why stop there?
Why not include <code>CmdletBinding</code> or <code>Parameter</code> attributes?
How often do you use <code>trap</code> or a <code>try/catch</code> block?</p><p>It would be nice to have a tool that parses your PowerShell code and reveals what parts of the PowerShell language you
frequently use.
And I wanted to have this information by file and where in the file the structure was found, namely line number and
index within that line.
So that's what I built to solve the advanced challenge.</p><p>I crafted some regex patterns for each of these code constructs.</p><ul><li>Verb-Noun</li><li>DotNetObjects</li><li>-f operator</li><li>Function</li><li>Class</li><li>Variable declaration</li><li>CmdletBinding</li><li>Parameter</li><li>Param declaration</li><li>DynamicParam declaration</li><li>Try/Catch/Finally</li><li>Trap</li><li>Enum definition</li><li>Loop statements<ul><li>for, foreach, do/while, do/until, while</li></ul></li><li>Switch statements</li></ul><p>{{&lt; notice type="tip" &gt;}}
I intentionally made it easy to add additional code types.
Just look at the complete function and you will see how you can add constructs by adding additional keys with regex
patterns that puts the construct into a a named group.
{{&lt; /notice &gt;}}</p><h3 id="powershell-code-structure-regex" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>PowerShell Code Structure Regex</h3><p>The most critical regex is the one that detects a PowerShell command.
Lucky for us, a PowerShell command is in the form of <code>Verb-Noun</code>.</p><p>How do we make a regex pattern to match on this?</p><p>First, there can be any number of spaces before and after the command.
The verb and noun component will always be a word character, probably more than one word character per component.
And we need to handle that dash <code>-</code>.</p><p>Based on the previous paragraph, we can create this regex pattern: <code>\s+(\w+\-\w+)\s+</code>.
This should read as "any number of white-spaces before a grouping of any number of word characters followed immediately
by a literal dash then any number of word characters ending the grouping followed by any number of white-spaces".</p><p>While this may appear to be adequate, and in another use case might be, it would be better if we named the group so we
can use the group name in cataloging the code structure.
We now have the pattern <code>\s+(?&lt;PSVerbNoun&gt;\w+\-\w+)\s+</code> with the group name called <code>PSVerbNoun</code>.</p><p>In <code>Get-PSCodeStructure</code>, I created an ordered hashtable with each of the required code type regex pattern in sequence.
Note that the key is not important other than establishing the hashtable.
The regex patterns can be pulled from the hashtable using the <code>$PSPatterns.Values</code> attribute of the hashtable.</p><p>This array of values can then be concatenated using <code>-join</code> and the regex alternation character, the vertical bar <code>|</code>.
The complete, and now much more complex, regex pattern is made using <code>$RegExPattern = $PSPatterns.Values -join '|'</code>.</p><h4 id="powershell-regex-matches" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>PowerShell Regex Matches</h4><p>In order for our named groups to function as we need, we need something other than <code>Select-String -AllMatches</code>.
Also, according to the documentation, the <code>$Matches</code> hashtable will only contain the first occurrence of any matching pattern.</p><pre class=""><code class="powershell -codedoc-code-snippet code-0-0-12" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span></span></span><div class="line-0-0-16  -codedoc-code-line" data-content="D:\> '$Variable = Get-Content -Path $Path' | select-string -pattern $RegExPattern" id="code8-l1"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">1<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>D:\&gt; <span class="token string">'$Variable = Get-Content -Path $Path'</span> <span class="token punctuation">|</span> <span class="token function">select-string</span> <span class="token operator">-</span>pattern <span class="token variable">$RegExPattern</span></div><br></code></pre><p>This only gives us the first match, <code>$Variable =</code> Get-Content $path.</p><pre class=""><code class="powershell -codedoc-code-snippet code-0-0-12" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span></span></span><div class="line-0-0-16  -codedoc-code-line" data-content="D:\> '$Variable = Get-Content -Path $Path' | select-string -pattern $RegExPattern -AllMatches" id="code9-l1"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">1<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>D:\&gt; <span class="token string">'$Variable = Get-Content -Path $Path'</span> <span class="token punctuation">|</span> <span class="token function">select-string</span> <span class="token operator">-</span>pattern <span class="token variable">$RegExPattern</span> <span class="token operator">-</span>AllMatches</div><br></code></pre><p>This only gives us both matches, "<code>$Variable = Get-Content</code> -Path $path", but <code>$Matches</code> does not have the second match.</p><pre class=""><code class="powershell -codedoc-code-snippet code-0-0-12" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span></span></span><div class="line-0-0-16  -codedoc-code-line" data-content="D:\> $Matches" id="code10-l1"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">1<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>D:\&gt; <span class="token variable">$Matches</span></div><br></code></pre><pre class="with-bar"><code class="powershell -codedoc-code-snippet code-0-0-12" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span></span></span><div class="line-0-0-16  -codedoc-code-line" data-content="Name                           Value" id="code11-l1"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">1<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>Name                           Value</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="----                           -----" id="code11-l2"><span class="lineCounter-0-0-13 -codedoc-line-counter">2<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token operator">--</span><span class="token operator">--</span>                           <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="VariableDeclaration            $Variable" id="code11-l3"><span class="lineCounter-0-0-13 -codedoc-line-counter">3<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>VariableDeclaration            <span class="token variable">$Variable</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="1                              $Variable =" id="code11-l4"><span class="lineCounter-0-0-13 -codedoc-line-counter">4<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>1                              <span class="token variable">$Variable</span> =</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="0                              $Variable =" id="code11-l5"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">5<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>0                              <span class="token variable">$Variable</span> =</div><br></code></pre><p>Because of this limitation, we have to use the .Net class for <code>[regex]</code>.
Let's look at the class constructor overloads.</p><pre class="with-bar"><code class="powershell -codedoc-code-snippet code-0-0-12" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span></span></span><div class="line-0-0-16  -codedoc-code-line" data-content="[regex]::new" id="code12-l1"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">1<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token namespace">[regex]</span>::new</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="" id="code12-l2"><span class="lineCounter-0-0-13 -codedoc-line-counter">2<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="OverloadDefinitions" id="code12-l3"><span class="lineCounter-0-0-13 -codedoc-line-counter">3<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>OverloadDefinitions</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="-------------------" id="code12-l4"><span class="lineCounter-0-0-13 -codedoc-line-counter">4<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="regex new(string pattern)" id="code12-l5"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">5<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>regex new<span class="token punctuation">(</span>string pattern<span class="token punctuation">)</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="regex new(string pattern, System.Text.RegularExpressions.RegexOptions options)" id="code12-l6"><span class="lineCounter-0-0-13 -codedoc-line-counter">6<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>regex new<span class="token punctuation">(</span>string pattern<span class="token punctuation">,</span> System<span class="token punctuation">.</span>Text<span class="token punctuation">.</span>RegularExpressions<span class="token punctuation">.</span>RegexOptions options<span class="token punctuation">)</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="regex new(string pattern, System.Text.RegularExpressions.RegexOptions options, timespan matchTimeout)" id="code12-l7"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">7<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>regex new<span class="token punctuation">(</span>string pattern<span class="token punctuation">,</span> System<span class="token punctuation">.</span>Text<span class="token punctuation">.</span>RegularExpressions<span class="token punctuation">.</span>RegexOptions options<span class="token punctuation">,</span> timespan matchTimeout<span class="token punctuation">)</span></div><br></code></pre><p>We need the string pattern and, optionally, we can supply regex options and a timeout.
Unlike PowerShell, the .Net class is case sensitive, so we need to instruct it to ignore case.
<em>Note: We won't be using the matchTimeout parameter.</em></p><p>The <code>regex</code> class has a method called <code>Matches()</code> which will provide us all matches.</p><pre class="with-bar"><code class="powershell -codedoc-code-snippet code-0-0-12" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span></span></span><div class="line-0-0-16  -codedoc-code-line" data-content="D:\> $RegexOptions = [System.Text.RegularExpressions.RegexOptions]::IgnoreCase, [System.Text.RegularExpressions.RegexOptions]::CultureInvariant" id="code13-l1"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">1<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>D:\&gt; <span class="token variable">$RegexOptions</span> = <span class="token namespace">[System.Text.RegularExpressions.RegexOptions]</span>::IgnoreCase<span class="token punctuation">,</span> <span class="token namespace">[System.Text.RegularExpressions.RegexOptions]</span>::CultureInvariant</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="D:\> $Regex = [regex]::new($RegExPattern,$RegexOptions)" id="code13-l2"><span class="lineCounter-0-0-13 -codedoc-line-counter">2<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>D:\&gt; <span class="token variable">$Regex</span> = <span class="token namespace">[regex]</span>::new<span class="token punctuation">(</span><span class="token variable">$RegExPattern</span><span class="token punctuation">,</span><span class="token variable">$RegexOptions</span><span class="token punctuation">)</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="D:\> $Regex.Matches('$Variable = Get-Content $path')" id="code13-l3"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">3<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>D:\&gt; <span class="token variable">$Regex</span><span class="token punctuation">.</span>Matches<span class="token punctuation">(</span><span class="token string">'$Variable = Get-Content $path'</span><span class="token punctuation">)</span></div><br></code></pre><p>This produces the following output.</p><pre class="with-bar"><code class="powershell -codedoc-code-snippet code-0-0-12" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span></span></span><div class="line-0-0-16  -codedoc-code-line" data-content="Groups   : {0, 1, 2, 3…}" id="code14-l1"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">1<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>Groups   : <span class="token punctuation">{</span>0<span class="token punctuation">,</span> 1<span class="token punctuation">,</span> 2<span class="token punctuation">,</span> 3…<span class="token punctuation">}</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="Success  : True" id="code14-l2"><span class="lineCounter-0-0-13 -codedoc-line-counter">2<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>Success  : True</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="Name     : 0" id="code14-l3"><span class="lineCounter-0-0-13 -codedoc-line-counter">3<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>Name     : 0</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="Captures : {0}" id="code14-l4"><span class="lineCounter-0-0-13 -codedoc-line-counter">4<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>Captures : <span class="token punctuation">{</span>0<span class="token punctuation">}</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="Index    : 0" id="code14-l5"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">5<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>Index    : 0</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="Length   : 11" id="code14-l6"><span class="lineCounter-0-0-13 -codedoc-line-counter">6<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>Length   : 11</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="Value    : $Variable =" id="code14-l7"><span class="lineCounter-0-0-13 -codedoc-line-counter">7<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>Value    : <span class="token variable">$Variable</span> =</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="" id="code14-l8"><span class="lineCounter-0-0-13 -codedoc-line-counter">8<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="Groups   : {0, 1, 2, 3…}" id="code14-l9"><span class="lineCounter-0-0-13 -codedoc-line-counter">9<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>Groups   : <span class="token punctuation">{</span>0<span class="token punctuation">,</span> 1<span class="token punctuation">,</span> 2<span class="token punctuation">,</span> 3…<span class="token punctuation">}</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="Success  : True" id="code14-l10"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">10<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>Success  : True</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="Name     : 0" id="code14-l11"><span class="lineCounter-0-0-13 -codedoc-line-counter">11<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>Name     : 0</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="Captures : {0}" id="code14-l12"><span class="lineCounter-0-0-13 -codedoc-line-counter">12<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>Captures : <span class="token punctuation">{</span>0<span class="token punctuation">}</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="Index    : 11" id="code14-l13"><span class="lineCounter-0-0-13 -codedoc-line-counter">13<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>Index    : 11</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="Length   : 13" id="code14-l14"><span class="lineCounter-0-0-13 -codedoc-line-counter">14<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>Length   : 13</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="Value    :  Get-Content" id="code14-l15"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">15<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>Value    :  <span class="token function">Get-Content</span></div><br></code></pre><p>We then need to filter on the groups that matched (<em>Success is true</em>) and are named (<em>Name not an integer</em>).</p><pre class=""><code class="powershell -codedoc-code-snippet code-0-0-12" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span></span></span><div class="line-0-0-16  -codedoc-code-line" data-content="D:\> $Regex.Matches('$Variable = Get-Content $path').Groups.Where{$_.Success -and $_.Name -notmatch '\d+' }" id="code15-l1"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">1<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>D:\&gt; <span class="token variable">$Regex</span><span class="token punctuation">.</span>Matches<span class="token punctuation">(</span><span class="token string">'$Variable = Get-Content $path'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Groups<span class="token punctuation">.</span>Where<span class="token punctuation">{</span><span class="token variable">$_</span><span class="token punctuation">.</span>Success <span class="token operator">-and</span> <span class="token variable">$_</span><span class="token punctuation">.</span>Name <span class="token operator">-notmatch</span> <span class="token string">'\d+'</span> <span class="token punctuation">}</span></div><br></code></pre><p>And this gives us what we ultimately needed.</p><pre class="with-bar"><code class="powershell -codedoc-code-snippet code-0-0-12" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span></span></span><div class="line-0-0-16  -codedoc-code-line" data-content="Success  : True" id="code16-l1"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">1<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>Success  : True</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="Name     : VariableDeclaration" id="code16-l2"><span class="lineCounter-0-0-13 -codedoc-line-counter">2<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>Name     : VariableDeclaration</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="Captures : {VariableDeclaration}" id="code16-l3"><span class="lineCounter-0-0-13 -codedoc-line-counter">3<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>Captures : <span class="token punctuation">{</span>VariableDeclaration<span class="token punctuation">}</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="Index    : 0" id="code16-l4"><span class="lineCounter-0-0-13 -codedoc-line-counter">4<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>Index    : 0</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="Length   : 9" id="code16-l5"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">5<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>Length   : 9</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="Value    : $Variable" id="code16-l6"><span class="lineCounter-0-0-13 -codedoc-line-counter">6<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>Value    : <span class="token variable">$Variable</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="" id="code16-l7"><span class="lineCounter-0-0-13 -codedoc-line-counter">7<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="Success  : True" id="code16-l8"><span class="lineCounter-0-0-13 -codedoc-line-counter">8<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>Success  : True</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="Name     : PSVerbNoun" id="code16-l9"><span class="lineCounter-0-0-13 -codedoc-line-counter">9<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>Name     : PSVerbNoun</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="Captures : {PSVerbNoun}" id="code16-l10"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">10<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>Captures : <span class="token punctuation">{</span>PSVerbNoun<span class="token punctuation">}</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="Index    : 12" id="code16-l11"><span class="lineCounter-0-0-13 -codedoc-line-counter">11<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>Index    : 12</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="Length   : 11" id="code16-l12"><span class="lineCounter-0-0-13 -codedoc-line-counter">12<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>Length   : 11</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="Value    : Get-Content" id="code16-l13"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">13<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>Value    : <span class="token function">Get-Content</span></div><br></code></pre><ul><li>The Name is the group name of the specific code structure type.</li><li>The Value is the captured value from the pattern.</li><li>The Index is the position the match was found</li></ul><p>We use these three to build the <code>PSCustomObject</code> which is outputted into the pipeline.</p><h4 id="handling-false-positives" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>Handling False Positives</h4><p>So far, we have a regex pattern that will match on <code>Verb-Noun</code>.
Unfortunately, at least the way I've written it, this pattern will lead to false positives.</p><pre class="with-bar"><code class="powershell -codedoc-code-snippet code-0-0-12" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span></span></span><div class="line-0-0-16  -codedoc-code-line" data-content="D:\> 'key. Volume-licensed systems require upgrading from a qualifying operating system.' -match '\s+(?<PSVerbNoun>\w+\-\w+)\s+'" id="code17-l1"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">1<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>D:\&gt; <span class="token string">'key. Volume-licensed systems require upgrading from a qualifying operating system.'</span> <span class="token operator">-match</span> <span class="token string">'\s+(?&lt;PSVerbNoun&gt;\w+\-\w+)\s+'</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="True" id="code17-l2"><span class="lineCounter-0-0-13 -codedoc-line-counter">2<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>True</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="D:\> $Matches" id="code17-l3"><span class="lineCounter-0-0-13 -codedoc-line-counter">3<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>D:\&gt; <span class="token variable">$Matches</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="Name                           Value" id="code17-l4"><span class="lineCounter-0-0-13 -codedoc-line-counter">4<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>Name                           Value</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="----                           -----" id="code17-l5"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">5<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token operator">--</span><span class="token operator">--</span>                           <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="PSVerbNoun                     Volume-licensed" id="code17-l6"><span class="lineCounter-0-0-13 -codedoc-line-counter">6<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>PSVerbNoun                     Volume-licensed</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="0                               Volume-licensed" id="code17-l7"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">7<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>0                               Volume-licensed</div><br></code></pre><p>Clearly, <em>Volume-licensed</em> is not the name of a PowerShell command.
I needed something to negate the false positives.</p><p>The method I chose was to check the <code>Verb</code> of the matched value with a list of approved PowerShell verbs.</p><pre class="with-bar"><code class="powershell -codedoc-code-snippet code-0-0-12" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span></span></span><div class="line-0-0-16  -codedoc-code-line" data-content="$Verbs = (Get-Verb).Verb" id="code18-l1"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">1<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token variable">$Verbs</span> = <span class="token punctuation">(</span><span class="token function">Get-Verb</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Verb</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="# <truncated>" id="code18-l2"><span class="lineCounter-0-0-13 -codedoc-line-counter">2<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token comment"># &lt;truncated&gt;</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="Where-Object { if ($_.Type -ne 'PSVerbNoun') { $_ } else {" id="code18-l3"><span class="lineCounter-0-0-13 -codedoc-line-counter">3<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token function">Where-Object</span> <span class="token punctuation">{</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$_</span><span class="token punctuation">.</span><span class="token function">Type</span> <span class="token operator">-ne</span> <span class="token string">'PSVerbNoun'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token variable">$_</span> <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="    if ($Verbs -contains $_.Command.Split('-')[0]) {" id="code18-l4"><span class="lineCounter-0-0-13 -codedoc-line-counter">4<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$Verbs</span> <span class="token operator">-contains</span> <span class="token variable">$_</span><span class="token punctuation">.</span>Command<span class="token punctuation">.</span>Split<span class="token punctuation">(</span><span class="token string">'-'</span><span class="token punctuation">)</span><span class="token punctuation">[</span>0<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="        $_" id="code18-l5"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">5<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>        <span class="token variable">$_</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="    }" id="code18-l6"><span class="lineCounter-0-0-13 -codedoc-line-counter">6<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span class="token punctuation">}</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="}}" id="code18-l7"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">7<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token punctuation">}</span><span class="token punctuation">}</span></div><br></code></pre><p>{{&lt; notice type="warning" &gt;}}
Matching on approved verbs will skip any commands that you use which do not use approved verbs.
For instance, the <code>Encode-Sqlname</code> and <code>Decode-Sqlname</code> commands from the module <code>SqlPS</code> would not match and, therefore,
would not be in our inventory.</p><p>Perhaps someone with greater <strong>regex-foo</strong> or a better idea on how to filter out false positives can comment below.
{{&lt; /notice &gt;}}</p><h3 id="capture-code-structure-into-variable" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>Capture Code Structure into Variable</h3><pre class=""><code class="powershell -codedoc-code-snippet code-0-0-12" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span></span></span><div class="line-0-0-16  -codedoc-code-line" data-content="D:\> $CodeInfo = $Path | Get-PSCodeStructure -Recurse" id="code19-l1"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">1<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>D:\&gt; <span class="token variable">$CodeInfo</span> = <span class="token variable">$Path</span> <span class="token punctuation">|</span> <span class="token function">Get-PSCodeStructure</span> <span class="token operator">-</span>Recurse</div><br></code></pre><pre class="with-bar"><code class="powershell -codedoc-code-snippet code-0-0-12" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span></span></span><div class="line-0-0-16  -codedoc-code-line" data-content="FileCount    : 63" id="code20-l1"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">1<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>FileCount    : 63</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="Elapsed Time : 0h 0m 13.42s" id="code20-l2"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">2<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>Elapsed Time : 0h 0m 13<span class="token punctuation">.</span>42s</div><br></code></pre><p>The <em>FileCount</em> and <em>Elapsed Time</em> is written to the <em>Information Stream</em>.
I think the <em>Information Stream</em> is underutilized.
It's a great way to provide the user information and it doesn't "clutter" up the standard output stream, like <code>Write-Host</code>
or <code>Write-Output</code> would do.</p><h3 id="sample-object" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>Sample Object</h3><p>Let's take a look at the first discovered code structure.</p><pre class=""><code class="powershell -codedoc-code-snippet code-0-0-12" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span></span></span><div class="line-0-0-16  -codedoc-code-line" data-content="D:\> $CodeInfo[0]" id="code21-l1"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">1<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>D:\&gt; <span class="token variable">$CodeInfo</span><span class="token punctuation">[</span>0<span class="token punctuation">]</span></div><br></code></pre><pre class="with-bar"><code class="powershell -codedoc-code-snippet code-0-0-12" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span></span></span><div class="line-0-0-16  -codedoc-code-line" data-content="FileName     : BuildOnlineHelpLanding.ps1" id="code22-l1"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">1<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>FileName     : BuildOnlineHelpLanding<span class="token punctuation">.</span>ps1</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="FileFullName : D:\GitHub\Workshop\PowerShell\Functions\BuildOnlineHelpLanding.ps1" id="code22-l2"><span class="lineCounter-0-0-13 -codedoc-line-counter">2<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>FileFullName : D:\GitHub\Workshop\PowerShell\Functions\BuildOnlineHelpLanding<span class="token punctuation">.</span>ps1</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="Line         : 1" id="code22-l3"><span class="lineCounter-0-0-13 -codedoc-line-counter">3<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>Line         : 1</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="Index        : 0" id="code22-l4"><span class="lineCounter-0-0-13 -codedoc-line-counter">4<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>Index        : 0</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="Type         : FunctionDefinition" id="code22-l5"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">5<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token function">Type</span>         : FunctionDefinition</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="AliasName    :" id="code22-l6"><span class="lineCounter-0-0-13 -codedoc-line-counter">6<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>AliasName    :</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="Command      : function New-OnlineHelpLanding" id="code22-l7"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">7<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>Command      : <span class="token keyword">function</span> <span class="token function">New-OnlineHelpLanding</span></div><br></code></pre><p>We have all of the critical pieces of data we would need about this structure.
We know the file, the structure type, what line contains it, where it is in the line, and the command itself.</p><p>The <code>AliasName</code> property will contain the alias and the <code>Command</code> will contain the full command name.</p><p>{{&lt; notice type="warning" &gt;}}
Currently, the regex pattern for detecting aliases does not discern if the alias is used within a comment.
In fact, none of the regex can discern if the code type is used within a comment.</p><p>Again, perhaps someone with greater regex-foo or a better idea on how to filter out false positives can comment below.
{{&lt; /notice &gt;}}</p><h3 id="count-of-structure-types" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>Count of Structure Types</h3><p>We can use <code>Group-Object</code> to get a count of the code structure types.
Throw in <code>Sort-Object</code> and <code>Select-Object</code></p><pre class="with-bar"><code class="powershell -codedoc-code-snippet code-0-0-12" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span></span></span><div class="line-0-0-16  -codedoc-code-line" data-content="D:\> $CodeInfo | Group-Object -Property Type | Sort-Object Count -Descending |" id="code23-l1"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">1<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>D:\&gt; <span class="token variable">$CodeInfo</span> <span class="token punctuation">|</span> <span class="token function">Group-Object</span> <span class="token operator">-</span>Property <span class="token function">Type</span> <span class="token punctuation">|</span> <span class="token function">Sort-Object</span> Count <span class="token operator">-</span>Descending <span class="token punctuation">|</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="    Select-Object Count,@{l='CodeType';e={$_.Name}}" id="code23-l2"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">2<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span class="token function">Select-Object</span> Count<span class="token punctuation">,</span>@<span class="token punctuation">{</span>l=<span class="token string">'CodeType'</span><span class="token punctuation">;</span>e=<span class="token punctuation">{</span><span class="token variable">$_</span><span class="token punctuation">.</span>Name<span class="token punctuation">}</span><span class="token punctuation">}</span></div><br></code></pre><pre class="with-bar"><code class="powershell -codedoc-code-snippet code-0-0-12" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span></span></span><div class="line-0-0-16  -codedoc-code-line" data-content="Count CodeType" id="code24-l1"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">1<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>Count CodeType</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="----- --------" id="code24-l2"><span class="lineCounter-0-0-13 -codedoc-line-counter">2<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span> <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content=" 1079 VariableDeclaration" id="code24-l3"><span class="lineCounter-0-0-13 -codedoc-line-counter">3<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span> 1079 VariableDeclaration</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="  732 PSVerbNoun" id="code24-l4"><span class="lineCounter-0-0-13 -codedoc-line-counter">4<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>  732 PSVerbNoun</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="  166 DotNet" id="code24-l5"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">5<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>  166 DotNet</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="  145 ParameterAttribute" id="code24-l6"><span class="lineCounter-0-0-13 -codedoc-line-counter">6<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>  145 ParameterAttribute</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="  100 ParamDeclaration" id="code24-l7"><span class="lineCounter-0-0-13 -codedoc-line-counter">7<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>  100 ParamDeclaration</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="   99 LoopStatement" id="code24-l8"><span class="lineCounter-0-0-13 -codedoc-line-counter">8<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>   99 LoopStatement</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="   93 TryCatchFinally" id="code24-l9"><span class="lineCounter-0-0-13 -codedoc-line-counter">9<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>   93 TryCatchFinally</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="   89 FOperator" id="code24-l10"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">10<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>   89 FOperator</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="   89 FunctionDefinition" id="code24-l11"><span class="lineCounter-0-0-13 -codedoc-line-counter">11<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>   89 FunctionDefinition</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="   88 CmdletBindingAttribute" id="code24-l12"><span class="lineCounter-0-0-13 -codedoc-line-counter">12<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>   88 CmdletBindingAttribute</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="   17 SwitchStatement" id="code24-l13"><span class="lineCounter-0-0-13 -codedoc-line-counter">13<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>   17 SwitchStatement</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="   10 Alias" id="code24-l14"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">14<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>   10 Alias</div><br></code></pre><p><em>Looks like I need to go back and remove some Aliases.</em></p><h3 id="count-of-verb-noun-commands-and-aliases" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>Count of Verb-Noun Commands and Aliases</h3><pre class="with-bar"><code class="powershell -codedoc-code-snippet code-0-0-12" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span></span></span><div class="line-0-0-16  -codedoc-code-line" data-content="D:\> $CodeInfo | Where-Object {$_.Type -match 'PSVerbNoun|Alias'} |" id="code25-l1"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">1<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>D:\&gt; <span class="token variable">$CodeInfo</span> <span class="token punctuation">|</span> <span class="token function">Where-Object</span> <span class="token punctuation">{</span><span class="token variable">$_</span><span class="token punctuation">.</span><span class="token function">Type</span> <span class="token operator">-match</span> <span class="token string">'PSVerbNoun|Alias'</span><span class="token punctuation">}</span> <span class="token punctuation">|</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="    Group-Object -Property Type | Sort-Object Count -Descending |" id="code25-l2"><span class="lineCounter-0-0-13 -codedoc-line-counter">2<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span class="token function">Group-Object</span> <span class="token operator">-</span>Property <span class="token function">Type</span> <span class="token punctuation">|</span> <span class="token function">Sort-Object</span> Count <span class="token operator">-</span>Descending <span class="token punctuation">|</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="    Select-Object Count,@{l='CodeType';e={$_.Name}}" id="code25-l3"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">3<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span class="token function">Select-Object</span> Count<span class="token punctuation">,</span>@<span class="token punctuation">{</span>l=<span class="token string">'CodeType'</span><span class="token punctuation">;</span>e=<span class="token punctuation">{</span><span class="token variable">$_</span><span class="token punctuation">.</span>Name<span class="token punctuation">}</span><span class="token punctuation">}</span></div><br></code></pre><pre class="with-bar"><code class="powershell -codedoc-code-snippet code-0-0-12" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span></span></span><div class="line-0-0-16  -codedoc-code-line" data-content="Count CodeType" id="code26-l1"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">1<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>Count CodeType</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="----- --------" id="code26-l2"><span class="lineCounter-0-0-13 -codedoc-line-counter">2<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span> <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="  732 PSVerbNoun" id="code26-l3"><span class="lineCounter-0-0-13 -codedoc-line-counter">3<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>  732 PSVerbNoun</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="   10 Alias" id="code26-l4"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">4<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>   10 Alias</div><br></code></pre><p>This shows that I have 732 PowerShell commands in the scripts within this folder.
These may include commands in comments.</p><h3 id="advanced-extra-credit-challenge" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>Advanced Extra Credit Challenge</h3><p>From the list above, we can also see that I have used 10 aliases.
Let's check those out and how I pulled those out of the code.</p><pre class=""><code class="powershell -codedoc-code-snippet code-0-0-12" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span></span></span><div class="line-0-0-16  -codedoc-code-line" data-content="D:\> $CodeInfo | Where-Object {$_.Type -match 'Alias'} | Format-Table -AutoSize" id="code27-l1"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">1<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>D:\&gt; <span class="token variable">$CodeInfo</span> <span class="token punctuation">|</span> <span class="token function">Where-Object</span> <span class="token punctuation">{</span><span class="token variable">$_</span><span class="token punctuation">.</span><span class="token function">Type</span> <span class="token operator">-match</span> <span class="token string">'Alias'</span><span class="token punctuation">}</span> <span class="token punctuation">|</span> <span class="token function">Format-Table</span> <span class="token operator">-</span>AutoSize</div><br></code></pre><pre class="with-bar"><code class="powershell -codedoc-code-snippet code-0-0-12" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span></span></span><div class="line-0-0-16  -codedoc-code-line" data-content="FileName                   FileFullName                                                       Line Index Type  AliasName Command" id="code28-l1"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">1<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>FileName                   FileFullName                                                       Line Index <span class="token function">Type</span>  AliasName Command</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="--------                   ------------                                                       ---- ----- ----  --------- -------" id="code28-l2"><span class="lineCounter-0-0-13 -codedoc-line-counter">2<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>                   <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>                                                       <span class="token operator">--</span><span class="token operator">--</span> <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span> <span class="token operator">--</span><span class="token operator">--</span>  <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span> <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="New-EventFilterXml.ps1     D:\GitHub\Workshop\PowerShell\Functions\New-EventFilterXml.ps1      141    54 Alias select    Select-Object" id="code28-l3"><span class="lineCounter-0-0-13 -codedoc-line-counter">3<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token function">New-EventFilterXml</span><span class="token punctuation">.</span>ps1     D:\GitHub\Workshop\PowerShell\Functions\<span class="token function">New-EventFilterXml</span><span class="token punctuation">.</span>ps1      141    54 Alias <span class="token function">select</span>    <span class="token function">Select-Object</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="New-EventFilterXml.ps1     D:\GitHub\Workshop\PowerShell\Functions\New-EventFilterXml.ps1      149    54 Alias select    Select-Object" id="code28-l4"><span class="lineCounter-0-0-13 -codedoc-line-counter">4<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token function">New-EventFilterXml</span><span class="token punctuation">.</span>ps1     D:\GitHub\Workshop\PowerShell\Functions\<span class="token function">New-EventFilterXml</span><span class="token punctuation">.</span>ps1      149    54 Alias <span class="token function">select</span>    <span class="token function">Select-Object</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="Write-PlasterParameter.ps1 D:\GitHub\Workshop\PowerShell\Functions\Write-PlasterParameter.ps1  109   117 Alias select    Select-Object" id="code28-l5"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">5<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token function">Write-PlasterParameter</span><span class="token punctuation">.</span>ps1 D:\GitHub\Workshop\PowerShell\Functions\<span class="token function">Write-PlasterParameter</span><span class="token punctuation">.</span>ps1  109   117 Alias <span class="token function">select</span>    <span class="token function">Select-Object</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="build.settings.ps1         D:\GitHub\Workshop\PowerShell\PlasterTemplate\build.settings.ps1    101     6 Alias Select    Select-Object" id="code28-l6"><span class="lineCounter-0-0-13 -codedoc-line-counter">6<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>build<span class="token punctuation">.</span>settings<span class="token punctuation">.</span>ps1         D:\GitHub\Workshop\PowerShell\PlasterTemplate\build<span class="token punctuation">.</span>settings<span class="token punctuation">.</span>ps1    101     6 Alias <span class="token function">Select</span>    <span class="token function">Select-Object</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="PingViewer.ps1             D:\GitHub\Workshop\PowerShell\Scripts\PingViewer.ps1                420   341 Alias Select    Select-Object" id="code28-l7"><span class="lineCounter-0-0-13 -codedoc-line-counter">7<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>PingViewer<span class="token punctuation">.</span>ps1             D:\GitHub\Workshop\PowerShell\Scripts\PingViewer<span class="token punctuation">.</span>ps1                420   341 Alias <span class="token function">Select</span>    <span class="token function">Select-Object</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="temp.ps1                   D:\GitHub\Workshop\PowerShell\Scripts\temp.ps1                       20     8 Alias ForEach   Foreach-Object" id="code28-l8"><span class="lineCounter-0-0-13 -codedoc-line-counter">8<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>temp<span class="token punctuation">.</span>ps1                   D:\GitHub\Workshop\PowerShell\Scripts\temp<span class="token punctuation">.</span>ps1                       20     8 Alias <span class="token keyword">ForEach</span>   <span class="token function">Foreach-Object</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="temp.ps1                   D:\GitHub\Workshop\PowerShell\Scripts\temp.ps1                       66    17 Alias Select    Select-Object" id="code28-l9"><span class="lineCounter-0-0-13 -codedoc-line-counter">9<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>temp<span class="token punctuation">.</span>ps1                   D:\GitHub\Workshop\PowerShell\Scripts\temp<span class="token punctuation">.</span>ps1                       66    17 Alias <span class="token function">Select</span>    <span class="token function">Select-Object</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="temp.ps1                   D:\GitHub\Workshop\PowerShell\Scripts\temp.ps1                       86    18 Alias ForEach   Foreach-Object" id="code28-l10"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">10<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>temp<span class="token punctuation">.</span>ps1                   D:\GitHub\Workshop\PowerShell\Scripts\temp<span class="token punctuation">.</span>ps1                       86    18 Alias <span class="token keyword">ForEach</span>   <span class="token function">Foreach-Object</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="temp.ps1                   D:\GitHub\Workshop\PowerShell\Scripts\temp.ps1                       93    28 Alias Select    Select-Object" id="code28-l11"><span class="lineCounter-0-0-13 -codedoc-line-counter">11<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>temp<span class="token punctuation">.</span>ps1                   D:\GitHub\Workshop\PowerShell\Scripts\temp<span class="token punctuation">.</span>ps1                       93    28 Alias <span class="token function">Select</span>    <span class="token function">Select-Object</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="temp.ps1                   D:\GitHub\Workshop\PowerShell\Scripts\temp.ps1                       94    25 Alias Select    Select-Object" id="code28-l12"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">12<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>temp<span class="token punctuation">.</span>ps1                   D:\GitHub\Workshop\PowerShell\Scripts\temp<span class="token punctuation">.</span>ps1                       94    25 Alias <span class="token function">Select</span>    <span class="token function">Select-Object</span></div><br></code></pre><p>In the <em>begin</em> block of <code>Get-PSCodeStructure</code>, you will find <code>$Aliases = Get-Alias</code>.
After the regex patterns have gathered any matches, I split the line and start iterating through each 'word'.</p><p>Since <code>foreach</code> and <code>select</code> are also part of Verb-Noun commands, I first attempt to match on them specifically.
Next, I attempt to match the 'word' against all the names in <code>$Aliases</code> and if the 'word' contains only letter.</p><h3 id="advanced-extra-challenge" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>Advanced Extra Challenge</h3><p>As an extra challenge, we were asked to include a property that is an array of the filenames where the command exists.
Lucky for us, the <code>FileName</code> is tucked away in the Group property.</p><pre class="with-bar"><code class="powershell -codedoc-code-snippet code-0-0-12" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span></span></span><div class="line-0-0-16  -codedoc-code-line" data-content="D:\> $CodeInfo | Where-Object {$_.Type -match 'PSVerbNoun|Alias'} |" id="code29-l1"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">1<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>D:\&gt; <span class="token variable">$CodeInfo</span> <span class="token punctuation">|</span> <span class="token function">Where-Object</span> <span class="token punctuation">{</span><span class="token variable">$_</span><span class="token punctuation">.</span><span class="token function">Type</span> <span class="token operator">-match</span> <span class="token string">'PSVerbNoun|Alias'</span><span class="token punctuation">}</span> <span class="token punctuation">|</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="    Group-Object -Property Type | Sort-Object Count -Descending |" id="code29-l2"><span class="lineCounter-0-0-13 -codedoc-line-counter">2<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span class="token function">Group-Object</span> <span class="token operator">-</span>Property <span class="token function">Type</span> <span class="token punctuation">|</span> <span class="token function">Sort-Object</span> Count <span class="token operator">-</span>Descending <span class="token punctuation">|</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="    Select-Object Count,@{l='CodeType';e={$_.Name}},@{l='FileName';e={$_.Group.FileName}}" id="code29-l3"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">3<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span class="token function">Select-Object</span> Count<span class="token punctuation">,</span>@<span class="token punctuation">{</span>l=<span class="token string">'CodeType'</span><span class="token punctuation">;</span>e=<span class="token punctuation">{</span><span class="token variable">$_</span><span class="token punctuation">.</span>Name<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span>@<span class="token punctuation">{</span>l=<span class="token string">'FileName'</span><span class="token punctuation">;</span>e=<span class="token punctuation">{</span><span class="token variable">$_</span><span class="token punctuation">.</span><span class="token function">Group</span><span class="token punctuation">.</span>FileName<span class="token punctuation">}</span><span class="token punctuation">}</span></div><br></code></pre><pre class="with-bar"><code class="powershell -codedoc-code-snippet code-0-0-12" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span></span></span><div class="line-0-0-16  -codedoc-code-line" data-content="Count CodeType   FileName" id="code30-l1"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">1<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>Count CodeType   FileName</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="----- --------   --------" id="code30-l2"><span class="lineCounter-0-0-13 -codedoc-line-counter">2<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span> <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>   <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="  732 PSVerbNoun {Add-ModuleUnitTests.ps1, Add-ModuleUnitTests.ps1, Add-ModuleUnitTests.ps1, Add-ModuleUnitTests.ps1…}" id="code30-l3"><span class="lineCounter-0-0-13 -codedoc-line-counter">3<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>  732 PSVerbNoun <span class="token punctuation">{</span><span class="token function">Add-ModuleUnitTests</span><span class="token punctuation">.</span>ps1<span class="token punctuation">,</span> <span class="token function">Add-ModuleUnitTests</span><span class="token punctuation">.</span>ps1<span class="token punctuation">,</span> <span class="token function">Add-ModuleUnitTests</span><span class="token punctuation">.</span>ps1<span class="token punctuation">,</span> <span class="token function">Add-ModuleUnitTests</span><span class="token punctuation">.</span>ps1…<span class="token punctuation">}</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="   10 Alias      {New-EventFilterXml.ps1, New-EventFilterXml.ps1, Write-PlasterParameter.ps1, build.settings.ps1…}" id="code30-l4"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">4<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>   10 Alias      <span class="token punctuation">{</span><span class="token function">New-EventFilterXml</span><span class="token punctuation">.</span>ps1<span class="token punctuation">,</span> <span class="token function">New-EventFilterXml</span><span class="token punctuation">.</span>ps1<span class="token punctuation">,</span> <span class="token function">Write-PlasterParameter</span><span class="token punctuation">.</span>ps1<span class="token punctuation">,</span> build<span class="token punctuation">.</span>settings<span class="token punctuation">.</span>ps1…<span class="token punctuation">}</span></div><br></code></pre><h3 id="solution" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>Solution</h3><p>Here are the two functions I wrote to solve this challenge.</p><p>{{&lt; gist id="bdb519bf474739851ca1e7d2d3faeee6" file="1-Measure-PSCodeLine.ps1" &gt;}}
{{&lt; gist id="bdb519bf474739851ca1e7d2d3faeee6" file="2-Get-PSCodeStructure.ps1" &gt;}}</p><h3 id="performance" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>Performance</h3><p>One consideration in processing a numerous files is performance.</p><p>I tested using PowerShell 7's <code>Foreach-Object -Parallel</code> and a standard <code>foreach</code> statement on a folder path containing
157 files.</p><p>Here are the results.</p><table><thead><th style="text-align: center">Iteration</th><th style="text-align: center">Foreach-Object -Parallel</th><th style="text-align: center">foreach</th></thead><tbody><tr><td style="text-align: center">Run 1</td><td style="text-align: center">0h 0m 24.223s</td><td style="text-align: center">0h 0m 25.638s</td></tr><tr><td style="text-align: center">Run 2</td><td style="text-align: center">0h 0m 25.4s</td><td style="text-align: center">0h 0m 19.659s</td></tr><tr><td style="text-align: center">Run 3</td><td style="text-align: center">0h 0m 29.780s</td><td style="text-align: center">0h 0m 27.159s</td></tr></tbody></table><p>There's not that much difference between the elapsed time.</p><p>However, I did notice that <code>Foreach-Object -Parallel</code> consumed more processor and memory, using up to 450MB and up to 80% CPU.</p><p>The <code>foreach</code> statement only consumed up to 150MB and up to 25%.</p><p>Based on these findings, I chose to use the <code>foreach</code> statement only.</p><h3 id="other-notes" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>Other Notes</h3><p>For the Advanced challenge, we need to pass a path.
I wanted to provide the user a way to supply a single file or a path.
If provided a path, any <em>ps1</em> or <em>psm1</em> files would be selected.
I also provided a <code>-Recurse</code> switch that allows the user to select all multiple downstream paths.</p><p>With this criteria in mind, here's how I did that.</p><pre class="with-bar"><code class="powershell -codedoc-code-snippet code-0-0-12" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span></span></span><div class="line-0-0-16  -codedoc-code-line" data-content="$PathType = (Get-Item -Path $Path).GetType().Name" id="code31-l1"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">1<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token variable">$PathType</span> = <span class="token punctuation">(</span><span class="token function">Get-Item</span> <span class="token operator">-</span>Path <span class="token variable">$Path</span><span class="token punctuation">)</span><span class="token punctuation">.</span>GetType<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Name</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="if ($PathType -eq 'DirectoryInfo') {" id="code31-l2"><span class="lineCounter-0-0-13 -codedoc-line-counter">2<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$PathType</span> <span class="token operator">-eq</span> <span class="token string">'DirectoryInfo'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="    if ($PSBoundParameters.ContainsKey('Recurse')) {" id="code31-l3"><span class="lineCounter-0-0-13 -codedoc-line-counter">3<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$PSBoundParameters</span><span class="token punctuation">.</span>ContainsKey<span class="token punctuation">(</span><span class="token string">'Recurse'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="        $Files = Get-ChildItem -Path $Path -Recurse -File |" id="code31-l4"><span class="lineCounter-0-0-13 -codedoc-line-counter">4<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>        <span class="token variable">$Files</span> = <span class="token function">Get-ChildItem</span> <span class="token operator">-</span>Path <span class="token variable">$Path</span> <span class="token operator">-</span>Recurse <span class="token operator">-</span>File <span class="token punctuation">|</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="            Where-Object { $_.Extension -in $PSCodeExtensions }" id="code31-l5"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">5<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>            <span class="token function">Where-Object</span> <span class="token punctuation">{</span> <span class="token variable">$_</span><span class="token punctuation">.</span>Extension <span class="token operator">-in</span> <span class="token variable">$PSCodeExtensions</span> <span class="token punctuation">}</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="    } else {" id="code31-l6"><span class="lineCounter-0-0-13 -codedoc-line-counter">6<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="        $Files = Get-ChildItem -Path $Path -File |" id="code31-l7"><span class="lineCounter-0-0-13 -codedoc-line-counter">7<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>        <span class="token variable">$Files</span> = <span class="token function">Get-ChildItem</span> <span class="token operator">-</span>Path <span class="token variable">$Path</span> <span class="token operator">-</span>File <span class="token punctuation">|</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="            Where-Object { $_.Extension -in $PSCodeExtensions }" id="code31-l8"><span class="lineCounter-0-0-13 -codedoc-line-counter">8<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>            <span class="token function">Where-Object</span> <span class="token punctuation">{</span> <span class="token variable">$_</span><span class="token punctuation">.</span>Extension <span class="token operator">-in</span> <span class="token variable">$PSCodeExtensions</span> <span class="token punctuation">}</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="    }" id="code31-l9"><span class="lineCounter-0-0-13 -codedoc-line-counter">9<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span class="token punctuation">}</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="} elseif ($PathType -eq 'FileInfo') {" id="code31-l10"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">10<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token punctuation">}</span> <span class="token keyword">elseif</span> <span class="token punctuation">(</span><span class="token variable">$PathType</span> <span class="token operator">-eq</span> <span class="token string">'FileInfo'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="    $Files = Get-ChildItem -Path $Path" id="code31-l11"><span class="lineCounter-0-0-13 -codedoc-line-counter">11<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span class="token variable">$Files</span> = <span class="token function">Get-ChildItem</span> <span class="token operator">-</span>Path <span class="token variable">$Path</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="}" id="code31-l12"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">12<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token punctuation">}</span></div><br></code></pre><h2 id="additional-information" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>Additional Information</h2><p>To learn more about regex, here are a few resources that go much deeper into the topic than this article.</p><ul><li><a href="https://powershellexplained.com/2017-07-31-Powershell-regex-regular-expression/">PowerShell: The many ways to use regex</a> on {{&lt; influencer "kevmar" &gt;}}</li><li><a href="http://duffney.io/APracticalGuideforUsingRegexinPowerShell">A Practical Guide for Using Regex in PowerShell</a> on <a href="https://www.linkedin.com/in/joshduffney/">Josh Duffney's</a> blog</li><li><a href="https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_regular_expressions?view=powershell-7">About Regular Expressions</a></li><li><a href="https://docs.microsoft.com/en-us/dotnet/standard/base-types/regular-expression-language-quick-reference">.Net Quick Reference</a> on Regular Expression Language</li></ul><p>{{&lt; notice type="warning" &gt;}}
I'm not a regex guru.
{{&lt; /notice &gt;}}</p><p>For several years now, I have crafted my regex using the following online validator tools.
There are others, these are just the ones I find familiar and easy to use.</p><ul><li><a href="https://regex101.com/">regex101.com</a></li><li><a href="https://regexr.com/">regexr.com</a></li></ul><h2 id="summary" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>Summary</h2><p>{{&lt; notice type="important" &gt;}}
Thank you for sticking with the article!
 I didn't realize that it was going to grow this large, to a 15+ minute read time.
{{&lt; /notice &gt;}}</p><p>When I began working on this Iron Scripter challenge, I was only considering writing a short article on my solution.
I quickly realized, however, that the heart of the challenge involves regular expressions.
And I suspect that many PowerShell scripters would only have a little experience or knowledge on this complex subject.</p><p>My hopes for this article are twofold:</p><ol><li>You have gained a better understanding of regex and how you can use and write regex patterns in PowerShell.</li><li>You have gained an interest in participating in the Iron Scripter challenges, or have had your interest bolstered.
You can learn a great deal while solving the challenges.</li></ol><p>If you have suggestions for better regex patterns or a better way to handle false positives for Verb-Noun and aliases,
please let me know in the comments below.</p><p>If you have any general questions on Regex or PowerShell, feel free to leave them in the comments or ask me on {{&lt; influencer thedavecarroll social-only &gt;}}.</p><div class="contentnav-0-0-11" data-no-search=""><a href="#introduction" class="h2" data-content-highlight="introduction">Introduction</a><a href="#regex-and-powershell" class="h2" data-content-highlight="regex-and-powershell">Regex and PowerShell</a><a href="#what-is-regex" class="h3" data-content-highlight="what-is-regex">What is Regex</a><a href="#how-powershell-uses-regex" class="h3" data-content-highlight="how-powershell-uses-regex">How PowerShell Uses Regex</a><a href="#match-text" class="h4" data-content-highlight="match-text">Match Text</a><a href="#regex-character-classes" class="h4" data-content-highlight="regex-character-classes">Regex Character Classes</a><a href="#regex-quantifiers" class="h4" data-content-highlight="regex-quantifiers">Regex Quantifiers</a><a href="#regex-anchors-and-alternation" class="h4" data-content-highlight="regex-anchors-and-alternation">Regex Anchors and Alternation</a><a href="#regex-grouping" class="h4" data-content-highlight="regex-grouping">Regex Grouping</a><a href="#intermediate-challenge" class="h2" data-content-highlight="intermediate-challenge">Intermediate Challenge</a><a href="#sample-output" class="h3" data-content-highlight="sample-output">Sample Output</a><a href="#advanced-challenge" class="h2" data-content-highlight="advanced-challenge">Advanced Challenge</a><a href="#powershell-code-structure-regex" class="h3" data-content-highlight="powershell-code-structure-regex">PowerShell Code Structure Regex</a><a href="#powershell-regex-matches" class="h4" data-content-highlight="powershell-regex-matches">PowerShell Regex Matches</a><a href="#handling-false-positives" class="h4" data-content-highlight="handling-false-positives">Handling False Positives</a><a href="#capture-code-structure-into-variable" class="h3" data-content-highlight="capture-code-structure-into-variable">Capture Code Structure into Variable</a><a href="#sample-object" class="h3" data-content-highlight="sample-object">Sample Object</a><a href="#count-of-structure-types" class="h3" data-content-highlight="count-of-structure-types">Count of Structure Types</a><a href="#count-of-verb-noun-commands-and-aliases" class="h3" data-content-highlight="count-of-verb-noun-commands-and-aliases">Count of Verb-Noun Commands and Aliases</a><a href="#advanced-extra-credit-challenge" class="h3" data-content-highlight="advanced-extra-credit-challenge">Advanced Extra Credit Challenge</a><a href="#advanced-extra-challenge" class="h3" data-content-highlight="advanced-extra-challenge">Advanced Extra Challenge</a><a href="#solution" class="h3" data-content-highlight="solution">Solution</a><a href="#performance" class="h3" data-content-highlight="performance">Performance</a><a href="#other-notes" class="h3" data-content-highlight="other-notes">Other Notes</a><a href="#additional-information" class="h2" data-content-highlight="additional-information">Additional Information</a><a href="#summary" class="h2" data-content-highlight="summary">Summary</a></div></div><div id="-codedoc-toc" class="toc-0-0-8"><div class="content-0-0-9"><div class="heading-0-0-3">Index</div><p><a href="/codedoc/">Home</a>
<a href="/codedoc/README">Index</a>
<a href="/codedoc/docs/Kostwein">Kostwein</a></p><div class="collapse-0-0-4 "><script id="vkDZSUmGJT">(function(){function load(){if (window.__sdh_transport){window.__sdh_transport("vkDZSUmGJT", "yAdNJkOJGbj52dvfV+HpdQ==", {});} }; if (document.readyState == 'complete') load(); else window.addEventListener('load', load); window.setImmediate = window.setImmediate || function(f){setTimeout(f, 0)}; })()</script><div class="label" onclick="this.parentElement.classList.toggle('open')"><span class="text">PSModulesHelp</span><span class="icon-font closed">chevron_right</span></div><div class="content"><p><a href="/codedoc/docs/PSModulesHelp/ModuleDoku">PS Modules Help</a></p><hr></div></div><div class="collapse-0-0-4 "><script id="hePUsSXdKL">(function(){function load(){if (window.__sdh_transport){window.__sdh_transport("hePUsSXdKL", "yAdNJkOJGbj52dvfV+HpdQ==", {});} }; if (document.readyState == 'complete') load(); else window.addEventListener('load', load); window.setImmediate = window.setImmediate || function(f){setTimeout(f, 0)}; })()</script><div class="label" onclick="this.parentElement.classList.toggle('open')"><span class="text">KnowledgeBase</span><span class="icon-font closed">chevron_right</span></div><div class="content"><blockquote><p><a href="/codedoc/docs/Knowledge/PowerShell/Index">PowerShell</a></p></blockquote></div></div><div class="collapse-0-0-4 "><script id="FXujwyOuLC">(function(){function load(){if (window.__sdh_transport){window.__sdh_transport("FXujwyOuLC", "yAdNJkOJGbj52dvfV+HpdQ==", {});} }; if (document.readyState == 'complete') load(); else window.addEventListener('load', load); window.setImmediate = window.setImmediate || function(f){setTimeout(f, 0)}; })()</script><div class="label" onclick="this.parentElement.classList.toggle('open')"><span class="text">Links</span><span class="icon-font closed">chevron_right</span></div><div class="content"><blockquote><p><a href="/codedoc/docs/Links/LinksWiki">Index</a></p></blockquote></div></div><div class="collapse-0-0-4 "><script id="idKnBMkCIw">(function(){function load(){if (window.__sdh_transport){window.__sdh_transport("idKnBMkCIw", "yAdNJkOJGbj52dvfV+HpdQ==", {});} }; if (document.readyState == 'complete') load(); else window.addEventListener('load', load); window.setImmediate = window.setImmediate || function(f){setTimeout(f, 0)}; })()</script><div class="label" onclick="this.parentElement.classList.toggle('open')"><span class="text">Veeam</span><span class="icon-font closed">chevron_right</span></div><div class="content"><blockquote><p><a href="/codedoc/docs/Knowledge/Veeam/Best%20Practices/index">Best Practices</a></p></blockquote></div></div><p><a href="/codedoc/docs/cheat-sheet">Markdown Cheat Sheet</a>
<a href="/codedoc/docs/code-features">Code Features</a></p><p><br><br></p><p>To add links to your other documents, simply
modify contents of <code>docs/md/_toc.md</code>.</p></div><div class="search-0-0-10"><script id="NLqNgVZH_U">(function(){function load(){if (window.__sdh_transport){window.__sdh_transport("NLqNgVZH_U", "EKtVWhWp+AfK3O64A4+bOg==", {"repo":"codedoc","user":"In-Pro-Org","root":"docs/md","pick":"\\.md$","drop":"(^_)|(\\/_)"});} }; if (document.readyState == 'complete') load(); else window.addEventListener('load', load); window.setImmediate = window.setImmediate || function(f){setTimeout(f, 0)}; })()</script></div></div><div class="footer-0-0-7"><div class="left"><script id="OKJGUtlKjx">(function(){function load(){if (window.__sdh_transport){window.__sdh_transport("OKJGUtlKjx", "wCsMx1XMyC4jNi3FxvjU4g==", {});} }; if (document.readyState == 'complete') load(); else window.addEventListener('load', load); window.setImmediate = window.setImmediate || function(f){setTimeout(f, 0)}; })()</script></div><div class="main"><div class="inside"><a href="https://github.com/In-Pro-Org/codedoc/" target="_blank">GitHub</a></div></div><div class="right"><script id="W_xZsLtDMl">(function(){function load(){if (window.__sdh_transport){window.__sdh_transport("W_xZsLtDMl", "6W59GcSTLBVXRr/Nl/rTkw==", {});} }; if (document.readyState == 'complete') load(); else window.addEventListener('load', load); window.setImmediate = window.setImmediate || function(f){setTimeout(f, 0)}; })()</script></div></div><script id="nPzTQkbwve">(function(){function load(){if (window.__sdh_transport){window.__sdh_transport("nPzTQkbwve", "zKXJ5zf13oJGCwAAI3JIIA==", {"namespace":"/codedoc"});} }; if (document.readyState == 'complete') load(); else window.addEventListener('load', load); window.setImmediate = window.setImmediate || function(f){setTimeout(f, 0)}; })()</script></body></html>