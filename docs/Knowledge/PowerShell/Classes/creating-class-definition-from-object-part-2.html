<!DOCTYPE html><html><head><title>Codedoc</title><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"><meta name="robots" content="index,follow"><meta name="theme-color" content="#212121"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><link rel="shortcut icon" href="/codedoc/docs/images/KostweinLogo.ico"><link href="https://fonts.googleapis.com/css?family=Roboto:300,400&amp;display=swap" rel="stylesheet"><link href="https://fonts.googleapis.com/css?family=Source+Code+Pro:300,400&amp;display=swap" rel="stylesheet"><link href="https://fonts.googleapis.com/icon?family=Material+Icons%7CMaterial+Icons+Outlined&amp;display=swap" rel="stylesheet"><style>
      body, input, button {
        font-family: 'Roboto', sans-serif;
      }

      code, .hljs {
        font-family: 'Source Code Pro', 'Courier New', Courier, monospace;
      }

      .icon-font {
        font-family: 'Material Icons';
        font-weight: normal;
        font-style: normal;
        font-size: 24px;  /* Preferred icon size */
        display: inline-block;
        line-height: 1;
        text-transform: none;
        letter-spacing: normal;
        word-wrap: normal;
        white-space: nowrap;
        direction: ltr;
      
        /* Support for all WebKit browsers. */
        -webkit-font-smoothing: antialiased;
        /* Support for Safari and Chrome. */
        text-rendering: optimizeLegibility;
      
        /* Support for Firefox. */
        -moz-osx-font-smoothing: grayscale;
      
        /* Support for IE. */
        font-feature-settings: 'liga';
      }

      .icon-font.outline {
        font-family: 'Material Icons Outlined';
      }
    </style><link href="/codedoc/docs/assets/codedoc-styles.css" rel="stylesheet"><script async="" defer="" src="/codedoc/docs/assets/codedoc-bundle.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css" integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq" crossorigin="anonymous"></head><body data-path="docs\Knowledge\PowerShell\Classes\creating-class-definition-from-object-part-2.md"><div class="header-0-0-6"><script async="" defer="" src="https://buttons.github.io/buttons.js"></script><a class="github-button" data-color-scheme="no-preference: light; light: light; dark: dark;" data-icon="false" data-show-count="true" data-size="false" href="https://github.com/In-Pro-Org/codedoc/">Star</a><br><br><a class="watermark-0-0-5" href="https://github.com/CONNECT-platform/codedoc" target="_blank">Created With<svg viewBox="0 0 536 296" version="1.1" xmlns="http://www.w3.org/2000/svg"><g id="codedoc" transform="translate(-244.000000, -364.000000)" fill-rule="nonzero"><path d="M580,532 C615.346224,532 644,560.653776 644,596 C644,631.346224 615.346224,660 580,660 C544.653776,660 516,631.346224 516,596 C516,560.653776 544.653776,532 580,532 Z M716,532 C751.346224,532 780,560.653776 780,596 C780,631.346224 751.346224,660 716,660 L692,660 C687.581722,660 684,656.418278 684,652 C684,647.581722 687.581722,644 692,644 L716,644 C742.509668,644 764,622.509668 764,596 C764,569.490332 742.509668,548 716,548 L692,548 C687.581722,548 684,544.418278 684,540 C684,535.581722 687.581722,532 692,532 L716,532 Z M468,532 C472.418278,532 476,535.581722 476,540 L476,652 C476,656.418278 472.418278,660 468,660 L444,660 C408.653776,660 380,631.346224 380,596 C380,560.653776 408.653776,532 444,532 L468,532 Z M332,532 C336.418278,532 340,535.581722 340,540 L340,652 C340,656.418278 336.418278,660 332,660 L252,660 C247.581722,660 244,656.418278 244,652 L244,540 C244,535.581722 247.581722,532 252,532 L332,532 Z M580,548 C553.490332,548 532,569.490332 532,596 C532,622.509668 553.490332,644 580,644 C606.509668,644 628,622.509668 628,596 C628,569.490332 606.509668,548 580,548 Z M461,548 L444,548 C417.490332,548 396,569.490332 396,596 C396,622.509668 417.490332,644 444,644 L461,644 L461,548 Z M444,364 C479.346224,364 508,392.653776 508,428 C508,463.346224 479.346224,492 444,492 C408.653776,492 380,463.346224 380,428 C380,392.653776 408.653776,364 444,364 Z M332,364 C336.418278,364 340,367.581722 340,372 C340,376.418278 336.418278,380 332,380 L308,380 C281.490332,380 260,401.490332 260,428 C260,454.509668 281.490332,476 308,476 L332,476 C336.418278,476 340,479.581722 340,484 C340,488.418278 336.418278,492 332,492 L308,492 C272.653776,492 244,463.346224 244,428 C244,392.653776 272.653776,364 308,364 L332,364 Z M580,364 C615.346224,364 644,392.653776 644,428 C644,463.346224 615.346224,492 580,492 L556,492 C551.581722,492 548,488.418278 548,484 L548,372 C548,367.581722 551.581722,364 556,364 L580,364 Z M772,364 C776.418278,364 780,367.581722 780,372 C780,376.418278 776.418278,380 772,380 L700,380 L700,420 L772,420 C776.418278,420 780,423.581722 780,428 C780,432.418278 776.418278,436 772,436 L700,436 L700,476 L772,476 C776.418278,476 780,479.581722 780,484 C780,488.418278 776.418278,492 772,492 L692,492 C687.581722,492 684,488.418278 684,484 L684,372 C684,367.581722 687.581722,364 692,364 L772,364 Z M444,380 C417.490332,380 396,401.490332 396,428 C396,454.509668 417.490332,476 444,476 C470.509668,476 492,454.509668 492,428 C492,401.490332 470.509668,380 444,380 Z M580,380 L563,380 L563,476 L580,476 C606.509668,476 628,454.509668 628,428 C628,401.490332 606.509668,380 580,380 Z"></path></g></svg></a></div><div id="-codedoc-container" class="container"><hr><p>title: Creating a Class Definition from an Existing Object - Part 2
description: In this second part of the Iron Scripter challenge walk-through, we convert property and class names to PascalCase, detect property types, and hide properties.
image: /images/ironscripter/class-definition/Silicone_mold_resin_cast_figure.jpg
published: 2021-01-30
tags: ["powershell", "powershell concepts", "custom class", "psobject", "pscustomobject", "learn powershell", "iron scripter", "iron scripter challenge", "iron scripter walk-through"]
categories: ["PowerShell"]</p><hr><h2 id="a-powershell-conversion-challenge" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>A PowerShell Conversion Challenge</h2><p>A few days ago I published [Part 1]({{&lt; relref "powershell/creating-class-definition-from-object-part-1.md" &gt;}}) of my solution to the IronScripter <a href="https://ironscripter.us/a-powershell-conversion-challenge/">PowerShell Conversion Challenge</a>.
If you haven't already, please check out that article, as we will be picking up where it left off.</p><p>As a quick recap, my solution satisfied 7 out of 10 of the requirements set forth by the IronScripter Chairman,
though it only solved 1 of my 6 additional requirements.</p><p>Here are the remaining challenge requirements:</p><ul><li>Insert placeholder for methods</li><li>Let the user specify a method</li><li>Be VSCode aware and insert the new class automatically into the current file</li></ul><p>And here are my remaining requirements:</p><ul><li>Contained in a small module, as there will be a few helper functions.</li><li>Use an existing <code>PSCustomObject</code> with non-conventional property names.<ul><li>A private function would be used to enforce proper PascalCase casing and removal of punctuation (with maybe exception of period).</li><li>The constructor would need to be updated to include a method to do the same PascalCase casing. <em>(included originally in constructor requirements)</em></li></ul></li><li>Should be recursive.<ul><li>Any object that contains a property which is itself another complex object should generate a separate class definition.</li></ul></li><li>Allow user to specify which properties that will be hidden. <em>(slightly modified)</em></li><li>If not specified, detect the property type and include in definition.</li></ul><h2 id="the-path-to-a-solution" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>The Path to a Solution</h2><p>I said in the first article that I will take you through my thought process as I write the code.
You may have noticed in that article that I did not traverse the list in order.
I'm taking you through the steps that I feel is the best path without having to circle back around.</p><h3 id="pscustomobject" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>PSCustomObject</h3><p>My requirements included being able to take a <code>PSCustomObject</code> as input and generate the class definition with the most appropriate type names for properties.
Having a tool that can handle this will help me greatly in other projects.</p><p>Let's see what we have so far.</p><pre class="with-bar"><code class="powershell -codedoc-code-snippet code-0-0-12" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span></span></span><div class="line-0-0-16  -codedoc-code-line" data-content="$Person = [PSCustomObject]@{" id="code1-l1"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">1<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token variable">$Person</span> = <span class="token namespace">[PSCustomObject]</span>@<span class="token punctuation">{</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="  Name = 'Dave'" id="code1-l2"><span class="lineCounter-0-0-13 -codedoc-line-counter">2<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>  Name = <span class="token string">'Dave'</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="  IsCool = $true" id="code1-l3"><span class="lineCounter-0-0-13 -codedoc-line-counter">3<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>  IsCool = <span class="token boolean">$true</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="  Age = 50" id="code1-l4"><span class="lineCounter-0-0-13 -codedoc-line-counter">4<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>  Age = 50</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="  DOB = '8/11/1970'" id="code1-l5"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">5<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>  DOB = <span class="token string">'8/11/1970'</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="}" id="code1-l6"><span class="lineCounter-0-0-13 -codedoc-line-counter">6<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token punctuation">}</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="$Person | ConvertTo-ClassDefinition -ClassName Person" id="code1-l7"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">7<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token variable">$Person</span> <span class="token punctuation">|</span> <span class="token function">ConvertTo-ClassDefinition</span> <span class="token operator">-</span>ClassName Person</div><br></code></pre><pre class="with-bar"><code class="powershell -codedoc-code-snippet code-0-0-12" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span></span></span><div class="line-0-0-16  -codedoc-code-line" data-content="# class definition created by ConvertTo-ClassDefinition at 1/27/2021 9:03:46 PM for object type System.Management.Automation.PSCustomObject" id="code2-l1"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">1<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token comment"># class definition created by ConvertTo-ClassDefinition at 1/27/2021 9:03:46 PM for object type System.Management.Automation.PSCustomObject</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="" id="code2-l2"><span class="lineCounter-0-0-13 -codedoc-line-counter">2<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="class Person {" id="code2-l3"><span class="lineCounter-0-0-13 -codedoc-line-counter">3<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token keyword">class</span> Person <span class="token punctuation">{</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="" id="code2-l4"><span class="lineCounter-0-0-13 -codedoc-line-counter">4<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="    # properties" id="code2-l5"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">5<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span class="token comment"># properties</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="    [System.String]$Name" id="code2-l6"><span class="lineCounter-0-0-13 -codedoc-line-counter">6<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span class="token namespace">[System.String]</span><span class="token variable">$Name</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="    [System.Boolean]$IsCool" id="code2-l7"><span class="lineCounter-0-0-13 -codedoc-line-counter">7<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span class="token namespace">[System.Boolean]</span><span class="token variable">$IsCool</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="    [System.Int32]$Age" id="code2-l8"><span class="lineCounter-0-0-13 -codedoc-line-counter">8<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span class="token namespace">[System.Int32]</span><span class="token variable">$Age</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="    [System.String]$DOB" id="code2-l9"><span class="lineCounter-0-0-13 -codedoc-line-counter">9<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span class="token namespace">[System.String]</span><span class="token variable">$DOB</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="    [System.Object]$EmptyValue" id="code2-l10"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">10<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span class="token namespace">[System.Object]</span><span class="token variable">$EmptyValue</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="" id="code2-l11"><span class="lineCounter-0-0-13 -codedoc-line-counter">11<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="    # constructors" id="code2-l12"><span class="lineCounter-0-0-13 -codedoc-line-counter">12<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span class="token comment"># constructors</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="    Person () { }" id="code2-l13"><span class="lineCounter-0-0-13 -codedoc-line-counter">13<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    Person <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="    Person ([System.Management.Automation.PSCustomObject]$InputObject) {" id="code2-l14"><span class="lineCounter-0-0-13 -codedoc-line-counter">14<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    Person <span class="token punctuation">(</span><span class="token namespace">[System.Management.Automation.PSCustomObject]</span><span class="token variable">$InputObject</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="        $this.Name = $InputObject.Name" id="code2-l15"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">15<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>        <span class="token variable">$this</span><span class="token punctuation">.</span>Name = <span class="token variable">$InputObject</span><span class="token punctuation">.</span>Name</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="        $this.IsCool = $InputObject.IsCool" id="code2-l16"><span class="lineCounter-0-0-13 -codedoc-line-counter">16<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>        <span class="token variable">$this</span><span class="token punctuation">.</span>IsCool = <span class="token variable">$InputObject</span><span class="token punctuation">.</span>IsCool</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="        $this.Age = $InputObject.Age" id="code2-l17"><span class="lineCounter-0-0-13 -codedoc-line-counter">17<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>        <span class="token variable">$this</span><span class="token punctuation">.</span>Age = <span class="token variable">$InputObject</span><span class="token punctuation">.</span>Age</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="        $this.DOB = $InputObject.DOB" id="code2-l18"><span class="lineCounter-0-0-13 -codedoc-line-counter">18<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>        <span class="token variable">$this</span><span class="token punctuation">.</span>DOB = <span class="token variable">$InputObject</span><span class="token punctuation">.</span>DOB</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="        $this.EmptyValue = $InputObject.EmptyValue" id="code2-l19"><span class="lineCounter-0-0-13 -codedoc-line-counter">19<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>        <span class="token variable">$this</span><span class="token punctuation">.</span>EmptyValue = <span class="token variable">$InputObject</span><span class="token punctuation">.</span>EmptyValue</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="    }" id="code2-l20"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">20<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span class="token punctuation">}</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="" id="code2-l21"><span class="lineCounter-0-0-13 -codedoc-line-counter">21<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="}" id="code2-l22"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">22<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token punctuation">}</span></div><br></code></pre><p>Suprisingly, it detected the data type for all properties except for the date of birth which it cast as string.</p><p>Also, if a property has no value or <code>$null</code> value, it simply uses a generic <code>object</code> type.
You can't go wrong using that type, unless maybe there is an array in a dataset encountered later.
We won't concern ourselves with that possibility.</p><p>Let's save and then dot-source the class definition and try it out.</p><pre class="with-bar"><code class="powershell -codedoc-code-snippet code-0-0-12" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span></span></span><div class="line-0-0-16  -codedoc-code-line" data-content=". .\classPerson.ps1" id="code3-l1"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">1<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token punctuation">.</span> <span class="token punctuation">.</span>\classPerson<span class="token punctuation">.</span>ps1</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="[Person]::new" id="code3-l2"><span class="lineCounter-0-0-13 -codedoc-line-counter">2<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token namespace">[Person]</span>::new</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="[Person]::new($Person)" id="code3-l3"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">3<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token namespace">[Person]</span>::new<span class="token punctuation">(</span><span class="token variable">$Person</span><span class="token punctuation">)</span></div><br></code></pre><pre class="with-bar"><code class="powershell -codedoc-code-snippet code-0-0-12" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span></span></span><div class="line-0-0-16  -codedoc-code-line" data-content="OverloadDefinitions" id="code4-l1"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">1<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>OverloadDefinitions</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="-------------------" id="code4-l2"><span class="lineCounter-0-0-13 -codedoc-line-counter">2<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="Person new()" id="code4-l3"><span class="lineCounter-0-0-13 -codedoc-line-counter">3<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>Person new<span class="token punctuation">(</span><span class="token punctuation">)</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="Person new(System.Management.Automation.PSCustomObject InputObject)" id="code4-l4"><span class="lineCounter-0-0-13 -codedoc-line-counter">4<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>Person new<span class="token punctuation">(</span>System<span class="token punctuation">.</span>Management<span class="token punctuation">.</span>Automation<span class="token punctuation">.</span>PSCustomObject InputObject<span class="token punctuation">)</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="" id="code4-l5"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">5<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="Cannot find an overload for &quot;new&quot; and the argument count: &quot;1&quot;." id="code4-l6"><span class="lineCounter-0-0-13 -codedoc-line-counter">6<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>Cannot find an overload <span class="token keyword">for</span> <span class="token string">"new"</span> and the argument count: <span class="token string">"1"</span><span class="token punctuation">.</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="At line:1 char:1" id="code4-l7"><span class="lineCounter-0-0-13 -codedoc-line-counter">7<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>At line:1 char:1</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="+ [Person]::new($Person)" id="code4-l8"><span class="lineCounter-0-0-13 -codedoc-line-counter">8<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token operator">+</span> <span class="token namespace">[Person]</span>::new<span class="token punctuation">(</span><span class="token variable">$Person</span><span class="token punctuation">)</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="+ ~~~~~~~~~~~~~~~~~~~~" id="code4-l9"><span class="lineCounter-0-0-13 -codedoc-line-counter">9<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token operator">+</span> ~~~~~~~~~~~~~~~~~~~~</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="    + CategoryInfo          : NotSpecified: (:) [], MethodException" id="code4-l10"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">10<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span class="token operator">+</span> CategoryInfo          : NotSpecified: <span class="token punctuation">(</span>:<span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> MethodException</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="    + FullyQualifiedErrorId : MethodCountCouldNotFindBest" id="code4-l11"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">11<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span class="token operator">+</span> FullyQualifiedErrorId : MethodCountCouldNotFindBest</div><br></code></pre><p>As you can see, we received an error.
The constructor was not able to correctly interpret and accept the full name of <code>System.Management.Automation.PSCustomObject</code>.</p><p>After we shorten it to <code>PSCustomObject</code> and go through those same steps, it works as expected.</p><pre class="with-bar"><code class="powershell -codedoc-code-snippet code-0-0-12" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span></span></span><div class="line-0-0-16  -codedoc-code-line" data-content=". .\classPerson.ps1" id="code5-l1"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">1<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token punctuation">.</span> <span class="token punctuation">.</span>\classPerson<span class="token punctuation">.</span>ps1</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="[Person]::new($Person)" id="code5-l2"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">2<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token namespace">[Person]</span>::new<span class="token punctuation">(</span><span class="token variable">$Person</span><span class="token punctuation">)</span></div><br></code></pre><pre class="with-bar"><code class="powershell -codedoc-code-snippet code-0-0-12" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span></span></span><div class="line-0-0-16  -codedoc-code-line" data-content="Name IsCool Age DOB" id="code6-l1"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">1<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>Name IsCool Age DOB</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="---- ------ --- ---" id="code6-l2"><span class="lineCounter-0-0-13 -codedoc-line-counter">2<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token operator">--</span><span class="token operator">--</span> <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span> <span class="token operator">--</span><span class="token operator">-</span> <span class="token operator">--</span><span class="token operator">-</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="Dave   True  50 8/11/1970" id="code6-l3"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">3<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>Dave   True  50 8/11/1970</div><br></code></pre><h4 id="detection-of-data-type" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>Detection of Data Type</h4><p>As mentioned in the previous section, the data type for DOB was not automatically detected.
In fact, any type not discovered automatically will be cast as a <code>string</code>.
We can assume (maybe incorrectly) that for <code>PSCustomObject</code>s, we only have to check those properties cast as <code>string</code>.</p><p>For the purposes of the original challenge, this should be sufficient.
However, I want to use this tool to help me create class definitions for [BluebirdPS]({{&lt; relref "retired-links.md" &gt;}}).
The output from the TwitterAPI for several objects include different <code>uri</code> and <code>datetime</code> typed properties.</p><p>I'd like to take this time explain the design practice when creating a tool like <code>Resolve-PropertyType</code>.</p><blockquote><p>"A" PowerShell tool, aka function, should do "a" thing.
Not two things, and not three things or more.
Just one.</p></blockquote><p><code>Resolve-PropertyType</code> returns a string or an array.
But it doesn't apply formatting or get data or save data.
It takes the input string and then attempts to determine the best guess for the type of data.
As it goes through each <code>try/catch</code> block, it checks if the string can be cast as a specific type.
You typically handle errors in the catch block, but for this use case, we only care about successes.</p><p>Later on, when we discover that we need to include checks for additional types, and odds are that we will find new types,
we can add it to this smaller function and not get lost in hundreds of lines of code.
Many PowerShell scripters, especially the more advanced, save function definitions in separate files.</p><p>Check out the relatively simple function I wrote to handle detection the specific data types - URI, DateTime, and Twitter DateTime.</p><p>{{&lt; gist id="a0db4e3b3c97941ddf11e161288408d7" file="Part2-Resolve-PropertyType.ps1" &gt;}}</p><h4 id="properly-pascalcase-property-names-aka-a-case-for-pascalcase" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>Properly PascalCase Property Names, aka A Case for PascalCase</h4><p>A proper PowerShell property name should use <code>PascalCase</code> which is to capitalize the first letter of each word and forego the use of punctuation.
For instance, use <code>ComputerName</code> instead of <code>computerName</code>, <code>Computer Name</code>, or <code>computer_name</code>.
This guidance should be used not only for properties, but also parameters, the noun in function names, enums, variables, class names, etc.</p><p>We can assume that property names for .NET classes should already adhere to proper naming and capitalization convention.
Therefore, we should examine the property names only for <code>PSCustomObject</code> typed objects.
These objects are typically generated "on-the-fly" or by explicitly converting one object type to a <code>PSCustomObject</code>.
When you use <code>Invoke-RestMethod</code> and the response is a JSON string, the response is converted to a <code>PSCustomObject</code>.</p><p>This latter case is driving my design requirement of converting property names to proper PascalCase.
The output from the API calls in <code>BluebirdPS</code> return a <code>PSCustomObject</code> with property names all lowercase with underscores between words.</p><pre class=""><code class="powershell -codedoc-code-snippet code-0-0-12" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span></span></span><div class="line-0-0-16  -codedoc-code-line" data-content="Get-TwitterUser -ScreenName thedavecarroll" id="code7-l1"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">1<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token function">Get-TwitterUser</span> <span class="token operator">-</span>ScreenName thedavecarroll</div><br></code></pre><pre class="with-bar"><code class="powershell -codedoc-code-snippet code-0-0-12" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span></span></span><div class="line-0-0-16  -codedoc-code-line" data-content="id                                 : 292670084" id="code8-l1"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">1<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>id                                 : 292670084</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="name                               : Dave Carroll" id="code8-l2"><span class="lineCounter-0-0-13 -codedoc-line-counter">2<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>name                               : Dave Carroll</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="screen_name                        : thedavecarroll" id="code8-l3"><span class="lineCounter-0-0-13 -codedoc-line-counter">3<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>screen_name                        : thedavecarroll</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="location                           : Nashville, TN" id="code8-l4"><span class="lineCounter-0-0-13 -codedoc-line-counter">4<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>location                           : Nashville<span class="token punctuation">,</span> TN</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="..." id="code8-l5"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">5<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span></div><br></code></pre><p>As you can see, <code>screen_name</code> does not <em>look</em> like a property on a typical PowerShell object.</p><p>Here are the desired names.</p><pre class="with-bar"><code class="powershell -codedoc-code-snippet code-0-0-12" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span></span></span><div class="line-0-0-16  -codedoc-code-line" data-content="Id" id="code9-l1"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">1<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>Id</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="Name" id="code9-l2"><span class="lineCounter-0-0-13 -codedoc-line-counter">2<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>Name</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="ScreenName" id="code9-l3"><span class="lineCounter-0-0-13 -codedoc-line-counter">3<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>ScreenName</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="Location" id="code9-l4"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">4<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>Location</div><br></code></pre><p>If this scenario sounds familiar, you may be recalling a recent article by Jeff Hicks, <a href="https://jdhitsolutions.com/blog/powershell/7937/creating-powershell-property-names/">Creating PowerShell Property Names</a>.
Jeff was playing around with the <code>BluebirdPS</code> module and called out the fact that it does not output a proper looking PowerShell object.
Obviously, I knew that the API-based commands returned the raw object from Twitter, after conversion by <code>Invoke-Method</code>.
It was a matter of releasing the minimum viable product to get it in the hands of people, maybe even awesome people like Jeff, to begin testing.
I chose to ship it without proper looking objects and several other features.</p><blockquote><p>I just want to mention that the call-out was greatly appreciated,
mainly because it meant that someone in the PowerShell community was using BluebirdPS,
if not to just play around with it.
For someone so prominent in the community as Jeff Hicks to spend time on it and
write an article about an aspect so others can learn just a little more about PowerShell,
I was incredibly flattered and perhaps just a little flabbergasted.</p><p>Jeff also submitted a few issues for BluebirdPS.</p><p>Thank you, Jeff!</p></blockquote><p>Here is another simple function that should convert any string, array of strings, to PascalCase.
It uses the Regex non-word token, <code>\W</code>, to match on most punctuation.
Ironically, the BluebirdPS output uses the only punctuation that Regex considers to be a "word" and I had to include it as an alternate matching pattern.
Then I use the <code>ToTitleCase()</code> method of the <code>TextInfo</code> class, that's returned as a property of the same name from <code>Get-Culture</code>, to uppercase the first letter.</p><p>When I realized that some properties were already PascalCase, I included an <code>if/else</code> statement to skip anything that was not implicitly converted.</p><p>{{&lt; gist id="a0db4e3b3c97941ddf11e161288408d7" file="Part2-ConvertTo-PascalCase.ps1" &gt;}}</p><p>To discover more best practices and guidelines for style, visit the unofficial <a href="https://github.com/PoshCode/PowerShellPracticeAndStyle">PowerShellPracticeAndStyle</a> repo.
The <a href="https://github.com/PoshCode/PowerShellPracticeAndStyle/blob/master/Style-Guide/Code-Layout-and-Formatting.md#capitalization-conventions">Code Layout and Formatting</a> document specifically discusses the capitalization conventions.</p><h3 id="updated-constructor" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>Updated Constructor</h3><p>In the original parameterized constructor, <code>MyClass([Object]$InputObject)</code>, all the <em>setter</em> statements looks like this.</p><pre class="with-bar"><code class="powershell -codedoc-code-snippet code-0-0-12" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span></span></span><div class="line-0-0-16  -codedoc-code-line" data-content="'{0}{0}$this.{1} = $InputObject.{1}' -f $Indent,$Property.Name" id="code10-l1"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">1<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token string">'{0}{0}$this.{1} = $InputObject.{1}'</span> <span class="token operator">-</span>f <span class="token variable">$Indent</span><span class="token punctuation">,</span><span class="token variable">$Property</span><span class="token punctuation">.</span>Name</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="" id="code10-l2"><span class="lineCounter-0-0-13 -codedoc-line-counter">2<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="# after string interpolation with a property with name of PropertyName1" id="code10-l3"><span class="lineCounter-0-0-13 -codedoc-line-counter">3<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token comment"># after string interpolation with a property with name of PropertyName1</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="$this.PropertyName1 = $InputObject.PropertyName1" id="code10-l4"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">4<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token variable">$this</span><span class="token punctuation">.</span>PropertyName1 = <span class="token variable">$InputObject</span><span class="token punctuation">.</span>PropertyName1</div><br></code></pre><p>This works well for most object types.
However, now that we potentially change the property names for <code>PsCustomObject</code> typed input objects,
we need to update the constructor's setter statements.</p><p>With a bit of added logic, we use the following for specific types.</p><pre class="with-bar"><code class="powershell -codedoc-code-snippet code-0-0-12" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span></span></span><div class="line-0-0-16  -codedoc-code-line" data-content="# generic property setter, works for uri" id="code11-l1"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">1<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token comment"># generic property setter, works for uri</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="$PropertySetter = '$InputObject.{0}' -f $Property.Name" id="code11-l2"><span class="lineCounter-0-0-13 -codedoc-line-counter">2<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token variable">$PropertySetter</span> = <span class="token string">'$InputObject.{0}'</span> <span class="token operator">-</span>f <span class="token variable">$Property</span><span class="token punctuation">.</span>Name</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="" id="code11-l3"><span class="lineCounter-0-0-13 -codedoc-line-counter">3<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="# datetime Parse setter" id="code11-l4"><span class="lineCounter-0-0-13 -codedoc-line-counter">4<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token comment"># datetime Parse setter</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="$PropertySetter = '[datetime]::Parse($InputObject.{0},(Get-Culture))' -f $Property.Name" id="code11-l5"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">5<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token variable">$PropertySetter</span> = <span class="token string">'[datetime]::Parse($InputObject.{0},(Get-Culture))'</span> <span class="token operator">-</span>f <span class="token variable">$Property</span><span class="token punctuation">.</span>Name</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="" id="code11-l6"><span class="lineCounter-0-0-13 -codedoc-line-counter">6<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="# datetime ParseExact setter" id="code11-l7"><span class="lineCounter-0-0-13 -codedoc-line-counter">7<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token comment"># datetime ParseExact setter</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="$PropertySetter = '[datetime]::ParseExact($InputObject.{0},''{1}'',(Get-Culture))' -f $Property.Name,$PropertyTypeConversion[2]" id="code11-l8"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">8<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token variable">$PropertySetter</span> = <span class="token string">'[datetime]::ParseExact($InputObject.{0},''{1}'',(Get-Culture))'</span> <span class="token operator">-</span>f <span class="token variable">$Property</span><span class="token punctuation">.</span>Name<span class="token punctuation">,</span><span class="token variable">$PropertyTypeConversion</span><span class="token punctuation">[</span>2<span class="token punctuation">]</span></div><br></code></pre><ul><li>The <code>uri</code> data type does not require a modification as the <code>new()</code> constructor takes a string which has already been validated.</li><li>The Parse <code>datetime</code> requires the use of the <code>Parse()</code> static method of the <code>datetime</code> class.
If the property was in a known format, it would use this setter.</li><li>The ParseExact <code>datetime</code> requires the use of the <code>ParseExact()</code> static method of the <code>datetime</code> class so a specific format can be provided.
This allows us to set the property value after converting from a datetime value in a specific format, such as the format the Twitter API returns.</li></ul><p>The new property setter uses the property name converted to PascalCase and the <code>$PropertySetter</code> string is added resulting the following.</p><pre class=""><code class="powershell -codedoc-code-snippet code-0-0-12" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span></span></span><div class="line-0-0-16  -codedoc-code-line" data-content="'{0}{0}$this.{1} = {2}' -f $Indent,$PascalCaseProperty,$PropertySetter" id="code12-l1"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">1<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token string">'{0}{0}$this.{1} = {2}'</span> <span class="token operator">-</span>f <span class="token variable">$Indent</span><span class="token punctuation">,</span><span class="token variable">$PascalCaseProperty</span><span class="token punctuation">,</span><span class="token variable">$PropertySetter</span></div><br></code></pre><p>Since we could be converting the property name to PascalCase, we need to update the property definition.</p><pre class=""><code class="powershell -codedoc-code-snippet code-0-0-12" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span></span></span><div class="line-0-0-16  -codedoc-code-line" data-content="$PropertyStatement = '{0}[{1}]${2}' -f $Indent,$PropertyTypeName,$PascalCaseProperty" id="code13-l1"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">1<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token variable">$PropertyStatement</span> = <span class="token string">'{0}[{1}]${2}'</span> <span class="token operator">-</span>f <span class="token variable">$Indent</span><span class="token punctuation">,</span><span class="token variable">$PropertyTypeName</span><span class="token punctuation">,</span><span class="token variable">$PascalCaseProperty</span></div><br></code></pre><h3 id="hidden-properties" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>Hidden Properties</h3><p>The last requirement I want to cover in this article <em>(spoiler alert there will be another part/article for this challenge)</em> is allowing the user to hide specific properties.
This is a simple addition of another parameter.</p><pre class="with-bar"><code class="powershell -codedoc-code-snippet code-0-0-12" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span></span></span><div class="line-0-0-16  -codedoc-code-line" data-content="[ValidateNotNullOrEmpty()]" id="code14-l1"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">1<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token namespace">[ValidateNotNullOrEmpty()]</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="[Alias('Hidden')]" id="code14-l2"><span class="lineCounter-0-0-13 -codedoc-line-counter">2<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token punctuation">[</span>Alias<span class="token punctuation">(</span><span class="token string">'Hidden'</span><span class="token punctuation">)</span><span class="token punctuation">]</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="[string[]]$HiddenProperty" id="code14-l3"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">3<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token namespace">[string[]]</span><span class="token variable">$HiddenProperty</span></div><br></code></pre><p>In a class definition, to make the parameter hidden, simply add <code>hidden</code> prior to the type definition.</p><pre class=""><code class="powershell -codedoc-code-snippet code-0-0-12" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span></span></span><div class="line-0-0-16  -codedoc-code-line" data-content="hidden [String]$IdStr" id="code15-l1"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">1<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>hidden <span class="token namespace">[String]</span><span class="token variable">$IdStr</span></div><br></code></pre><p>I provide a bit of logic to the property definition section to add the <code>hidden</code> attribute based on the original name or the converted PascalCase name of the property name.</p><h3 id="property-attributes" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>Property Attributes</h3><p>Class properties can have property attributes that defines how the property can be used, how the values contained in it are validated, and whether visible.</p><ul><li>hidden<ul><li>A hidden property is not readily visible, but it is still available to the user through direct reference, <code>$MyObject.HiddenProperty</code>, and can be revealed through the use of <code>Get-Member -Force</code>.</li></ul></li><li>static<ul><li>The static attribute can be used for a property and/or a method.</li></ul></li><li>validation<ul><li>You can use the same validation attributes as you can for advanced functions.</li></ul></li></ul><p>Check out more information on the <a href="https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_hidden?view=powershell-7.1">hidden attribute</a> and <a href="https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_classes?view=powershell-7.1#static-attribute">static and property validation attributes</a> on the Microsoft Docs site.</p><h3 id="one-last-thing-on-the-pascalcase-case" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>One Last Thing on the PascalCase Case</h3><p>As I was tidying up this article to get it ready for publishing, I discovered my original <code>ConvertTo-PascalCase</code> had a bug.
A lowercase string, without punctuation, was not properly returned as PascalCase.</p><p>I added another step to test for beginning uppercase <code>^[A-Z]</code> but that didn't seem to work either.
Until I realized that the regex operators <code>match</code> and <code>notmatch</code> are not case sensitive.
Once I changed the operator to <code>-cnotmatch</code>, it started working as needed.</p><h2 id="part-2-solution" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>Part 2 Solution</h2><p>Here is my current <code>ConvertTo-ClassDefinition</code> function.</p><p>{{&lt; gist id="a0db4e3b3c97941ddf11e161288408d7" file="Part2-ConvertTo-ClassDefinition.ps1" &gt;}}</p><p>And here is a sample output from <code>Get-TwitterUser -ScreenName thedavecarroll | ConvertTo-ClassDefinition -ClassName 'BluebirdPSUser' -HiddenProperty 'id_str'</code>.</p><p>{{&lt; gist id="a0db4e3b3c97941ddf11e161288408d7" file="Part2-BluebirdPSUserClass.ps1" &gt;}}</p><h2 id="summary" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>Summary</h2><p>I originally thought this article was going to complete the challenge but, as I mentioned above, I'm not done.</p><p>In this one, I focused on some of my own requirements, namely enforcing PascalCase for class and property names, resolution of property types that are generically cast as <code>string</code> objects, and allowing the user to specify properties to hide.</p><p>In the next article, I plan to explore and cover the remaining requirements:</p><ul><li>Insert placeholder for methods</li><li>Let the user specify a method</li><li>Be VSCode aware and insert the new class automatically into the current file</li><li>Should be recursive.<ul><li>Any object that contains a property which is itself another complex object should generate a separate class definition.</li></ul></li><li>Contained in a small module, as there will be a few helper functions.</li></ul><p>I hope youve found this interesting or informative.
If you have any comments or questions, please post them below.</p><p>Thanks for reading and good luck on the Iron Scripter challenges!</p><div class="contentnav-0-0-11" data-no-search=""><a href="#a-powershell-conversion-challenge" class="h2" data-content-highlight="a-powershell-conversion-challenge">A PowerShell Conversion Challenge</a><a href="#the-path-to-a-solution" class="h2" data-content-highlight="the-path-to-a-solution">The Path to a Solution</a><a href="#pscustomobject" class="h3" data-content-highlight="pscustomobject">PSCustomObject</a><a href="#detection-of-data-type" class="h4" data-content-highlight="detection-of-data-type">Detection of Data Type</a><a href="#properly-pascalcase-property-names-aka-a-case-for-pascalcase" class="h4" data-content-highlight="properly-pascalcase-property-names-aka-a-case-for-pascalcase">Properly PascalCase Property Names, aka A Case for PascalCase</a><a href="#updated-constructor" class="h3" data-content-highlight="updated-constructor">Updated Constructor</a><a href="#hidden-properties" class="h3" data-content-highlight="hidden-properties">Hidden Properties</a><a href="#property-attributes" class="h3" data-content-highlight="property-attributes">Property Attributes</a><a href="#one-last-thing-on-the-pascalcase-case" class="h3" data-content-highlight="one-last-thing-on-the-pascalcase-case">One Last Thing on the PascalCase Case</a><a href="#part-2-solution" class="h2" data-content-highlight="part-2-solution">Part 2 Solution</a><a href="#summary" class="h2" data-content-highlight="summary">Summary</a></div></div><div id="-codedoc-toc" class="toc-0-0-8"><div class="content-0-0-9"><div class="heading-0-0-3">Index</div><p><a href="/codedoc/">Home</a>
<a href="/codedoc/README">Index</a>
<a href="/codedoc/docs/Kostwein">Kostwein</a></p><div class="collapse-0-0-4 "><script id="GEPKhCsjRq">(function(){function load(){if (window.__sdh_transport){window.__sdh_transport("GEPKhCsjRq", "yAdNJkOJGbj52dvfV+HpdQ==", {});} }; if (document.readyState == 'complete') load(); else window.addEventListener('load', load); window.setImmediate = window.setImmediate || function(f){setTimeout(f, 0)}; })()</script><div class="label" onclick="this.parentElement.classList.toggle('open')"><span class="text">PSModulesHelp</span><span class="icon-font closed">chevron_right</span></div><div class="content"><p><a href="/codedoc/docs/PSModulesHelp/ModuleDoku">PS Modules Help</a></p><hr></div></div><div class="collapse-0-0-4 "><script id="qhuqbqqGoU">(function(){function load(){if (window.__sdh_transport){window.__sdh_transport("qhuqbqqGoU", "yAdNJkOJGbj52dvfV+HpdQ==", {});} }; if (document.readyState == 'complete') load(); else window.addEventListener('load', load); window.setImmediate = window.setImmediate || function(f){setTimeout(f, 0)}; })()</script><div class="label" onclick="this.parentElement.classList.toggle('open')"><span class="text">KnowledgeBase</span><span class="icon-font closed">chevron_right</span></div><div class="content"><blockquote><p><a href="/codedoc/docs/Knowledge/PowerShell/Index">PowerShell</a></p></blockquote></div></div><div class="collapse-0-0-4 "><script id="cvgJJyjVhX">(function(){function load(){if (window.__sdh_transport){window.__sdh_transport("cvgJJyjVhX", "yAdNJkOJGbj52dvfV+HpdQ==", {});} }; if (document.readyState == 'complete') load(); else window.addEventListener('load', load); window.setImmediate = window.setImmediate || function(f){setTimeout(f, 0)}; })()</script><div class="label" onclick="this.parentElement.classList.toggle('open')"><span class="text">Links</span><span class="icon-font closed">chevron_right</span></div><div class="content"><blockquote><p><a href="/codedoc/docs/Links/LinksWiki">Index</a></p></blockquote></div></div><div class="collapse-0-0-4 "><script id="YxLaRcRpSa">(function(){function load(){if (window.__sdh_transport){window.__sdh_transport("YxLaRcRpSa", "yAdNJkOJGbj52dvfV+HpdQ==", {});} }; if (document.readyState == 'complete') load(); else window.addEventListener('load', load); window.setImmediate = window.setImmediate || function(f){setTimeout(f, 0)}; })()</script><div class="label" onclick="this.parentElement.classList.toggle('open')"><span class="text">Veeam</span><span class="icon-font closed">chevron_right</span></div><div class="content"><blockquote><p><a href="/codedoc/docs/Knowledge/Veeam/Best%20Practices/index">Best Practices</a></p></blockquote></div></div><p><a href="/codedoc/docs/cheat-sheet">Markdown Cheat Sheet</a>
<a href="/codedoc/docs/code-features">Code Features</a></p><p><br><br></p><p>To add links to your other documents, simply
modify contents of <code>docs/md/_toc.md</code>.</p></div><div class="search-0-0-10"><script id="CdCMytyDJk">(function(){function load(){if (window.__sdh_transport){window.__sdh_transport("CdCMytyDJk", "EKtVWhWp+AfK3O64A4+bOg==", {"repo":"codedoc","user":"In-Pro-Org","root":"docs/md","pick":"\\.md$","drop":"(^_)|(\\/_)"});} }; if (document.readyState == 'complete') load(); else window.addEventListener('load', load); window.setImmediate = window.setImmediate || function(f){setTimeout(f, 0)}; })()</script></div></div><div class="footer-0-0-7"><div class="left"><script id="eTYwEJTbQN">(function(){function load(){if (window.__sdh_transport){window.__sdh_transport("eTYwEJTbQN", "wCsMx1XMyC4jNi3FxvjU4g==", {});} }; if (document.readyState == 'complete') load(); else window.addEventListener('load', load); window.setImmediate = window.setImmediate || function(f){setTimeout(f, 0)}; })()</script></div><div class="main"><div class="inside"><a href="https://github.com/In-Pro-Org/codedoc/" target="_blank">GitHub</a></div></div><div class="right"><script id="MgfAVloxDZ">(function(){function load(){if (window.__sdh_transport){window.__sdh_transport("MgfAVloxDZ", "6W59GcSTLBVXRr/Nl/rTkw==", {});} }; if (document.readyState == 'complete') load(); else window.addEventListener('load', load); window.setImmediate = window.setImmediate || function(f){setTimeout(f, 0)}; })()</script></div></div><script id="nJWbKvNTRB">(function(){function load(){if (window.__sdh_transport){window.__sdh_transport("nJWbKvNTRB", "zKXJ5zf13oJGCwAAI3JIIA==", {"namespace":"/codedoc"});} }; if (document.readyState == 'complete') load(); else window.addEventListener('load', load); window.setImmediate = window.setImmediate || function(f){setTimeout(f, 0)}; })()</script></body></html>