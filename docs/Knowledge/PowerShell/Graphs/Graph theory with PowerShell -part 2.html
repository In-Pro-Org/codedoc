<!DOCTYPE html><html><head><title>Codedoc</title><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"><meta name="robots" content="index,follow"><meta name="theme-color" content="#212121"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><link rel="shortcut icon" href="/codedoc/docs/images/KostweinLogo.ico"><link href="https://fonts.googleapis.com/css?family=Roboto:300,400&amp;display=swap" rel="stylesheet"><link href="https://fonts.googleapis.com/css?family=Source+Code+Pro:300,400&amp;display=swap" rel="stylesheet"><link href="https://fonts.googleapis.com/icon?family=Material+Icons%7CMaterial+Icons+Outlined&amp;display=swap" rel="stylesheet"><style>
      body, input, button {
        font-family: 'Roboto', sans-serif;
      }

      code, .hljs {
        font-family: 'Source Code Pro', 'Courier New', Courier, monospace;
      }

      .icon-font {
        font-family: 'Material Icons';
        font-weight: normal;
        font-style: normal;
        font-size: 24px;  /* Preferred icon size */
        display: inline-block;
        line-height: 1;
        text-transform: none;
        letter-spacing: normal;
        word-wrap: normal;
        white-space: nowrap;
        direction: ltr;
      
        /* Support for all WebKit browsers. */
        -webkit-font-smoothing: antialiased;
        /* Support for Safari and Chrome. */
        text-rendering: optimizeLegibility;
      
        /* Support for Firefox. */
        -moz-osx-font-smoothing: grayscale;
      
        /* Support for IE. */
        font-feature-settings: 'liga';
      }

      .icon-font.outline {
        font-family: 'Material Icons Outlined';
      }
    </style><link href="/codedoc/docs/assets/codedoc-styles.css" rel="stylesheet"><script async="" defer="" src="/codedoc/docs/assets/codedoc-bundle.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css" integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq" crossorigin="anonymous"></head><body data-path="docs\Knowledge\PowerShell\Graphs\Graph theory with PowerShell -part 2.md"><div class="header-0-0-12"><script async="" defer="" src="https://buttons.github.io/buttons.js"></script><a class="github-button" data-color-scheme="no-preference: light; light: light; dark: dark;" data-icon="false" data-show-count="true" data-size="false" href="https://github.com/In-Pro-Org/codedoc/">Star</a><br><br><a class="watermark-0-0-11" href="https://github.com/CONNECT-platform/codedoc" target="_blank">Created With<svg viewBox="0 0 536 296" version="1.1" xmlns="http://www.w3.org/2000/svg"><g id="codedoc" transform="translate(-244.000000, -364.000000)" fill-rule="nonzero"><path d="M580,532 C615.346224,532 644,560.653776 644,596 C644,631.346224 615.346224,660 580,660 C544.653776,660 516,631.346224 516,596 C516,560.653776 544.653776,532 580,532 Z M716,532 C751.346224,532 780,560.653776 780,596 C780,631.346224 751.346224,660 716,660 L692,660 C687.581722,660 684,656.418278 684,652 C684,647.581722 687.581722,644 692,644 L716,644 C742.509668,644 764,622.509668 764,596 C764,569.490332 742.509668,548 716,548 L692,548 C687.581722,548 684,544.418278 684,540 C684,535.581722 687.581722,532 692,532 L716,532 Z M468,532 C472.418278,532 476,535.581722 476,540 L476,652 C476,656.418278 472.418278,660 468,660 L444,660 C408.653776,660 380,631.346224 380,596 C380,560.653776 408.653776,532 444,532 L468,532 Z M332,532 C336.418278,532 340,535.581722 340,540 L340,652 C340,656.418278 336.418278,660 332,660 L252,660 C247.581722,660 244,656.418278 244,652 L244,540 C244,535.581722 247.581722,532 252,532 L332,532 Z M580,548 C553.490332,548 532,569.490332 532,596 C532,622.509668 553.490332,644 580,644 C606.509668,644 628,622.509668 628,596 C628,569.490332 606.509668,548 580,548 Z M461,548 L444,548 C417.490332,548 396,569.490332 396,596 C396,622.509668 417.490332,644 444,644 L461,644 L461,548 Z M444,364 C479.346224,364 508,392.653776 508,428 C508,463.346224 479.346224,492 444,492 C408.653776,492 380,463.346224 380,428 C380,392.653776 408.653776,364 444,364 Z M332,364 C336.418278,364 340,367.581722 340,372 C340,376.418278 336.418278,380 332,380 L308,380 C281.490332,380 260,401.490332 260,428 C260,454.509668 281.490332,476 308,476 L332,476 C336.418278,476 340,479.581722 340,484 C340,488.418278 336.418278,492 332,492 L308,492 C272.653776,492 244,463.346224 244,428 C244,392.653776 272.653776,364 308,364 L332,364 Z M580,364 C615.346224,364 644,392.653776 644,428 C644,463.346224 615.346224,492 580,492 L556,492 C551.581722,492 548,488.418278 548,484 L548,372 C548,367.581722 551.581722,364 556,364 L580,364 Z M772,364 C776.418278,364 780,367.581722 780,372 C780,376.418278 776.418278,380 772,380 L700,380 L700,420 L772,420 C776.418278,420 780,423.581722 780,428 C780,432.418278 776.418278,436 772,436 L700,436 L700,476 L772,476 C776.418278,476 780,479.581722 780,484 C780,488.418278 776.418278,492 772,492 L692,492 C687.581722,492 684,488.418278 684,484 L684,372 C684,367.581722 687.581722,364 692,364 L772,364 Z M444,380 C417.490332,380 396,401.490332 396,428 C396,454.509668 417.490332,476 444,476 C470.509668,476 492,454.509668 492,428 C492,401.490332 470.509668,380 444,380 Z M580,380 L563,380 L563,476 L580,476 C606.509668,476 628,454.509668 628,428 C628,401.490332 606.509668,380 580,380 Z"></path></g></svg></a></div><div id="-codedoc-container" class="container"><hr><p>created: 2025-03-26T14:15:49 (UTC +01:00)
tags: []
source: <a href="https://powershellone.wordpress.com/2021/03/23/graph-theory-with-powershell-part-2/">https://powershellone.wordpress.com/2021/03/23/graph-theory-with-powershell-part-2/</a>
author: Dirk</p><hr><h1 id="graph-theory-with-powershell--part-2--tech-thoughts" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>Graph theory with PowerShell -part 2 – Tech thoughts</h1><hr><p><a href="https://powershellone.wordpress.com/wp-content/uploads/2021/03/vecteezy_solo-green-tree-under-white-sky-in-a-field-during-daytime_1259904.jpeg"><img src="https://powershellone.wordpress.com/wp-content/uploads/2021/03/vecteezy_solo-green-tree-under-white-sky-in-a-field-during-daytime_1259904.jpeg?w=1024" alt=""></a></p><blockquote><p>This is part two (<a href="https://powershellone.wordpress.com/2021/03/03/graph-theory-with-powershell/">part one</a>) of graph theory, focusing on “Small World Graphs”, with PowerShell based on (Chapter 3) of the excellent book <a href="https://greenteapress.com/wp/think-complexity-2e/">Think Complexity 2e</a> by Allen B. Downey (in fact I’d highly recommend any of the books in the “Think…” series some of which I might cover in future posts). The book and the book’s source (in Python) are available for free through the book’s webpage (the physical book can be purchased too).</p></blockquote><h2 id="table-of-contents" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>Table of contents<a href="https://powershellone.wordpress.com/2021/03/23/graph-theory-with-powershell-part-2/#Table-of-contents"></a></h2><ul><li><a href="https://powershellone.wordpress.com/2021/03/23/graph-theory-with-powershell-part-2/#theory">Some necessary theory</a></li><li><a href="https://powershellone.wordpress.com/2021/03/23/graph-theory-with-powershell-part-2/#ring">Ring-Lattice graph</a></li><li><a href="https://powershellone.wordpress.com/2021/03/23/graph-theory-with-powershell-part-2/#smallworld">Small-World graph Watts/Strogatz</a><ul><li><a href="https://powershellone.wordpress.com/2021/03/23/graph-theory-with-powershell-part-2/#clustering">Clustering Coefficient</a></li><li><a href="https://powershellone.wordpress.com/2021/03/23/graph-theory-with-powershell-part-2/#shortest">Shortest Path Length</a></li><li><a href="https://powershellone.wordpress.com/2021/03/23/graph-theory-with-powershell-part-2/#wse">Small-World experiment (Watts, Strogatz)</a></li></ul></li></ul><h2 id="some-necessary-theory" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>Some necessary theory<a href="https://powershellone.wordpress.com/2021/03/23/graph-theory-with-powershell-part-2/#Some-necessary-theory-"></a></h2><p>Small World Graphs are graphs in which most nodes are not neighbours of one another, but the neighbors of any given node are likely to be neighbors of each other and most nodes can be reached from every other node by a small number of hops or steps.</p><p>Most people have heard of Small World Graphs in conjunction with the <a href="https://en.wikipedia.org/wiki/Small-world_experiment">small-world experiment</a> conducted by <a href="https://en.wikipedia.org/wiki/Stanley_Milgram">Stanley Milgram</a> leading to the infamous phrase “six degrees of separation”.</p><p>We will try to replicate the experiment based on <a href="https://en.wikipedia.org/wiki/Watts%E2%80%93Strogatz_model">the work of Watts and Strogatz</a>. The Watts-Strogatz model is a random graph generation model (we talked about random graphs in <a href="https://powershellone.wordpress.com/2021/03/03/graph-theory-with-powershell/">part one</a> of this series) that produces graphs with small-world properties, i.e. short average path lengths and high clustering, which neither regular graphs (see below) nor random graphs exhibit at the same time.</p><ul><li><p><strong>Clustering</strong> is a measure of the degree to which nodes in a graph tend to group together. Evidence suggests that in most real-world networks, and in particular social networks, nodes tend to create tightly knit clusters characterized by a relatively high density of ties; this likelihood tends to be greater than the average probability of a tie randomly established between two nodes.</p></li><li><p><strong>Average path-length</strong> – The average number of edges between two nodes.</p></li><li><p><strong>Regular Graph</strong> – A graph where each node has the same number of neighbours the number of neighbours is also called the degree of the node.</p></li></ul><p>The Watts and Strogatz model suggest the following steps to generate a Small World Graph:</p><ul><li>Start with a regular graph (a ring lattice graph can be used for this purpose) with n nodes and each node connected to k neighbours.</li><li>Choose a subset of the edges and rewire them by replacing them with random edges.</li></ul><p>In a ring lattice graph the nodes are arranged in a circle with each node connected to the specified nearest neighbours.</p><h2 id="ring-lattice-graph" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>Ring-Lattice graph<a href="https://powershellone.wordpress.com/2021/03/23/graph-theory-with-powershell-part-2/#Ring-Lattice-graph-"></a></h2><p>Enough theory let’s use some code. First, we’ll need some of the helper functions created in the <a href="https://powershellone.wordpress.com/2021/03/03/graph-theory-with-powershell/">first part</a>.</p><pre class="with-bar"><code class="undefined -codedoc-code-snippet code-0-0-3" tabindex="0"><span class="wmbar-0-0-8"><span></span><span></span><span></span><span></span></span><div class="line-0-0-7  -codedoc-code-line" data-content="<span></span><span>Import-Module</span> <span>PSGraph</span>" id="code1-l1"><span class="lineCounter-0-0-4 prim -codedoc-line-counter">1<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span></span><span>Import-Module</span> <span>PSGraph</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="" id="code1-l2"><span class="lineCounter-0-0-4 -codedoc-line-counter">2<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="<span>function</span> <span>Show-PSGraph</span> <span>([</span><span>ValidateSet</span><span>(</span><span>'dot'</span><span>,</span> <span>'circular'</span><span>,</span> <span>'Hierarchical'</span><span>,</span> <span>'Radial'</span><span>,</span> <span>'fdp'</span><span>,</span> <span>'neato'</span><span>,</span> <span>'sfdp'</span><span>,</span> <span>'SpringModelLarge'</span><span>,</span> <span>'SpringModelSmall'</span><span>,</span> <span>'SpringModelMedium'</span><span>,</span> <span>'twopi'</span><span>)]$</span><span>LayoutEngine</span> <span>=</span> <span>'circular'</span><span>)</span> <span>{</span>" id="code1-l3"><span class="lineCounter-0-0-4 -codedoc-line-counter">3<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span>function</span> <span>Show-PSGraph</span> <span>([</span><span>ValidateSet</span><span>(</span><span>'dot'</span><span>,</span> <span>'circular'</span><span>,</span> <span>'Hierarchical'</span><span>,</span> <span>'Radial'</span><span>,</span> <span>'fdp'</span><span>,</span> <span>'neato'</span><span>,</span> <span>'sfdp'</span><span>,</span> <span>'SpringModelLarge'</span><span>,</span> <span>'SpringModelSmall'</span><span>,</span> <span>'SpringModelMedium'</span><span>,</span> <span>'twopi'</span><span>)]$</span><span>LayoutEngine</span> <span>=</span> <span>'circular'</span><span>)</span> <span>{</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="    <span>$</span><span>all</span> <span>=</span> <span>@($</span><span>Input</span><span>)</span>" id="code1-l4"><span class="lineCounter-0-0-4 -codedoc-line-counter">4<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span>$</span><span>all</span> <span>=</span> <span>@($</span><span>Input</span><span>)</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="    <span>$</span><span>tempPath</span> <span>=</span> <span>[System.IO.Path]</span><span>::</span><span>GetTempFileName</span><span>()</span>" id="code1-l5"><span class="lineCounter-0-0-4 prim -codedoc-line-counter">5<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span>$</span><span>tempPath</span> <span>=</span> <span>[System.IO.Path]</span><span>::</span><span>GetTempFileName</span><span>()</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="    <span>$</span><span>all</span> <span>|</span> <span>Out-File</span> <span>$</span><span>tempPath</span>" id="code1-l6"><span class="lineCounter-0-0-4 -codedoc-line-counter">6<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span>$</span><span>all</span> <span>|</span> <span>Out-File</span> <span>$</span><span>tempPath</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="    <span>$</span><span>new</span> <span>=</span> <span>Get-Content</span> <span>$</span><span>tempPath</span> <span>-raw</span> <span>|</span> <span>ForEach</span><span>-Object</span> <span>{</span> <span>$</span><span>_</span> <span>-replace</span> <span>&quot;</span><span>`r</span><span>&quot;</span><span>,</span> <span>&quot;&quot;</span> <span>}</span>" id="code1-l7"><span class="lineCounter-0-0-4 -codedoc-line-counter">7<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span>$</span><span>new</span> <span>=</span> <span>Get-Content</span> <span>$</span><span>tempPath</span> <span>-raw</span> <span>|</span> <span>ForEach</span><span>-Object</span> <span>{</span> <span>$</span><span>_</span> <span>-replace</span> <span>"</span><span>`r</span><span>"</span><span>,</span> <span>""</span> <span>}</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="    <span>$</span><span>new</span> <span>|</span> <span>Set-Content</span> <span>-NoNewline</span> <span>$</span><span>tempPath</span>" id="code1-l8"><span class="lineCounter-0-0-4 -codedoc-line-counter">8<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span>$</span><span>new</span> <span>|</span> <span>Set-Content</span> <span>-NoNewline</span> <span>$</span><span>tempPath</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="    <span>Export-PSGraph</span> <span>-Source</span> <span>$</span><span>tempPath</span> <span>-ShowGraph</span> <span>-LayoutEngine</span> <span>$</span><span>LayoutEngine</span>" id="code1-l9"><span class="lineCounter-0-0-4 -codedoc-line-counter">9<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span>Export-PSGraph</span> <span>-Source</span> <span>$</span><span>tempPath</span> <span>-ShowGraph</span> <span>-LayoutEngine</span> <span>$</span><span>LayoutEngine</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="    <span>Invoke-Item</span> <span>($</span><span>tempPath</span> <span>+</span> <span>'.png'</span><span>)</span>" id="code1-l10"><span class="lineCounter-0-0-4 prim -codedoc-line-counter">10<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span>Invoke-Item</span> <span>($</span><span>tempPath</span> <span>+</span> <span>'.png'</span><span>)</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="    <span>Remove-Item</span> <span>$</span><span>tempPath</span>" id="code1-l11"><span class="lineCounter-0-0-4 -codedoc-line-counter">11<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span>Remove-Item</span> <span>$</span><span>tempPath</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="<span>}</span>" id="code1-l12"><span class="lineCounter-0-0-4 -codedoc-line-counter">12<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span>}</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="" id="code1-l13"><span class="lineCounter-0-0-4 -codedoc-line-counter">13<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="<span>function</span> <span>New-Edge</span> <span>($</span><span>From</span><span>,</span> <span>$</span><span>To</span><span>,</span> <span>$</span><span>Attributes</span><span>,</span> <span>[switch]</span><span>$</span><span>AsObject</span><span>,</span> <span>[switch]</span><span>$</span><span>Undirected</span><span>)</span> <span>{</span>" id="code1-l14"><span class="lineCounter-0-0-4 -codedoc-line-counter">14<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span>function</span> <span>New-Edge</span> <span>($</span><span>From</span><span>,</span> <span>$</span><span>To</span><span>,</span> <span>$</span><span>Attributes</span><span>,</span> <span>[switch]</span><span>$</span><span>AsObject</span><span>,</span> <span>[switch]</span><span>$</span><span>Undirected</span><span>)</span> <span>{</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="    <span>$</span><span>null</span> <span>=</span> <span>$</span><span>PSBoundParameters</span><span>.</span><span>Remove</span><span>(</span><span>'AsObject'</span><span>)</span>" id="code1-l15"><span class="lineCounter-0-0-4 prim -codedoc-line-counter">15<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span>$</span><span>null</span> <span>=</span> <span>$</span><span>PSBoundParameters</span><span>.</span><span>Remove</span><span>(</span><span>'AsObject'</span><span>)</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="    <span>$</span><span>ht</span> <span>=</span> <span>[Hashtable]</span><span>$</span><span>PSBoundParameters</span>" id="code1-l16"><span class="lineCounter-0-0-4 -codedoc-line-counter">16<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span>$</span><span>ht</span> <span>=</span> <span>[Hashtable]</span><span>$</span><span>PSBoundParameters</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="    <span>if</span> <span>($</span><span>AsObject</span><span>)</span> <span>{</span>" id="code1-l17"><span class="lineCounter-0-0-4 -codedoc-line-counter">17<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span>if</span> <span>($</span><span>AsObject</span><span>)</span> <span>{</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="        <span>return</span> <span>[PSCustomObject]</span><span>$</span><span>ht</span>" id="code1-l18"><span class="lineCounter-0-0-4 -codedoc-line-counter">18<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>        <span>return</span> <span>[PSCustomObject]</span><span>$</span><span>ht</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="    <span>}</span>" id="code1-l19"><span class="lineCounter-0-0-4 -codedoc-line-counter">19<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span>}</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="    <span>return</span> <span>$</span><span>ht</span>" id="code1-l20"><span class="lineCounter-0-0-4 prim -codedoc-line-counter">20<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span>return</span> <span>$</span><span>ht</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="<span>}</span>" id="code1-l21"><span class="lineCounter-0-0-4 -codedoc-line-counter">21<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span>}</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="" id="code1-l22"><span class="lineCounter-0-0-4 -codedoc-line-counter">22<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="<span>function</span> <span>Get-Neighbours</span> <span>($</span><span>Edges</span><span>,</span> <span>$</span><span>Name</span><span>,</span> <span>[switch]</span><span>$</span><span>Undirected</span><span>)</span> <span>{</span>" id="code1-l23"><span class="lineCounter-0-0-4 -codedoc-line-counter">23<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span>function</span> <span>Get-Neighbours</span> <span>($</span><span>Edges</span><span>,</span> <span>$</span><span>Name</span><span>,</span> <span>[switch]</span><span>$</span><span>Undirected</span><span>)</span> <span>{</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="    <span>$</span><span>edgeObjects</span> <span>=</span> <span>@($</span><span>Edges</span><span>)</span>" id="code1-l24"><span class="lineCounter-0-0-4 -codedoc-line-counter">24<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span>$</span><span>edgeObjects</span> <span>=</span> <span>@($</span><span>Edges</span><span>)</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="    <span>if</span> <span>(@($</span><span>Edges</span><span>)[</span><span>0</span><span>].</span><span>GetType</span><span>().</span><span>FullName</span> <span>-ne</span> <span>'System.Management.Automation.PSCustomObject'</span><span>)</span> <span>{</span>" id="code1-l25"><span class="lineCounter-0-0-4 prim -codedoc-line-counter">25<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span>if</span> <span>(@($</span><span>Edges</span><span>)[</span><span>0</span><span>].</span><span>GetType</span><span>().</span><span>FullName</span> <span>-ne</span> <span>'System.Management.Automation.PSCustomObject'</span><span>)</span> <span>{</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="        <span>$</span><span>edgeObjects</span> <span>=</span> <span>foreach</span> <span>($</span><span>edge</span> <span>in</span> <span>$</span><span>Edges</span><span>)</span> <span>{</span>" id="code1-l26"><span class="lineCounter-0-0-4 -codedoc-line-counter">26<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>        <span>$</span><span>edgeObjects</span> <span>=</span> <span>foreach</span> <span>($</span><span>edge</span> <span>in</span> <span>$</span><span>Edges</span><span>)</span> <span>{</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="            <span>[PSCustomObject]</span><span>$</span><span>edge</span>" id="code1-l27"><span class="lineCounter-0-0-4 -codedoc-line-counter">27<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>            <span>[PSCustomObject]</span><span>$</span><span>edge</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="        <span>}</span>" id="code1-l28"><span class="lineCounter-0-0-4 -codedoc-line-counter">28<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>        <span>}</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="    <span>}</span>" id="code1-l29"><span class="lineCounter-0-0-4 -codedoc-line-counter">29<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span>}</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="    <span>(&amp;amp;</span> <span>{</span>" id="code1-l30"><span class="lineCounter-0-0-4 prim -codedoc-line-counter">30<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span>(&amp;</span> <span>{</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="            <span>($</span><span>edgeObjects</span><span>.</span><span>where</span><span>{</span> <span>$</span><span>_</span><span>.</span><span>From</span> <span>-eq</span> <span>$</span><span>Name</span> <span>}).</span><span>To</span>" id="code1-l31"><span class="lineCounter-0-0-4 -codedoc-line-counter">31<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>            <span>($</span><span>edgeObjects</span><span>.</span><span>where</span><span>{</span> <span>$</span><span>_</span><span>.</span><span>From</span> <span>-eq</span> <span>$</span><span>Name</span> <span>}).</span><span>To</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="            <span>if</span> <span>($</span><span>Undirected</span><span>)</span> <span>{</span>" id="code1-l32"><span class="lineCounter-0-0-4 -codedoc-line-counter">32<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>            <span>if</span> <span>($</span><span>Undirected</span><span>)</span> <span>{</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="                <span>($</span><span>edgeObjects</span><span>.</span><span>where</span><span>{</span> <span>$</span><span>_</span><span>.</span><span>To</span> <span>-eq</span> <span>$</span><span>Name</span> <span>}).</span><span>From</span>" id="code1-l33"><span class="lineCounter-0-0-4 -codedoc-line-counter">33<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>                <span>($</span><span>edgeObjects</span><span>.</span><span>where</span><span>{</span> <span>$</span><span>_</span><span>.</span><span>To</span> <span>-eq</span> <span>$</span><span>Name</span> <span>}).</span><span>From</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="            <span>}</span>" id="code1-l34"><span class="lineCounter-0-0-4 -codedoc-line-counter">34<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>            <span>}</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="        <span>}).</span><span>where</span><span>{</span> <span>!</span><span>[String]</span><span>::</span><span>IsNullOrEmpty</span><span>($</span><span>_</span><span>)</span> <span>}</span>" id="code1-l35"><span class="lineCounter-0-0-4 prim -codedoc-line-counter">35<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>        <span>}).</span><span>where</span><span>{</span> <span>!</span><span>[String]</span><span>::</span><span>IsNullOrEmpty</span><span>($</span><span>_</span><span>)</span> <span>}</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="<span>}</span>" id="code1-l36"><span class="lineCounter-0-0-4 -codedoc-line-counter">36<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span>}</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="" id="code1-l37"><span class="lineCounter-0-0-4 -codedoc-line-counter">37<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="<span>function</span> <span>Get-LogSpace</span><span>(</span><span>[Double]</span><span>$</span><span>Minimum</span><span>,</span> <span>[Double]</span><span>$</span><span>Maximum</span><span>,</span> <span>$</span><span>Count</span><span>)</span> <span>{</span>" id="code1-l38"><span class="lineCounter-0-0-4 -codedoc-line-counter">38<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span>function</span> <span>Get-LogSpace</span><span>(</span><span>[Double]</span><span>$</span><span>Minimum</span><span>,</span> <span>[Double]</span><span>$</span><span>Maximum</span><span>,</span> <span>$</span><span>Count</span><span>)</span> <span>{</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="    <span>$</span><span>increment</span> <span>=</span> <span>($</span><span>Maximum</span> <span>-</span> <span>$</span><span>Minimum</span><span>)</span> <span>/</span> <span>($</span><span>Count</span> <span>-</span> <span>1</span><span>)</span>" id="code1-l39"><span class="lineCounter-0-0-4 -codedoc-line-counter">39<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span>$</span><span>increment</span> <span>=</span> <span>($</span><span>Maximum</span> <span>-</span> <span>$</span><span>Minimum</span><span>)</span> <span>/</span> <span>($</span><span>Count</span> <span>-</span> <span>1</span><span>)</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="    <span>for</span> <span>(</span> <span>$</span><span>i</span> <span>=</span> <span>0</span><span>;</span> <span>$</span><span>i</span> <span>-lt</span> <span>$</span><span>Count</span><span>;</span> <span>$</span><span>i</span><span>++</span> <span>)</span> <span>{</span>" id="code1-l40"><span class="lineCounter-0-0-4 prim -codedoc-line-counter">40<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span>for</span> <span>(</span> <span>$</span><span>i</span> <span>=</span> <span>0</span><span>;</span> <span>$</span><span>i</span> <span>-lt</span> <span>$</span><span>Count</span><span>;</span> <span>$</span><span>i</span><span>++</span> <span>)</span> <span>{</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="        <span>[Math]</span><span>::</span><span>Pow</span><span>(</span> <span>10</span><span>,</span> <span>($</span><span>Minimum</span> <span>+</span> <span>$</span><span>increment</span> <span>*</span> <span>$</span><span>i</span><span>))</span>" id="code1-l41"><span class="lineCounter-0-0-4 -codedoc-line-counter">41<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>        <span>[Math]</span><span>::</span><span>Pow</span><span>(</span> <span>10</span><span>,</span> <span>($</span><span>Minimum</span> <span>+</span> <span>$</span><span>increment</span> <span>*</span> <span>$</span><span>i</span><span>))</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="    <span>}</span>" id="code1-l42"><span class="lineCounter-0-0-4 -codedoc-line-counter">42<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span>}</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="<span>}</span>" id="code1-l43"><span class="lineCounter-0-0-4 prim -codedoc-line-counter">43<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span>}</span></div><br></code></pre><p>We create a helper function to generate a Ring-Lattice graph.</p><pre class="with-bar"><code class="undefined -codedoc-code-snippet code-0-0-3" tabindex="0"><span class="wmbar-0-0-8"><span></span><span></span><span></span><span></span></span><div class="line-0-0-7  -codedoc-code-line" data-content="<span></span><span>function</span> <span>Get-RingLattice</span><span>($</span><span>Nodes</span><span>,</span> <span>$</span><span>NumConnections</span><span>){</span>" id="code2-l1"><span class="lineCounter-0-0-4 prim -codedoc-line-counter">1<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span></span><span>function</span> <span>Get-RingLattice</span><span>($</span><span>Nodes</span><span>,</span> <span>$</span><span>NumConnections</span><span>){</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="    <span>$</span><span>ht</span> <span>=</span> <span>[ordered]</span><span>@{}</span>" id="code2-l2"><span class="lineCounter-0-0-4 -codedoc-line-counter">2<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span>$</span><span>ht</span> <span>=</span> <span>[ordered]</span><span>@{}</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="    <span>$</span><span>ht</span><span>.</span><span>Nodes</span> <span>=</span> <span>$</span><span>Nodes</span>" id="code2-l3"><span class="lineCounter-0-0-4 -codedoc-line-counter">3<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span>$</span><span>ht</span><span>.</span><span>Nodes</span> <span>=</span> <span>$</span><span>Nodes</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="    <span>$</span><span>cons</span> <span>=</span> <span>[int]</span><span>($</span><span>NumConnections</span><span>/</span><span>2</span><span>)</span>" id="code2-l4"><span class="lineCounter-0-0-4 -codedoc-line-counter">4<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span>$</span><span>cons</span> <span>=</span> <span>[int]</span><span>($</span><span>NumConnections</span><span>/</span><span>2</span><span>)</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="    <span>$</span><span>len</span> <span>=</span> <span>$</span><span>Nodes</span><span>.</span><span>Count</span>" id="code2-l5"><span class="lineCounter-0-0-4 prim -codedoc-line-counter">5<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span>$</span><span>len</span> <span>=</span> <span>$</span><span>Nodes</span><span>.</span><span>Count</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="    <span>$</span><span>ht</span><span>.</span><span>Edges</span> <span>=</span> <span>foreach</span> <span>($</span><span>node</span> <span>in</span> <span>$</span><span>Nodes</span><span>){</span>" id="code2-l6"><span class="lineCounter-0-0-4 -codedoc-line-counter">6<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span>$</span><span>ht</span><span>.</span><span>Edges</span> <span>=</span> <span>foreach</span> <span>($</span><span>node</span> <span>in</span> <span>$</span><span>Nodes</span><span>){</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="        <span>for</span> <span>($</span><span>i</span><span>=$</span><span>node</span><span>+</span><span>1</span><span>;$</span><span>i</span> <span>-le</span> <span>($</span><span>node</span><span>+$</span><span>cons</span><span>);$</span><span>i</span><span>++){</span>" id="code2-l7"><span class="lineCounter-0-0-4 -codedoc-line-counter">7<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>        <span>for</span> <span>($</span><span>i</span><span>=$</span><span>node</span><span>+</span><span>1</span><span>;$</span><span>i</span> <span>-le</span> <span>($</span><span>node</span><span>+$</span><span>cons</span><span>);$</span><span>i</span><span>++){</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="            <span>New-Edge</span> <span>$</span><span>node</span> <span>$</span><span>Nodes</span><span>[($</span><span>i</span> <span>%</span> <span>$</span><span>len</span><span>)]</span> <span>-AsObject</span>" id="code2-l8"><span class="lineCounter-0-0-4 -codedoc-line-counter">8<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>            <span>New-Edge</span> <span>$</span><span>node</span> <span>$</span><span>Nodes</span><span>[($</span><span>i</span> <span>%</span> <span>$</span><span>len</span><span>)]</span> <span>-AsObject</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="        <span>}</span>" id="code2-l9"><span class="lineCounter-0-0-4 -codedoc-line-counter">9<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>        <span>}</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="    <span>}</span>" id="code2-l10"><span class="lineCounter-0-0-4 prim -codedoc-line-counter">10<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span>}</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="    <span>$</span><span>ht</span><span>.</span><span>Visual</span> <span>=</span> <span>graph</span> <span>{</span>" id="code2-l11"><span class="lineCounter-0-0-4 -codedoc-line-counter">11<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span>$</span><span>ht</span><span>.</span><span>Visual</span> <span>=</span> <span>graph</span> <span>{</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="        <span>inline</span> <span>'edge [arrowsize=0]'</span>" id="code2-l12"><span class="lineCounter-0-0-4 -codedoc-line-counter">12<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>        <span>inline</span> <span>'edge [arrowsize=0]'</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="        <span>edge</span> <span>$</span><span>ht</span><span>.</span><span>Edges</span> <span>-FromScript</span> <span>{</span> <span>$</span><span>_</span><span>.</span><span>To</span> <span>}</span> <span>-ToScript</span> <span>{</span> <span>$</span><span>_</span><span>.</span><span>From</span> <span>}</span>" id="code2-l13"><span class="lineCounter-0-0-4 -codedoc-line-counter">13<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>        <span>edge</span> <span>$</span><span>ht</span><span>.</span><span>Edges</span> <span>-FromScript</span> <span>{</span> <span>$</span><span>_</span><span>.</span><span>To</span> <span>}</span> <span>-ToScript</span> <span>{</span> <span>$</span><span>_</span><span>.</span><span>From</span> <span>}</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="    <span>}</span>" id="code2-l14"><span class="lineCounter-0-0-4 -codedoc-line-counter">14<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span>}</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="    <span>[PSCustomObject]</span><span>$</span><span>ht</span>" id="code2-l15"><span class="lineCounter-0-0-4 prim -codedoc-line-counter">15<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span>[PSCustomObject]</span><span>$</span><span>ht</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="<span>}</span>" id="code2-l16"><span class="lineCounter-0-0-4 prim -codedoc-line-counter">16<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span>}</span></div><br></code></pre><p>Let’s create a Ring-Lattice graph with 10 nodes and 4 connections per node.</p><pre class="with-bar"><code class="undefined -codedoc-code-snippet code-0-0-3" tabindex="0"><span class="wmbar-0-0-8"><span></span><span></span><span></span><span></span></span><div class="line-0-0-7  -codedoc-code-line" data-content="<span></span><span>$</span><span>ringLattice</span> <span>=</span> <span>Get-RingLattice</span> <span>(</span><span>0</span><span>..</span><span>9</span><span>)</span> <span>4</span>" id="code3-l1"><span class="lineCounter-0-0-4 prim -codedoc-line-counter">1<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span></span><span>$</span><span>ringLattice</span> <span>=</span> <span>Get-RingLattice</span> <span>(</span><span>0</span><span>..</span><span>9</span><span>)</span> <span>4</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="<span>$</span><span>ringLattice</span><span>.</span><span>Visual</span> <span>|</span> <span>Show-PSGraph</span>" id="code3-l2"><span class="lineCounter-0-0-4 prim -codedoc-line-counter">2<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span>$</span><span>ringLattice</span><span>.</span><span>Visual</span> <span>|</span> <span>Show-PSGraph</span></div><br></code></pre><p><img src="https://powershellone.wordpress.com/wp-content/uploads/2021/03/img0-2.png" alt="image.png"></p><h2 id="small-world-graphs-watts-strogatz" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>Small-World Graphs (Watts-Strogatz)<a href="https://powershellone.wordpress.com/2021/03/23/graph-theory-with-powershell-part-2/#Small-World-Graphs-(Watts-Strogatz)-"></a></h2><p>To turn our Ring-Lattice graph into a small-world graph we need to “re-wire” the nodes. The algorithm for the re-wiring should follow this logic:</p><ul><li>Iterate over all edges and rewire them based on a specified probability.</li><li>If an edge is chosen to be rewired<ul><li>Leave the .From part of the edge as is.</li><li>Rewire the .To part of the edge to any random node, but…<ul><li>The current .From and To. nodes</li><li>Any neighbours of the .From node</li></ul></li><li>Replace the current edge with the old .From and the new .To pair</li></ul></li></ul><p>We can re-use the <code>Get-Neighbours</code> function from my previous post.</p><pre class="with-bar"><code class="undefined -codedoc-code-snippet code-0-0-3" tabindex="0"><span class="wmbar-0-0-8"><span></span><span></span><span></span><span></span></span><div class="line-0-0-7  -codedoc-code-line" data-content="<span></span><span>function</span> <span>Get-SmallWorldGraph</span><span>($</span><span>Nodes</span><span>,</span> <span>$</span><span>NumConnections</span><span>,</span> <span>$</span><span>Probability</span><span>){</span>" id="code4-l1"><span class="lineCounter-0-0-4 prim -codedoc-line-counter">1<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span></span><span>function</span> <span>Get-SmallWorldGraph</span><span>($</span><span>Nodes</span><span>,</span> <span>$</span><span>NumConnections</span><span>,</span> <span>$</span><span>Probability</span><span>){</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="    <span>$</span><span>graph</span> <span>=</span> <span>Get-RingLattice</span> <span>$</span><span>Nodes</span> <span>$</span><span>NumConnections</span>" id="code4-l2"><span class="lineCounter-0-0-4 -codedoc-line-counter">2<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span>$</span><span>graph</span> <span>=</span> <span>Get-RingLattice</span> <span>$</span><span>Nodes</span> <span>$</span><span>NumConnections</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="    <span>$</span><span>edges</span> <span>=</span> <span>$</span><span>graph</span><span>.</span><span>Edges</span><span>.</span><span>Clone</span><span>()</span>" id="code4-l3"><span class="lineCounter-0-0-4 -codedoc-line-counter">3<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span>$</span><span>edges</span> <span>=</span> <span>$</span><span>graph</span><span>.</span><span>Edges</span><span>.</span><span>Clone</span><span>()</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="    <span>foreach</span> <span>($</span><span>edge</span> <span>in</span> <span>$</span><span>graph</span><span>.</span><span>Edges</span><span>){</span>" id="code4-l4"><span class="lineCounter-0-0-4 -codedoc-line-counter">4<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span>foreach</span> <span>($</span><span>edge</span> <span>in</span> <span>$</span><span>graph</span><span>.</span><span>Edges</span><span>){</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="        <span>$</span><span>rand</span> <span>=</span> <span>(</span><span>Get-Random</span> <span>-Minimum</span> <span>0</span> <span>-Maximum</span> <span>10000</span><span>)</span> <span>/</span> <span>10000</span>" id="code4-l5"><span class="lineCounter-0-0-4 prim -codedoc-line-counter">5<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>        <span>$</span><span>rand</span> <span>=</span> <span>(</span><span>Get-Random</span> <span>-Minimum</span> <span>0</span> <span>-Maximum</span> <span>10000</span><span>)</span> <span>/</span> <span>10000</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="        <span>if</span> <span>($</span><span>rand</span> <span>-le</span> <span>$</span><span>Probability</span><span>)</span> <span>{</span>" id="code4-l6"><span class="lineCounter-0-0-4 -codedoc-line-counter">6<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>        <span>if</span> <span>($</span><span>rand</span> <span>-le</span> <span>$</span><span>Probability</span><span>)</span> <span>{</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="            <span>$</span><span>fromNeighbours</span> <span>=</span> <span>Get-Neighbours</span> <span>$</span><span>graph</span><span>.</span><span>Edges</span> <span>$</span><span>edge</span><span>.</span><span>From</span> <span>-Undirected</span>" id="code4-l7"><span class="lineCounter-0-0-4 -codedoc-line-counter">7<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>            <span>$</span><span>fromNeighbours</span> <span>=</span> <span>Get-Neighbours</span> <span>$</span><span>graph</span><span>.</span><span>Edges</span> <span>$</span><span>edge</span><span>.</span><span>From</span> <span>-Undirected</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="            <span>#need to use foreach construct to expand nexted array of fromNeighbours</span>" id="code4-l8"><span class="lineCounter-0-0-4 -codedoc-line-counter">8<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>            <span>#need to use foreach construct to expand nexted array of fromNeighbours</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="            <span>$</span><span>exclude</span> <span>=</span> <span>$</span><span>edge</span><span>.</span><span>From</span><span>,$</span><span>edge</span><span>.</span><span>To</span><span>,($</span><span>fromNeighbours</span><span>.</span><span>foreach</span><span>{$</span><span>_</span><span>})</span>" id="code4-l9"><span class="lineCounter-0-0-4 -codedoc-line-counter">9<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>            <span>$</span><span>exclude</span> <span>=</span> <span>$</span><span>edge</span><span>.</span><span>From</span><span>,$</span><span>edge</span><span>.</span><span>To</span><span>,($</span><span>fromNeighbours</span><span>.</span><span>foreach</span><span>{$</span><span>_</span><span>})</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="            <span>$</span><span>toConnect</span> <span>=</span> <span>$</span><span>graph</span><span>.</span><span>Nodes</span><span>.</span><span>where</span><span>{$</span><span>_</span> <span>-notin</span> <span>($</span><span>exclude</span><span>.</span><span>foreach</span><span>{$</span><span>_</span><span>})}</span>" id="code4-l10"><span class="lineCounter-0-0-4 prim -codedoc-line-counter">10<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>            <span>$</span><span>toConnect</span> <span>=</span> <span>$</span><span>graph</span><span>.</span><span>Nodes</span><span>.</span><span>where</span><span>{$</span><span>_</span> <span>-notin</span> <span>($</span><span>exclude</span><span>.</span><span>foreach</span><span>{$</span><span>_</span><span>})}</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="            <span>#remove the current edge</span>" id="code4-l11"><span class="lineCounter-0-0-4 -codedoc-line-counter">11<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>            <span>#remove the current edge</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="            <span>#see https://en.wikipedia.org/wiki/De_Morgan%27s_laws</span>" id="code4-l12"><span class="lineCounter-0-0-4 -codedoc-line-counter">12<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>            <span>#see https://en.wikipedia.org/wiki/De_Morgan%27s_laws</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="            <span>$</span><span>graph</span><span>.</span><span>Edges</span> <span>=</span> <span>$</span><span>graph</span><span>.</span><span>Edges</span><span>.</span><span>where</span><span>{$</span><span>_</span><span>.</span><span>From</span> <span>-ne</span> <span>$</span><span>edge</span><span>.</span><span>From</span> <span>-or</span> <span>$</span><span>_</span><span>.</span><span>To</span> <span>-ne</span> <span>$</span><span>edge</span><span>.</span><span>To</span><span>}</span>" id="code4-l13"><span class="lineCounter-0-0-4 -codedoc-line-counter">13<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>            <span>$</span><span>graph</span><span>.</span><span>Edges</span> <span>=</span> <span>$</span><span>graph</span><span>.</span><span>Edges</span><span>.</span><span>where</span><span>{$</span><span>_</span><span>.</span><span>From</span> <span>-ne</span> <span>$</span><span>edge</span><span>.</span><span>From</span> <span>-or</span> <span>$</span><span>_</span><span>.</span><span>To</span> <span>-ne</span> <span>$</span><span>edge</span><span>.</span><span>To</span><span>}</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="            <span>#add the new edge += for &quot;adding to an array is bad but good enough in this case</span>" id="code4-l14"><span class="lineCounter-0-0-4 -codedoc-line-counter">14<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>            <span>#add the new edge += for "adding to an array is bad but good enough in this case</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="            <span>$</span><span>graph</span><span>.</span><span>Edges</span> <span>+=</span> <span>New-Edge</span> <span>$</span><span>edge</span><span>.</span><span>From</span> <span>(</span><span>Get-Random</span> <span>-InputObject</span> <span>$</span><span>toConnect</span><span>)</span> <span>-AsObject</span>" id="code4-l15"><span class="lineCounter-0-0-4 prim -codedoc-line-counter">15<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>            <span>$</span><span>graph</span><span>.</span><span>Edges</span> <span>+=</span> <span>New-Edge</span> <span>$</span><span>edge</span><span>.</span><span>From</span> <span>(</span><span>Get-Random</span> <span>-InputObject</span> <span>$</span><span>toConnect</span><span>)</span> <span>-AsObject</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="        <span>}</span>" id="code4-l16"><span class="lineCounter-0-0-4 -codedoc-line-counter">16<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>        <span>}</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="    <span>}</span>" id="code4-l17"><span class="lineCounter-0-0-4 -codedoc-line-counter">17<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span>}</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="    <span>#redo the visual part based on the new edges</span>" id="code4-l18"><span class="lineCounter-0-0-4 -codedoc-line-counter">18<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span>#redo the visual part based on the new edges</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="    <span>$</span><span>graph</span><span>.</span><span>Visual</span> <span>=</span> <span>graph</span> <span>{</span>" id="code4-l19"><span class="lineCounter-0-0-4 -codedoc-line-counter">19<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span>$</span><span>graph</span><span>.</span><span>Visual</span> <span>=</span> <span>graph</span> <span>{</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="        <span>inline</span> <span>'edge [arrowsize=0]'</span>" id="code4-l20"><span class="lineCounter-0-0-4 prim -codedoc-line-counter">20<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>        <span>inline</span> <span>'edge [arrowsize=0]'</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="        <span>edge</span> <span>$</span><span>graph</span><span>.</span><span>Edges</span> <span>-FromScript</span> <span>{</span> <span>$</span><span>_</span><span>.</span><span>To</span> <span>}</span> <span>-ToScript</span> <span>{</span> <span>$</span><span>_</span><span>.</span><span>From</span> <span>}</span>" id="code4-l21"><span class="lineCounter-0-0-4 -codedoc-line-counter">21<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>        <span>edge</span> <span>$</span><span>graph</span><span>.</span><span>Edges</span> <span>-FromScript</span> <span>{</span> <span>$</span><span>_</span><span>.</span><span>To</span> <span>}</span> <span>-ToScript</span> <span>{</span> <span>$</span><span>_</span><span>.</span><span>From</span> <span>}</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="    <span>}</span>" id="code4-l22"><span class="lineCounter-0-0-4 -codedoc-line-counter">22<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span>}</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="    <span>$</span><span>graph</span>" id="code4-l23"><span class="lineCounter-0-0-4 -codedoc-line-counter">23<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span>$</span><span>graph</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="<span>}</span>" id="code4-l24"><span class="lineCounter-0-0-4 prim -codedoc-line-counter">24<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span>}</span></div><br></code></pre><p>Below are three Small World graphs with the following properties:</p><ul><li>20 nodes</li><li>4 connections per node</li><li>Probabilities of 10%, 30%, and 80%</li></ul><pre class="with-bar"><code class="undefined -codedoc-code-snippet code-0-0-3" tabindex="0"><span class="wmbar-0-0-8"><span></span><span></span><span></span><span></span></span><div class="line-0-0-7  -codedoc-code-line" data-content="<span></span><span>foreach</span> <span>($</span><span>prob</span> <span>in</span> <span>(.</span><span>1</span><span>,.</span><span>2</span><span>,.</span><span>8</span><span>)){</span>" id="code5-l1"><span class="lineCounter-0-0-4 prim -codedoc-line-counter">1<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span></span><span>foreach</span> <span>($</span><span>prob</span> <span>in</span> <span>(.</span><span>1</span><span>,.</span><span>2</span><span>,.</span><span>8</span><span>)){</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="    <span>$</span><span>swGraph</span> <span>=</span> <span>Get-SmallWorldGraph</span> <span>(</span><span>0</span><span>..</span><span>19</span><span>)</span> <span>4</span> <span>$</span><span>prob</span>" id="code5-l2"><span class="lineCounter-0-0-4 -codedoc-line-counter">2<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span>$</span><span>swGraph</span> <span>=</span> <span>Get-SmallWorldGraph</span> <span>(</span><span>0</span><span>..</span><span>19</span><span>)</span> <span>4</span> <span>$</span><span>prob</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="    <span>$</span><span>swGraph</span><span>.</span><span>Visual</span> <span>|</span> <span>Show-PSGraph</span>" id="code5-l3"><span class="lineCounter-0-0-4 -codedoc-line-counter">3<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span>$</span><span>swGraph</span><span>.</span><span>Visual</span> <span>|</span> <span>Show-PSGraph</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="<span>}</span>" id="code5-l4"><span class="lineCounter-0-0-4 prim -codedoc-line-counter">4<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span>}</span></div><br></code></pre><p><img src="https://powershellone.wordpress.com/wp-content/uploads/2021/03/img1.png" alt="image.png"></p><p>As a next step, we need to develop methods that help us to evaluate the clustering and path-length properties of the produced graphs.</p><h3 id="clustering-coefficient" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>Clustering Coefficient<a href="https://powershellone.wordpress.com/2021/03/23/graph-theory-with-powershell-part-2/#Clustering-Coefficient-"></a></h3><p>A cluster can be defined as a set of nodes with edges between all pairs of nodes in the set. The clustering coefficient for a node is given by the proportion of actual links between the nodes within its neighbourhood divided by the number of links that could possibly exist between them. If we iterate over every node of a graph and calculate this proportion and take the average of those, we are getting the <code>Clustering coefficient</code> for the graph. The number of unique connections between a set of n nodes can be calculated with the formula <img src="https://s0.wp.com/latex.php?latex=%5Cfrac%7Bn%28n-1%29%7D%7B2%7D+&amp;bg=ffffff&amp;fg=000000&amp;s=0&amp;c=20201002" alt="\frac{n(n-1)}{2} "> If you imagine a room with n people, where you want to determine the number of unique pairs:</p><ul><li>The first person can pair up with everyone except themselves n-1..</li><li>…so can everyone else n*(n-1).</li><li>Since n represents the number of people rather than pairs the result needs to be divided by 2 n(n-1)/2.</li></ul><p>Below is the implementation of the clustering coefficient algorithm.</p><pre class="with-bar"><code class="undefined -codedoc-code-snippet code-0-0-3" tabindex="0"><span class="wmbar-0-0-8"><span></span><span></span><span></span><span></span></span><div class="line-0-0-7  -codedoc-code-line" data-content="<span></span><span>function</span> <span>Get-ClusteringCoefficient</span> <span>($</span><span>Graph</span><span>){</span>" id="code6-l1"><span class="lineCounter-0-0-4 prim -codedoc-line-counter">1<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span></span><span>function</span> <span>Get-ClusteringCoefficient</span> <span>($</span><span>Graph</span><span>){</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="    <span>$</span><span>individualCEs</span> <span>=</span> <span>foreach</span> <span>($</span><span>node</span> <span>in</span> <span>$</span><span>Graph</span><span>.</span><span>Nodes</span><span>){</span>" id="code6-l2"><span class="lineCounter-0-0-4 -codedoc-line-counter">2<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span>$</span><span>individualCEs</span> <span>=</span> <span>foreach</span> <span>($</span><span>node</span> <span>in</span> <span>$</span><span>Graph</span><span>.</span><span>Nodes</span><span>){</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="        <span>$</span><span>neighbours</span> <span>=</span> <span>Get-Neighbours</span> <span>$</span><span>Graph</span><span>.</span><span>Edges</span> <span>$</span><span>node</span> <span>-Undirected</span>" id="code6-l3"><span class="lineCounter-0-0-4 -codedoc-line-counter">3<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>        <span>$</span><span>neighbours</span> <span>=</span> <span>Get-Neighbours</span> <span>$</span><span>Graph</span><span>.</span><span>Edges</span> <span>$</span><span>node</span> <span>-Undirected</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="        <span>$</span><span>numNeighbours</span> <span>=</span> <span>$</span><span>neighbours</span><span>.</span><span>Count</span>" id="code6-l4"><span class="lineCounter-0-0-4 -codedoc-line-counter">4<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>        <span>$</span><span>numNeighbours</span> <span>=</span> <span>$</span><span>neighbours</span><span>.</span><span>Count</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="        <span>#CE undefined skip to next node</span>" id="code6-l5"><span class="lineCounter-0-0-4 prim -codedoc-line-counter">5<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>        <span>#CE undefined skip to next node</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="        <span>if</span> <span>($</span><span>numNeighbours</span> <span>-lt</span> <span>2</span><span>)</span> <span>{</span> " id="code6-l6"><span class="lineCounter-0-0-4 -codedoc-line-counter">6<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>        <span>if</span> <span>($</span><span>numNeighbours</span> <span>-lt</span> <span>2</span><span>)</span> <span>{</span> </div><br><div class="line-0-0-7  -codedoc-code-line" data-content="            <span>[Single]</span><span>::</span><span>NaN</span> " id="code6-l7"><span class="lineCounter-0-0-4 -codedoc-line-counter">7<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>            <span>[Single]</span><span>::</span><span>NaN</span> </div><br><div class="line-0-0-7  -codedoc-code-line" data-content="            <span>continue</span>" id="code6-l8"><span class="lineCounter-0-0-4 -codedoc-line-counter">8<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>            <span>continue</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="        <span>}</span>" id="code6-l9"><span class="lineCounter-0-0-4 -codedoc-line-counter">9<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>        <span>}</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="        <span>$</span><span>possibleConnections</span> <span>=</span> <span>$</span><span>numNeighbours</span> <span>*</span> <span>($</span><span>numNeighbours</span> <span>-</span><span>1</span><span>)</span> <span>/</span> <span>2</span>" id="code6-l10"><span class="lineCounter-0-0-4 prim -codedoc-line-counter">10<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>        <span>$</span><span>possibleConnections</span> <span>=</span> <span>$</span><span>numNeighbours</span> <span>*</span> <span>($</span><span>numNeighbours</span> <span>-</span><span>1</span><span>)</span> <span>/</span> <span>2</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="        <span>$</span><span>nodes</span> <span>=</span> <span>$</span><span>Graph</span><span>.</span><span>Nodes</span>" id="code6-l11"><span class="lineCounter-0-0-4 -codedoc-line-counter">11<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>        <span>$</span><span>nodes</span> <span>=</span> <span>$</span><span>Graph</span><span>.</span><span>Nodes</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="        <span>$</span><span>actualConnections</span> <span>=</span> <span>for</span> <span>($</span><span>i</span> <span>=</span> <span>0</span><span>;</span> <span>$</span><span>i</span> <span>-lt</span> <span>$</span><span>numNeighBours</span><span>;</span> <span>$</span><span>i</span><span>++)</span> <span>{</span>" id="code6-l12"><span class="lineCounter-0-0-4 -codedoc-line-counter">12<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>        <span>$</span><span>actualConnections</span> <span>=</span> <span>for</span> <span>($</span><span>i</span> <span>=</span> <span>0</span><span>;</span> <span>$</span><span>i</span> <span>-lt</span> <span>$</span><span>numNeighBours</span><span>;</span> <span>$</span><span>i</span><span>++)</span> <span>{</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="            <span>for</span> <span>($</span><span>j</span> <span>=</span> <span>0</span><span>;</span> <span>$</span><span>j</span> <span>-lt</span> <span>$</span><span>neighbours</span><span>.</span><span>Count</span><span>;</span> <span>$</span><span>j</span><span>++)</span> <span>{</span>" id="code6-l13"><span class="lineCounter-0-0-4 -codedoc-line-counter">13<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>            <span>for</span> <span>($</span><span>j</span> <span>=</span> <span>0</span><span>;</span> <span>$</span><span>j</span> <span>-lt</span> <span>$</span><span>neighbours</span><span>.</span><span>Count</span><span>;</span> <span>$</span><span>j</span><span>++)</span> <span>{</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="                <span>if</span> <span>($</span><span>i</span> <span>-lt</span> <span>$</span><span>j</span><span>)</span> <span>{</span>" id="code6-l14"><span class="lineCounter-0-0-4 -codedoc-line-counter">14<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>                <span>if</span> <span>($</span><span>i</span> <span>-lt</span> <span>$</span><span>j</span><span>)</span> <span>{</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="                    <span>$</span><span>l</span> <span>=</span> <span>$</span><span>neighbours</span><span>[$</span><span>i</span><span>]</span>" id="code6-l15"><span class="lineCounter-0-0-4 prim -codedoc-line-counter">15<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>                    <span>$</span><span>l</span> <span>=</span> <span>$</span><span>neighbours</span><span>[$</span><span>i</span><span>]</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="                    <span>$</span><span>r </span><span>=</span> <span>$</span><span>neighbours</span><span>[$</span><span>j</span><span>]</span>" id="code6-l16"><span class="lineCounter-0-0-4 -codedoc-line-counter">16<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>                    <span>$</span><span>r </span><span>=</span> <span>$</span><span>neighbours</span><span>[$</span><span>j</span><span>]</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="                    <span>#the way the edge objects are setup currently we will need to check for both sides</span>" id="code6-l17"><span class="lineCounter-0-0-4 -codedoc-line-counter">17<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>                    <span>#the way the edge objects are setup currently we will need to check for both sides</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="                    <span>#would be better to setup sundirected edges differently</span>" id="code6-l18"><span class="lineCounter-0-0-4 -codedoc-line-counter">18<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>                    <span>#would be better to setup sundirected edges differently</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="                    <span>$</span><span>Graph</span><span>.</span><span>Edges</span><span>.</span><span>where</span><span>{($</span><span>_</span><span>.</span><span>From</span> <span>-eq</span> <span>$</span><span>l</span> <span>-and</span> <span>$</span><span>_</span><span>.</span><span>To</span> <span>-eq</span> <span>$</span><span>r</span><span>)</span> <span>-or</span> <span>($</span><span>_</span><span>.</span><span>From</span> <span>-eq</span> <span>$</span><span>r </span><span>-and</span> <span>$</span><span>_</span><span>.</span><span>To</span> <span>-eq</span> <span>$</span><span>l</span><span>)</span> <span>}</span>   " id="code6-l19"><span class="lineCounter-0-0-4 -codedoc-line-counter">19<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>                    <span>$</span><span>Graph</span><span>.</span><span>Edges</span><span>.</span><span>where</span><span>{($</span><span>_</span><span>.</span><span>From</span> <span>-eq</span> <span>$</span><span>l</span> <span>-and</span> <span>$</span><span>_</span><span>.</span><span>To</span> <span>-eq</span> <span>$</span><span>r</span><span>)</span> <span>-or</span> <span>($</span><span>_</span><span>.</span><span>From</span> <span>-eq</span> <span>$</span><span>r </span><span>-and</span> <span>$</span><span>_</span><span>.</span><span>To</span> <span>-eq</span> <span>$</span><span>l</span><span>)</span> <span>}</span>   </div><br><div class="line-0-0-7  -codedoc-code-line" data-content="                <span>}</span>" id="code6-l20"><span class="lineCounter-0-0-4 prim -codedoc-line-counter">20<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>                <span>}</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="            <span>}</span>" id="code6-l21"><span class="lineCounter-0-0-4 -codedoc-line-counter">21<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>            <span>}</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="        <span>}</span>" id="code6-l22"><span class="lineCounter-0-0-4 -codedoc-line-counter">22<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>        <span>}</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="        <span>($</span><span>actualConnections</span><span>.</span><span>Count</span><span>/$</span><span>possibleConnections</span><span>)</span>" id="code6-l23"><span class="lineCounter-0-0-4 -codedoc-line-counter">23<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>        <span>($</span><span>actualConnections</span><span>.</span><span>Count</span><span>/$</span><span>possibleConnections</span><span>)</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="    <span>}</span>" id="code6-l24"><span class="lineCounter-0-0-4 -codedoc-line-counter">24<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span>}</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="    <span>#return the average of the clustering coefficients per node exlcuding NaNs</span>" id="code6-l25"><span class="lineCounter-0-0-4 prim -codedoc-line-counter">25<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span>#return the average of the clustering coefficients per node exlcuding NaNs</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="    <span>($</span><span>individualCEs</span><span>.</span><span>where</span><span>{</span><span>-not</span> <span>(</span><span>[Single]</span><span>::</span><span>IsNaN</span><span>($</span><span>_</span><span>))</span> <span>}</span> <span>|</span> <span>Measure-Object</span> <span>-Average</span><span>).</span><span>Average</span>" id="code6-l26"><span class="lineCounter-0-0-4 -codedoc-line-counter">26<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span>($</span><span>individualCEs</span><span>.</span><span>where</span><span>{</span><span>-not</span> <span>(</span><span>[Single]</span><span>::</span><span>IsNaN</span><span>($</span><span>_</span><span>))</span> <span>}</span> <span>|</span> <span>Measure-Object</span> <span>-Average</span><span>).</span><span>Average</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="<span>}</span>" id="code6-l27"><span class="lineCounter-0-0-4 prim -codedoc-line-counter">27<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span>}</span></div><br></code></pre><p>If we test with our Ring-Lattice graph from our, we can get the expected .5 (each nodes has 4 neighbours with 3 connections out of possible 6 connections)</p><pre class=""><code class="undefined -codedoc-code-snippet code-0-0-3" tabindex="0"><span class="wmbar-0-0-8"><span></span><span></span><span></span><span></span></span><div class="line-0-0-7  -codedoc-code-line" data-content="<span></span><span>Get-ClusteringCoefficient</span> <span>$</span><span>ringLattice</span>" id="code7-l1"><span class="lineCounter-0-0-4 prim -codedoc-line-counter">1<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span></span><span>Get-ClusteringCoefficient</span> <span>$</span><span>ringLattice</span></div><br></code></pre><h3 id="shortest-path-length" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>Shortest Path Length<a href="https://powershellone.wordpress.com/2021/03/23/graph-theory-with-powershell-part-2/#Shortest-Path-Length-"></a></h3><p>The next step is to calculate the shortest path length, which is the average length of the shortest path between each pair of nodes.</p><p>There are several well-known algorithms to do this one of them is the <a href="https://en.wikipedia.org/wiki/Dijkstra%27s_algorithm#Pseudocode">Dijkstra algorithm</a>. The algorithm is based on breadth-first search which means that the search starts with the immediate neighbours of a node before traversing deeper into the graph by looking at the neighbour’s neighbours and so on. We can use a simplified version of the Dijkstra algorithm since we are dealing with undirected graphs where each edge has an equal weight.</p><p>At a high level, the algorithm works like this:</p><ul><li>We make use of .Net’s built-in <a href="https://docs.microsoft.com/en-us/dotnet/api/system.collections.generic.linkedlist-1?view=net-5.0">LinkedList collection</a> to simulate a stack (add at the end) and queue behaviour (remove from the beginning) to traverse through the nodes of the graph in breadth-first manner.</li><li>A HashTable is used to keep track of each node’s distance to the provided start node.</li><li><code>Get-Neighbours</code> is used to retrieve the immediate neighbours of the current node (starting with the start node).</li><li>For those neighbours, that we are not already keeping track of.<ul><li>Update the neighbour’s distance to 1 + the distance of the current node (since the distance to the neighbour is, by defintion, one more than the current node’s distance)</li><li>We add the neighbour to the linked list in order to traverse one level further.</li></ul></li><li>At then end an object with source (the start node), destination, and distance properties is returned containing the distance’s for each node in the graph to the specified start node.</li></ul><pre class="with-bar"><code class="undefined -codedoc-code-snippet code-0-0-3" tabindex="0"><span class="wmbar-0-0-8"><span></span><span></span><span></span><span></span></span><div class="line-0-0-7  -codedoc-code-line" data-content="<span></span><span>function</span> <span>Get-ShortestPath</span> <span>($</span><span>Graph</span><span>,</span> <span>$</span><span>StartNode</span><span>)</span> <span>{</span>" id="code8-l1"><span class="lineCounter-0-0-4 prim -codedoc-line-counter">1<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span></span><span>function</span> <span>Get-ShortestPath</span> <span>($</span><span>Graph</span><span>,</span> <span>$</span><span>StartNode</span><span>)</span> <span>{</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="    <span>#distances keeps track of distances from the start node for each node</span>" id="code8-l2"><span class="lineCounter-0-0-4 -codedoc-line-counter">2<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span>#distances keeps track of distances from the start node for each node</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="    <span>$</span><span>distances</span> <span>=</span> <span>@{$</span><span>StartNode</span> <span>=</span> <span>0</span><span>}</span>" id="code8-l3"><span class="lineCounter-0-0-4 -codedoc-line-counter">3<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span>$</span><span>distances</span> <span>=</span> <span>@{$</span><span>StartNode</span> <span>=</span> <span>0</span><span>}</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="    <span>#usage of linked list to be able to add at the end (like in a stack) and remove from the beginning (like in a queue)</span>" id="code8-l4"><span class="lineCounter-0-0-4 -codedoc-line-counter">4<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span>#usage of linked list to be able to add at the end (like in a stack) and remove from the beginning (like in a queue)</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="    <span>$</span><span>list</span> <span>=</span> <span>New-Object</span> <span>System</span><span>.</span><span>Collections</span><span>.</span><span>Generic</span><span>.</span><span>LinkedList</span><span>[int]</span>" id="code8-l5"><span class="lineCounter-0-0-4 prim -codedoc-line-counter">5<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span>$</span><span>list</span> <span>=</span> <span>New-Object</span> <span>System</span><span>.</span><span>Collections</span><span>.</span><span>Generic</span><span>.</span><span>LinkedList</span><span>[int]</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="    <span>$</span><span>null</span> <span>=</span> <span>$</span><span>list</span><span>.</span><span>AddFirst</span><span>($</span><span>StartNode</span><span>)</span>" id="code8-l6"><span class="lineCounter-0-0-4 -codedoc-line-counter">6<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span>$</span><span>null</span> <span>=</span> <span>$</span><span>list</span><span>.</span><span>AddFirst</span><span>($</span><span>StartNode</span><span>)</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="    <span>while</span> <span>($</span><span>list</span><span>.</span><span>Count</span> <span>-gt</span> <span>0</span><span>)</span> <span>{</span>" id="code8-l7"><span class="lineCounter-0-0-4 -codedoc-line-counter">7<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span>while</span> <span>($</span><span>list</span><span>.</span><span>Count</span> <span>-gt</span> <span>0</span><span>)</span> <span>{</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="        <span>#get the first element from the linked list</span>" id="code8-l8"><span class="lineCounter-0-0-4 -codedoc-line-counter">8<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>        <span>#get the first element from the linked list</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="        <span>$</span><span>node</span> <span>=</span> <span>$</span><span>list</span><span>.</span><span>First</span><span>.</span><span>Value</span>" id="code8-l9"><span class="lineCounter-0-0-4 -codedoc-line-counter">9<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>        <span>$</span><span>node</span> <span>=</span> <span>$</span><span>list</span><span>.</span><span>First</span><span>.</span><span>Value</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="        <span>$</span><span>null</span> <span>=</span> <span>$</span><span>list</span><span>.</span><span>RemoveFirst</span><span>()</span>" id="code8-l10"><span class="lineCounter-0-0-4 prim -codedoc-line-counter">10<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>        <span>$</span><span>null</span> <span>=</span> <span>$</span><span>list</span><span>.</span><span>RemoveFirst</span><span>()</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="        <span>$</span><span>neighbours</span> <span>=</span> <span>Get-Neighbours</span> <span>$</span><span>Graph</span><span>.</span><span>Edges</span> <span>$</span><span>node</span> <span>-Undirected</span> " id="code8-l11"><span class="lineCounter-0-0-4 -codedoc-line-counter">11<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>        <span>$</span><span>neighbours</span> <span>=</span> <span>Get-Neighbours</span> <span>$</span><span>Graph</span><span>.</span><span>Edges</span> <span>$</span><span>node</span> <span>-Undirected</span> </div><br><div class="line-0-0-7  -codedoc-code-line" data-content="        <span>#find the neighbours that are not already contained in the hashtable</span>" id="code8-l12"><span class="lineCounter-0-0-4 -codedoc-line-counter">12<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>        <span>#find the neighbours that are not already contained in the hashtable</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="        <span>$</span><span>neighbours</span> <span>=</span> <span>$</span><span>neighbours</span><span>.</span><span>where</span><span>{</span> <span>$</span><span>_</span> <span>-notin</span> <span>$</span><span>distances</span><span>.</span><span>Keys</span> <span>}</span>" id="code8-l13"><span class="lineCounter-0-0-4 -codedoc-line-counter">13<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>        <span>$</span><span>neighbours</span> <span>=</span> <span>$</span><span>neighbours</span><span>.</span><span>where</span><span>{</span> <span>$</span><span>_</span> <span>-notin</span> <span>$</span><span>distances</span><span>.</span><span>Keys</span> <span>}</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="        <span>foreach</span> <span>($</span><span>neighbour</span> <span>in</span> <span>$</span><span>neighbours</span><span>){</span>" id="code8-l14"><span class="lineCounter-0-0-4 -codedoc-line-counter">14<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>        <span>foreach</span> <span>($</span><span>neighbour</span> <span>in</span> <span>$</span><span>neighbours</span><span>){</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="            <span>#the distance to the neighbour is, by defintion, the current node's distance + 1</span>" id="code8-l15"><span class="lineCounter-0-0-4 prim -codedoc-line-counter">15<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>            <span>#the distance to the neighbour is, by defintion, the current node's distance + 1</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="            <span>$</span><span>distances</span><span>.$</span><span>neighbour</span> <span>=</span> <span>$</span><span>distances</span><span>.$</span><span>node</span> <span>+</span> <span>1</span>" id="code8-l16"><span class="lineCounter-0-0-4 -codedoc-line-counter">16<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>            <span>$</span><span>distances</span><span>.$</span><span>neighbour</span> <span>=</span> <span>$</span><span>distances</span><span>.$</span><span>node</span> <span>+</span> <span>1</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="            <span>#add the neighbour to the list to discover further connections</span>" id="code8-l17"><span class="lineCounter-0-0-4 -codedoc-line-counter">17<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>            <span>#add the neighbour to the list to discover further connections</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="            <span>$</span><span>null</span> <span>=</span> <span>$</span><span>list</span><span>.</span><span>AddLast</span><span>($</span><span>neighbour</span><span>)</span>" id="code8-l18"><span class="lineCounter-0-0-4 -codedoc-line-counter">18<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>            <span>$</span><span>null</span> <span>=</span> <span>$</span><span>list</span><span>.</span><span>AddLast</span><span>($</span><span>neighbour</span><span>)</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="        <span>}</span>" id="code8-l19"><span class="lineCounter-0-0-4 -codedoc-line-counter">19<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>        <span>}</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="    <span>}</span>" id="code8-l20"><span class="lineCounter-0-0-4 prim -codedoc-line-counter">20<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span>}</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="    <span>$</span><span>distances</span><span>.</span><span>GetEnumerator</span><span>().</span><span>foreach</span><span>{</span>" id="code8-l21"><span class="lineCounter-0-0-4 -codedoc-line-counter">21<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span>$</span><span>distances</span><span>.</span><span>GetEnumerator</span><span>().</span><span>foreach</span><span>{</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="        <span>[PSCustomObject][ordered]</span><span>@{</span>" id="code8-l22"><span class="lineCounter-0-0-4 -codedoc-line-counter">22<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>        <span>[PSCustomObject][ordered]</span><span>@{</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="            <span>Source</span>      <span>=</span> <span>$</span><span>startNode</span>" id="code8-l23"><span class="lineCounter-0-0-4 -codedoc-line-counter">23<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>            <span>Source</span>      <span>=</span> <span>$</span><span>startNode</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="            <span>Destination</span> <span>=</span> <span>$</span><span>_</span><span>.</span><span>Name</span>" id="code8-l24"><span class="lineCounter-0-0-4 -codedoc-line-counter">24<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>            <span>Destination</span> <span>=</span> <span>$</span><span>_</span><span>.</span><span>Name</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="            <span>Distance</span>    <span>=</span> <span>$</span><span>_</span><span>.</span><span>Value</span>" id="code8-l25"><span class="lineCounter-0-0-4 prim -codedoc-line-counter">25<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>            <span>Distance</span>    <span>=</span> <span>$</span><span>_</span><span>.</span><span>Value</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="        <span>}</span>" id="code8-l26"><span class="lineCounter-0-0-4 -codedoc-line-counter">26<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>        <span>}</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="    <span>}</span>" id="code8-l27"><span class="lineCounter-0-0-4 -codedoc-line-counter">27<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span>}</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="<span>}</span>" id="code8-l28"><span class="lineCounter-0-0-4 prim -codedoc-line-counter">28<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span>}</span></div><br></code></pre><p>The function returns an object array with Source, Distance, and Destination properties. If we use it on the first node of a our previously created Ring-Lattice graph (added here again for convenience), we get the following result:</p><p><img src="https://powershellone.wordpress.com/wp-content/uploads/2021/03/img2.png" alt="image.png"></p><pre class=""><code class="undefined -codedoc-code-snippet code-0-0-3" tabindex="0"><span class="wmbar-0-0-8"><span></span><span></span><span></span><span></span></span><div class="line-0-0-7  -codedoc-code-line" data-content="<span></span><span>Get-ShortestPath</span> <span>$</span><span>ringLattice</span> <span>0</span>" id="code9-l1"><span class="lineCounter-0-0-4 prim -codedoc-line-counter">1<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span></span><span>Get-ShortestPath</span> <span>$</span><span>ringLattice</span> <span>0</span></div><br></code></pre><pre class="with-bar"><code class="undefined -codedoc-code-snippet code-0-0-3" tabindex="0"><span class="wmbar-0-0-8"><span></span><span></span><span></span><span></span></span><div class="line-0-0-7  -codedoc-code-line" data-content="Source Destination Distance" id="code10-l1"><span class="lineCounter-0-0-4 prim -codedoc-line-counter">1<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>Source Destination Distance</div><br><div class="line-0-0-7  -codedoc-code-line" data-content="------ ----------- --------" id="code10-l2"><span class="lineCounter-0-0-4 -codedoc-line-counter">2<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>------ ----------- --------</div><br><div class="line-0-0-7  -codedoc-code-line" data-content="0      9           1" id="code10-l3"><span class="lineCounter-0-0-4 -codedoc-line-counter">3<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>0      9           1</div><br><div class="line-0-0-7  -codedoc-code-line" data-content="0      8           1" id="code10-l4"><span class="lineCounter-0-0-4 -codedoc-line-counter">4<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>0      8           1</div><br><div class="line-0-0-7  -codedoc-code-line" data-content="0      7           2" id="code10-l5"><span class="lineCounter-0-0-4 prim -codedoc-line-counter">5<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>0      7           2</div><br><div class="line-0-0-7  -codedoc-code-line" data-content="0      6           2" id="code10-l6"><span class="lineCounter-0-0-4 -codedoc-line-counter">6<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>0      6           2</div><br><div class="line-0-0-7  -codedoc-code-line" data-content="0      5           3" id="code10-l7"><span class="lineCounter-0-0-4 -codedoc-line-counter">7<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>0      5           3</div><br><div class="line-0-0-7  -codedoc-code-line" data-content="0      4           2" id="code10-l8"><span class="lineCounter-0-0-4 -codedoc-line-counter">8<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>0      4           2</div><br><div class="line-0-0-7  -codedoc-code-line" data-content="0      3           2" id="code10-l9"><span class="lineCounter-0-0-4 -codedoc-line-counter">9<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>0      3           2</div><br><div class="line-0-0-7  -codedoc-code-line" data-content="0      2           1" id="code10-l10"><span class="lineCounter-0-0-4 prim -codedoc-line-counter">10<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>0      2           1</div><br><div class="line-0-0-7  -codedoc-code-line" data-content="0      1           1" id="code10-l11"><span class="lineCounter-0-0-4 -codedoc-line-counter">11<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>0      1           1</div><br><div class="line-0-0-7  -codedoc-code-line" data-content="0      0           0" id="code10-l12"><span class="lineCounter-0-0-4 -codedoc-line-counter">12<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>0      0           0</div><br><div class="line-0-0-7  -codedoc-code-line" data-content="" id="code10-l13"><span class="lineCounter-0-0-4 prim -codedoc-line-counter">13<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span></div><br></code></pre><p>To get the average shortest path length for a whole graph we need to … :</p><ul><li>… do this for every unique starting point (From) in the graph.</li><li>Remove the 0 distance entries (from node to self).</li><li>Get the average of the remaining distances.</li></ul><pre class="with-bar"><code class="undefined -codedoc-code-snippet code-0-0-3" tabindex="0"><span class="wmbar-0-0-8"><span></span><span></span><span></span><span></span></span><div class="line-0-0-7  -codedoc-code-line" data-content="<span></span><span>$</span><span>groupedEdges</span> <span>=</span> <span>$</span><span>ringLattice</span><span>.</span><span>Edges</span> <span>|</span> <span>group </span><span>From</span>" id="code11-l1"><span class="lineCounter-0-0-4 prim -codedoc-line-counter">1<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span></span><span>$</span><span>groupedEdges</span> <span>=</span> <span>$</span><span>ringLattice</span><span>.</span><span>Edges</span> <span>|</span> <span>group </span><span>From</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="<span>$</span><span>distances</span> <span>=</span> <span>foreach</span> <span>($</span><span>group </span><span>in</span> <span>$</span><span>groupedEdges</span><span>){</span>" id="code11-l2"><span class="lineCounter-0-0-4 -codedoc-line-counter">2<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span>$</span><span>distances</span> <span>=</span> <span>foreach</span> <span>($</span><span>group </span><span>in</span> <span>$</span><span>groupedEdges</span><span>){</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="    <span>Get-ShortestPath</span> <span>$</span><span>ringLattice</span> <span>$</span><span>group</span><span>.</span><span>Name</span>" id="code11-l3"><span class="lineCounter-0-0-4 -codedoc-line-counter">3<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span>Get-ShortestPath</span> <span>$</span><span>ringLattice</span> <span>$</span><span>group</span><span>.</span><span>Name</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="<span>}</span>" id="code11-l4"><span class="lineCounter-0-0-4 -codedoc-line-counter">4<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span>}</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="<span>($</span><span>distances</span><span>.</span><span>where</span><span>{$</span><span>_</span><span>.</span><span>Distance</span> <span>-ne</span> <span>0</span> <span>-and</span> <span>$</span><span>_</span><span>.</span><span>Distance</span><span>}</span> <span>|</span>" id="code11-l5"><span class="lineCounter-0-0-4 prim -codedoc-line-counter">5<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span>($</span><span>distances</span><span>.</span><span>where</span><span>{$</span><span>_</span><span>.</span><span>Distance</span> <span>-ne</span> <span>0</span> <span>-and</span> <span>$</span><span>_</span><span>.</span><span>Distance</span><span>}</span> <span>|</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="    <span>Measure-Object</span> <span>-Property</span> <span>Distance</span> <span>-Average</span><span>).</span><span>Average</span>" id="code11-l6"><span class="lineCounter-0-0-4 prim -codedoc-line-counter">6<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span>Measure-Object</span> <span>-Property</span> <span>Distance</span> <span>-Average</span><span>).</span><span>Average</span></div><br></code></pre><h3 id="small-world-experiment-watts-strogatz" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>Small-World experiment (Watts, Strogatz)<a href="https://powershellone.wordpress.com/2021/03/23/graph-theory-with-powershell-part-2/#Small-World-experiment-(Watts,-Strogatz)-"></a></h3><p>Great, now we have everything in place to do duplicate the Small-world experiment. Showing that there are Small-Word graphs with a certain range of probability (for re-wiring) with high clustering-coefficients (like regular graphs) and a short average path lengths (like in random graphs).</p><p>In practice it turned out that, at least with the sloppy version of my code, the PowerShell functions are not executing nearly fast enough to carry out the experiment with 1000 nodes for each graph and 10 connections each. Even though I have added multi-threading to the Shortest-Path parts using <a href="https://www.powershellgallery.com/packages/ThreadJob/2.0.3">PSThreadJobs’s</a> <code>Start-ThreadJob</code> function since this is definitely the bottleneck.</p><pre class="with-bar"><code class="undefined -codedoc-code-snippet code-0-0-3" tabindex="0"><span class="wmbar-0-0-8"><span></span><span></span><span></span><span></span></span><div class="line-0-0-7  -codedoc-code-line" data-content="<span></span><span>function</span> <span>Do</span><span>-Experiment</span> <span>($</span><span>Nodes</span> <span>=</span> <span>(</span><span>0</span><span>..</span><span>99</span><span>),</span> <span>$</span><span>NumConnections</span><span>=</span><span>3</span><span>,</span> <span>$</span><span>Probabilities</span><span>){</span>" id="code12-l1"><span class="lineCounter-0-0-4 prim -codedoc-line-counter">1<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span></span><span>function</span> <span>Do</span><span>-Experiment</span> <span>($</span><span>Nodes</span> <span>=</span> <span>(</span><span>0</span><span>..</span><span>99</span><span>),</span> <span>$</span><span>NumConnections</span><span>=</span><span>3</span><span>,</span> <span>$</span><span>Probabilities</span><span>){</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="    <span>foreach</span> <span>($</span><span>probability</span> <span>in</span> <span>$</span><span>Probabilities</span><span>){</span>" id="code12-l2"><span class="lineCounter-0-0-4 -codedoc-line-counter">2<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span>foreach</span> <span>($</span><span>probability</span> <span>in</span> <span>$</span><span>Probabilities</span><span>){</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="        <span>$</span><span>apl</span> <span>=</span> <span>[System.Collections.ArrayList]</span><span>@()</span>" id="code12-l3"><span class="lineCounter-0-0-4 -codedoc-line-counter">3<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>        <span>$</span><span>apl</span> <span>=</span> <span>[System.Collections.ArrayList]</span><span>@()</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="        <span>$</span><span>ccoe</span> <span>=</span> <span>[System.Collections.ArrayList]</span><span>@()</span>" id="code12-l4"><span class="lineCounter-0-0-4 -codedoc-line-counter">4<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>        <span>$</span><span>ccoe</span> <span>=</span> <span>[System.Collections.ArrayList]</span><span>@()</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="        <span>$</span><span>jobs</span> <span>=</span> <span>@()</span>" id="code12-l5"><span class="lineCounter-0-0-4 prim -codedoc-line-counter">5<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>        <span>$</span><span>jobs</span> <span>=</span> <span>@()</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="        <span>$</span><span>graph</span> <span>=</span> <span>Get-SmallWorldGraph</span> <span>$</span><span>Nodes</span> <span>$</span><span>NumConnections</span> <span>$</span><span>probability</span>" id="code12-l6"><span class="lineCounter-0-0-4 -codedoc-line-counter">6<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>        <span>$</span><span>graph</span> <span>=</span> <span>Get-SmallWorldGraph</span> <span>$</span><span>Nodes</span> <span>$</span><span>NumConnections</span> <span>$</span><span>probability</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="        <span>$</span><span>groupedEdges</span> <span>=</span> <span>$</span><span>graph</span><span>.</span><span>Edges</span> <span>|</span> <span>group </span><span>From</span>" id="code12-l7"><span class="lineCounter-0-0-4 -codedoc-line-counter">7<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>        <span>$</span><span>groupedEdges</span> <span>=</span> <span>$</span><span>graph</span><span>.</span><span>Edges</span> <span>|</span> <span>group </span><span>From</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="        <span>foreach</span> <span>($</span><span>group </span><span>in</span> <span>$</span><span>groupedEdges</span><span>){</span>" id="code12-l8"><span class="lineCounter-0-0-4 -codedoc-line-counter">8<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>        <span>foreach</span> <span>($</span><span>group </span><span>in</span> <span>$</span><span>groupedEdges</span><span>){</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="            <span>$</span><span>initBlock</span> <span>=</span> <span>[ScriptBlock]</span><span>::</span><span>Create</span><span>(</span>" id="code12-l9"><span class="lineCounter-0-0-4 -codedoc-line-counter">9<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>            <span>$</span><span>initBlock</span> <span>=</span> <span>[ScriptBlock]</span><span>::</span><span>Create</span><span>(</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="            <span>'function Get-ShortestPath{'</span> <span>+</span> <span>(</span><span>Get-Command</span> <span>Get-ShortestPath</span><span>).</span><span>Definition</span> <span>+</span> <span>'}'</span> <span>+</span>" id="code12-l10"><span class="lineCounter-0-0-4 prim -codedoc-line-counter">10<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>            <span>'function Get-ShortestPath{'</span> <span>+</span> <span>(</span><span>Get-Command</span> <span>Get-ShortestPath</span><span>).</span><span>Definition</span> <span>+</span> <span>'}'</span> <span>+</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="            <span>'function Get-Neighbours{'</span> <span>+</span> <span>(</span><span>Get-Command</span> <span>Get-Neighbours</span><span>).</span><span>Definition</span> <span>+</span> <span>'}'</span>" id="code12-l11"><span class="lineCounter-0-0-4 -codedoc-line-counter">11<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>            <span>'function Get-Neighbours{'</span> <span>+</span> <span>(</span><span>Get-Command</span> <span>Get-Neighbours</span><span>).</span><span>Definition</span> <span>+</span> <span>'}'</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="            <span>)</span>" id="code12-l12"><span class="lineCounter-0-0-4 -codedoc-line-counter">12<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>            <span>)</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="            <span>$</span><span>jobs</span> <span>+=</span> <span>Start-ThreadJob</span> <span>-InitializationScript</span> <span>$</span><span>initBlock</span> <span>{</span>" id="code12-l13"><span class="lineCounter-0-0-4 -codedoc-line-counter">13<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>            <span>$</span><span>jobs</span> <span>+=</span> <span>Start-ThreadJob</span> <span>-InitializationScript</span> <span>$</span><span>initBlock</span> <span>{</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="                <span>$</span><span>group </span><span>=</span> <span>$</span><span>using</span><span>:</span><span>group</span>" id="code12-l14"><span class="lineCounter-0-0-4 -codedoc-line-counter">14<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>                <span>$</span><span>group </span><span>=</span> <span>$</span><span>using</span><span>:</span><span>group</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="                <span>Get-ShortestPath</span> <span>$</span><span>using</span><span>:</span><span>graph</span> <span>$</span><span>group</span><span>.</span><span>Name</span>" id="code12-l15"><span class="lineCounter-0-0-4 prim -codedoc-line-counter">15<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>                <span>Get-ShortestPath</span> <span>$</span><span>using</span><span>:</span><span>graph</span> <span>$</span><span>group</span><span>.</span><span>Name</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="            <span>}</span>" id="code12-l16"><span class="lineCounter-0-0-4 -codedoc-line-counter">16<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>            <span>}</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="        <span>}</span>" id="code12-l17"><span class="lineCounter-0-0-4 -codedoc-line-counter">17<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>        <span>}</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="        <span>$</span><span>null</span> <span>=</span> <span>$</span><span>jobs</span> <span>|</span> <span>Wait-Job</span>" id="code12-l18"><span class="lineCounter-0-0-4 -codedoc-line-counter">18<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>        <span>$</span><span>null</span> <span>=</span> <span>$</span><span>jobs</span> <span>|</span> <span>Wait-Job</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="        <span>$</span><span>distances</span> <span>=</span> <span>$</span><span>jobs</span> <span>|</span> <span>Receive-Job</span>" id="code12-l19"><span class="lineCounter-0-0-4 -codedoc-line-counter">19<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>        <span>$</span><span>distances</span> <span>=</span> <span>$</span><span>jobs</span> <span>|</span> <span>Receive-Job</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="        <span>$</span><span>null</span> <span>=</span> <span>$</span><span>jobs</span> <span>|</span> <span>Remove-Job</span>" id="code12-l20"><span class="lineCounter-0-0-4 prim -codedoc-line-counter">20<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>        <span>$</span><span>null</span> <span>=</span> <span>$</span><span>jobs</span> <span>|</span> <span>Remove-Job</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="        <span>$</span><span>null</span> <span>=</span> <span>$</span><span>apl</span><span>.</span><span>Add</span><span>(($</span><span>distances</span><span>.</span><span>where</span><span>{$</span><span>_</span><span>.</span><span>Distance</span> <span>-ne</span> <span>0</span><span>}</span> <span>|</span>" id="code12-l21"><span class="lineCounter-0-0-4 -codedoc-line-counter">21<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>        <span>$</span><span>null</span> <span>=</span> <span>$</span><span>apl</span><span>.</span><span>Add</span><span>(($</span><span>distances</span><span>.</span><span>where</span><span>{$</span><span>_</span><span>.</span><span>Distance</span> <span>-ne</span> <span>0</span><span>}</span> <span>|</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="            <span>Measure-Object</span> <span>-Property</span> <span>Distance</span> <span>-Average</span><span>).</span><span>Average</span><span>)</span>" id="code12-l22"><span class="lineCounter-0-0-4 -codedoc-line-counter">22<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>            <span>Measure-Object</span> <span>-Property</span> <span>Distance</span> <span>-Average</span><span>).</span><span>Average</span><span>)</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="        <span>$</span><span>null</span> <span>=</span> <span>$</span><span>ccoe</span><span>.</span><span>Add</span><span>((</span><span>Get-ClusteringCoefficient</span> <span>$</span><span>graph</span><span>))</span>" id="code12-l23"><span class="lineCounter-0-0-4 -codedoc-line-counter">23<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>        <span>$</span><span>null</span> <span>=</span> <span>$</span><span>ccoe</span><span>.</span><span>Add</span><span>((</span><span>Get-ClusteringCoefficient</span> <span>$</span><span>graph</span><span>))</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="" id="code12-l24"><span class="lineCounter-0-0-4 -codedoc-line-counter">24<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="        <span>[PSCustomObject][ordered]</span><span>@{</span>" id="code12-l25"><span class="lineCounter-0-0-4 prim -codedoc-line-counter">25<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>        <span>[PSCustomObject][ordered]</span><span>@{</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="            <span>Probability</span> <span>=</span> <span>$</span><span>probability</span>" id="code12-l26"><span class="lineCounter-0-0-4 -codedoc-line-counter">26<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>            <span>Probability</span> <span>=</span> <span>$</span><span>probability</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="            <span>AveragePathLength</span> <span>=</span> <span>($</span><span>apl</span> <span>|</span> <span>Measure-Object</span> <span>-Average</span><span>).</span><span>Average</span>" id="code12-l27"><span class="lineCounter-0-0-4 -codedoc-line-counter">27<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>            <span>AveragePathLength</span> <span>=</span> <span>($</span><span>apl</span> <span>|</span> <span>Measure-Object</span> <span>-Average</span><span>).</span><span>Average</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="            <span>ClusteringCoeeficient</span> <span>=</span> <span>($</span><span>ccoe</span> <span>|</span> <span>Measure-Object</span> <span>-Average</span><span>).</span><span>Average</span>" id="code12-l28"><span class="lineCounter-0-0-4 -codedoc-line-counter">28<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>            <span>ClusteringCoeeficient</span> <span>=</span> <span>($</span><span>ccoe</span> <span>|</span> <span>Measure-Object</span> <span>-Average</span><span>).</span><span>Average</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="        <span>}</span>" id="code12-l29"><span class="lineCounter-0-0-4 -codedoc-line-counter">29<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>        <span>}</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="    <span>}</span>" id="code12-l30"><span class="lineCounter-0-0-4 prim -codedoc-line-counter">30<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span>}</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="<span>}</span>" id="code12-l31"><span class="lineCounter-0-0-4 -codedoc-line-counter">31<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span>}</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="" id="code12-l32"><span class="lineCounter-0-0-4 -codedoc-line-counter">32<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="<span>#get log-spaced probabilites to simulate the experiment with the same parameters</span>" id="code12-l33"><span class="lineCounter-0-0-4 -codedoc-line-counter">33<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span>#get log-spaced probabilites to simulate the experiment with the same parameters</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="<span>$</span><span>probabilities</span> <span>=</span> <span>Get-LogSpace</span> <span>-</span><span>4</span> <span>0</span> <span>9</span>" id="code12-l34"><span class="lineCounter-0-0-4 -codedoc-line-counter">34<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span>$</span><span>probabilities</span> <span>=</span> <span>Get-LogSpace</span> <span>-</span><span>4</span> <span>0</span> <span>9</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="<span>$</span><span>result</span> <span>=</span> <span>Do</span><span>-Experiment</span> <span>-Probabilities</span> <span>$</span><span>probabilities</span>" id="code12-l35"><span class="lineCounter-0-0-4 prim -codedoc-line-counter">35<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span>$</span><span>result</span> <span>=</span> <span>Do</span><span>-Experiment</span> <span>-Probabilities</span> <span>$</span><span>probabilities</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="<span>#scale the avg. path length and clustering coeff. </span>" id="code12-l36"><span class="lineCounter-0-0-4 -codedoc-line-counter">36<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span>#scale the avg. path length and clustering coeff. </span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="<span>#to be able to plot them on the same axis (same as in the experiment)</span>" id="code12-l37"><span class="lineCounter-0-0-4 -codedoc-line-counter">37<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span>#to be able to plot them on the same axis (same as in the experiment)</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="<span>$</span><span>firstApl</span> <span>=</span> <span>$</span><span>result</span><span>[</span><span>0</span><span>].</span><span>AveragePathLength</span>" id="code12-l38"><span class="lineCounter-0-0-4 -codedoc-line-counter">38<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span>$</span><span>firstApl</span> <span>=</span> <span>$</span><span>result</span><span>[</span><span>0</span><span>].</span><span>AveragePathLength</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="<span>$</span><span>firstCoeff</span> <span>=</span> <span>$</span><span>result</span><span>[</span><span>0</span><span>].</span><span>ClusteringCoeeficient</span>" id="code12-l39"><span class="lineCounter-0-0-4 -codedoc-line-counter">39<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span>$</span><span>firstCoeff</span> <span>=</span> <span>$</span><span>result</span><span>[</span><span>0</span><span>].</span><span>ClusteringCoeeficient</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="<span>for</span> <span>($</span><span>i</span><span>=</span><span>0</span><span>;$</span><span>i</span> <span>-lt</span> <span>$</span><span>result</span><span>.</span><span>Count</span><span>;$</span><span>i</span><span>++){</span>" id="code12-l40"><span class="lineCounter-0-0-4 prim -codedoc-line-counter">40<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span>for</span> <span>($</span><span>i</span><span>=</span><span>0</span><span>;$</span><span>i</span> <span>-lt</span> <span>$</span><span>result</span><span>.</span><span>Count</span><span>;$</span><span>i</span><span>++){</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="    <span>$</span><span>result</span><span>[$</span><span>i</span><span>].</span><span>AveragePathLength</span> <span>=</span> <span>$</span><span>result</span><span>[$</span><span>i</span><span>].</span><span>AveragePathLength</span><span>/$</span><span>firstApl</span>" id="code12-l41"><span class="lineCounter-0-0-4 -codedoc-line-counter">41<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span>$</span><span>result</span><span>[$</span><span>i</span><span>].</span><span>AveragePathLength</span> <span>=</span> <span>$</span><span>result</span><span>[$</span><span>i</span><span>].</span><span>AveragePathLength</span><span>/$</span><span>firstApl</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="    <span>$</span><span>result</span><span>[$</span><span>i</span><span>].</span><span>ClusteringCoeeficient</span> <span>=</span> <span>$</span><span>result</span><span>[$</span><span>i</span><span>].</span><span>ClusteringCoeeficient</span><span>/$</span><span>firstCoeff</span>" id="code12-l42"><span class="lineCounter-0-0-4 -codedoc-line-counter">42<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span>$</span><span>result</span><span>[$</span><span>i</span><span>].</span><span>ClusteringCoeeficient</span> <span>=</span> <span>$</span><span>result</span><span>[$</span><span>i</span><span>].</span><span>ClusteringCoeeficient</span><span>/$</span><span>firstCoeff</span></div><br><div class="line-0-0-7  -codedoc-code-line" data-content="<span>}</span>" id="code12-l43"><span class="lineCounter-0-0-4 prim -codedoc-line-counter">43<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span>}</span></div><br></code></pre><p>While this is unfortunate, the results for 100 nodes with 3 connections (see first graph below) are showing a similar trend as the original study’s results from the Watts/Strogatz paper (L = average path length standardized, C = clustering coefficients standardized).As the probability increases, the average path length decreases quite rapidly because even a small number of randomly rewired edges provide shorter paths between nodes that are far apart. Replacing neighbouring links decreases the clustering coefficient much more slowly. As a result, there is a wide range of probabilities with high clustering coefficients and low average path lengths.</p><p><img src="https://powershellone.wordpress.com/wp-content/uploads/2021/03/img3-1.png" alt="image.png"></p><p><img src="https://powershellone.wordpress.com/wp-content/uploads/2021/03/img3.png" alt="image.png"></p><p>WordPress conversion from graphTheory2.ipynb by <a href="https://github.com/bennylp/nb2wp">nb2wp</a> v0.3.1</p><p><img src="https://powershellone.wordpress.com/wp-content/uploads/2015/10/sharethoughts.jpg" alt="shareThoughts"></p><hr><p>Photo Credit: <a href="https://www.vecteezy.com/free-photos/tree">Tree Stock photos by Vecteezy</a></p><h2 id="post-navigation" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>Post navigation</h2><div class="contentnav-0-0-17" data-no-search=""><a href="#graph-theory-with-powershell--part-2--tech-thoughts" class="h1" data-content-highlight="graph-theory-with-powershell--part-2--tech-thoughts">Graph theory with PowerShell -part 2 – Tech thoughts</a><a href="#table-of-contents" class="h2" data-content-highlight="table-of-contents">Table of contents</a><a href="#some-necessary-theory" class="h2" data-content-highlight="some-necessary-theory">Some necessary theory</a><a href="#ring-lattice-graph" class="h2" data-content-highlight="ring-lattice-graph">Ring-Lattice graph</a><a href="#small-world-graphs-watts-strogatz" class="h2" data-content-highlight="small-world-graphs-watts-strogatz">Small-World Graphs (Watts-Strogatz)</a><a href="#clustering-coefficient" class="h3" data-content-highlight="clustering-coefficient">Clustering Coefficient</a><a href="#shortest-path-length" class="h3" data-content-highlight="shortest-path-length">Shortest Path Length</a><a href="#small-world-experiment-watts-strogatz" class="h3" data-content-highlight="small-world-experiment-watts-strogatz">Small-World experiment (Watts, Strogatz)</a><a href="#post-navigation" class="h2" data-content-highlight="post-navigation">Post navigation</a></div></div><div id="-codedoc-toc" class="toc-0-0-14"><div class="content-0-0-15"><div class="heading-0-0-9">Index</div><p><a href="/codedoc/">Home</a>
<a href="/codedoc/README">Index</a>
<a href="/codedoc/docs/Kostwein">Kostwein</a></p><div class="collapse-0-0-10 "><script id="tdPKTIRcYU">(function(){function load(){if (window.__sdh_transport){window.__sdh_transport("tdPKTIRcYU", "yAdNJkOJGbj52dvfV+HpdQ==", {});} }; if (document.readyState == 'complete') load(); else window.addEventListener('load', load); window.setImmediate = window.setImmediate || function(f){setTimeout(f, 0)}; })()</script><div class="label" onclick="this.parentElement.classList.toggle('open')"><span class="text">PSModulesHelp</span><span class="icon-font closed">chevron_right</span></div><div class="content"><p><a href="/codedoc/docs/PSModulesHelp/ModuleDoku">PS Modules Help</a></p><hr></div></div><div class="collapse-0-0-10 "><script id="GMqQXUkpwN">(function(){function load(){if (window.__sdh_transport){window.__sdh_transport("GMqQXUkpwN", "yAdNJkOJGbj52dvfV+HpdQ==", {});} }; if (document.readyState == 'complete') load(); else window.addEventListener('load', load); window.setImmediate = window.setImmediate || function(f){setTimeout(f, 0)}; })()</script><div class="label" onclick="this.parentElement.classList.toggle('open')"><span class="text">KnowledgeBase</span><span class="icon-font closed">chevron_right</span></div><div class="content"><blockquote><p><a href="/codedoc/docs/Knowledge/PowerShell/Index">PowerShell</a></p></blockquote></div></div><div class="collapse-0-0-10 "><script id="hVZLuNGhSK">(function(){function load(){if (window.__sdh_transport){window.__sdh_transport("hVZLuNGhSK", "yAdNJkOJGbj52dvfV+HpdQ==", {});} }; if (document.readyState == 'complete') load(); else window.addEventListener('load', load); window.setImmediate = window.setImmediate || function(f){setTimeout(f, 0)}; })()</script><div class="label" onclick="this.parentElement.classList.toggle('open')"><span class="text">Links</span><span class="icon-font closed">chevron_right</span></div><div class="content"><blockquote><p><a href="/codedoc/docs/Links/LinksWiki">Index</a></p></blockquote></div></div><div class="collapse-0-0-10 "><script id="BtrYxmBEKy">(function(){function load(){if (window.__sdh_transport){window.__sdh_transport("BtrYxmBEKy", "yAdNJkOJGbj52dvfV+HpdQ==", {});} }; if (document.readyState == 'complete') load(); else window.addEventListener('load', load); window.setImmediate = window.setImmediate || function(f){setTimeout(f, 0)}; })()</script><div class="label" onclick="this.parentElement.classList.toggle('open')"><span class="text">Veeam</span><span class="icon-font closed">chevron_right</span></div><div class="content"><blockquote><p><a href="/codedoc/docs/Knowledge/Veeam/Best%20Practices/index">Best Practices</a></p></blockquote></div></div><p><a href="/codedoc/docs/cheat-sheet">Markdown Cheat Sheet</a>
<a href="/codedoc/docs/code-features">Code Features</a></p><p><br><br></p><p>To add links to your other documents, simply
modify contents of <code>docs/md/_toc.md</code>.</p></div><div class="search-0-0-16"><script id="MrzYRwKOwe">(function(){function load(){if (window.__sdh_transport){window.__sdh_transport("MrzYRwKOwe", "EKtVWhWp+AfK3O64A4+bOg==", {"repo":"codedoc","user":"In-Pro-Org","root":"docs/md","pick":"\\.md$","drop":"(^_)|(\\/_)"});} }; if (document.readyState == 'complete') load(); else window.addEventListener('load', load); window.setImmediate = window.setImmediate || function(f){setTimeout(f, 0)}; })()</script></div></div><div class="footer-0-0-13"><div class="left"><script id="wFGoqaYnDR">(function(){function load(){if (window.__sdh_transport){window.__sdh_transport("wFGoqaYnDR", "wCsMx1XMyC4jNi3FxvjU4g==", {});} }; if (document.readyState == 'complete') load(); else window.addEventListener('load', load); window.setImmediate = window.setImmediate || function(f){setTimeout(f, 0)}; })()</script></div><div class="main"><div class="inside"><a href="https://github.com/In-Pro-Org/codedoc/" target="_blank">GitHub</a></div></div><div class="right"><script id="quLGKoqFmz">(function(){function load(){if (window.__sdh_transport){window.__sdh_transport("quLGKoqFmz", "6W59GcSTLBVXRr/Nl/rTkw==", {});} }; if (document.readyState == 'complete') load(); else window.addEventListener('load', load); window.setImmediate = window.setImmediate || function(f){setTimeout(f, 0)}; })()</script></div></div><script id="_GcAZqTMCh">(function(){function load(){if (window.__sdh_transport){window.__sdh_transport("_GcAZqTMCh", "zKXJ5zf13oJGCwAAI3JIIA==", {"namespace":"/codedoc"});} }; if (document.readyState == 'complete') load(); else window.addEventListener('load', load); window.setImmediate = window.setImmediate || function(f){setTimeout(f, 0)}; })()</script></body></html>