<!DOCTYPE html><html><head><title>Codedoc | PowerShell Objekt erweitern - 2 einfache Möglichkeiten</title><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"><meta name="robots" content="index,follow"><meta name="theme-color" content="#212121"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><link rel="shortcut icon" href="/codedoc/docs/images/KostweinLogo.ico"><link href="https://fonts.googleapis.com/css?family=Roboto:300,400&amp;display=swap" rel="stylesheet"><link href="https://fonts.googleapis.com/css?family=Source+Code+Pro:300,400&amp;display=swap" rel="stylesheet"><link href="https://fonts.googleapis.com/icon?family=Material+Icons%7CMaterial+Icons+Outlined&amp;display=swap" rel="stylesheet"><style>
      body, input, button {
        font-family: 'Roboto', sans-serif;
      }

      code, .hljs {
        font-family: 'Source Code Pro', 'Courier New', Courier, monospace;
      }

      .icon-font {
        font-family: 'Material Icons';
        font-weight: normal;
        font-style: normal;
        font-size: 24px;  /* Preferred icon size */
        display: inline-block;
        line-height: 1;
        text-transform: none;
        letter-spacing: normal;
        word-wrap: normal;
        white-space: nowrap;
        direction: ltr;
      
        /* Support for all WebKit browsers. */
        -webkit-font-smoothing: antialiased;
        /* Support for Safari and Chrome. */
        text-rendering: optimizeLegibility;
      
        /* Support for Firefox. */
        -moz-osx-font-smoothing: grayscale;
      
        /* Support for IE. */
        font-feature-settings: 'liga';
      }

      .icon-font.outline {
        font-family: 'Material Icons Outlined';
      }
    </style><link href="/codedoc/docs/assets/codedoc-styles.css" rel="stylesheet"><script async="" defer="" src="/codedoc/docs/assets/codedoc-bundle.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css" integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq" crossorigin="anonymous"></head><body data-path="docs\Knowledge\PowerShell\basics\PowerShell Objekt erweitern - 2 einfache Möglichkeiten.md"><div class="header-0-0-6"><script async="" defer="" src="https://buttons.github.io/buttons.js"></script><a class="github-button" data-color-scheme="no-preference: light; light: light; dark: dark;" data-icon="false" data-show-count="true" data-size="false" href="https://github.com/In-Pro-Org/codedoc/">Star</a><br><br><a class="watermark-0-0-5" href="https://github.com/CONNECT-platform/codedoc" target="_blank">Created With<svg viewBox="0 0 536 296" version="1.1" xmlns="http://www.w3.org/2000/svg"><g id="codedoc" transform="translate(-244.000000, -364.000000)" fill-rule="nonzero"><path d="M580,532 C615.346224,532 644,560.653776 644,596 C644,631.346224 615.346224,660 580,660 C544.653776,660 516,631.346224 516,596 C516,560.653776 544.653776,532 580,532 Z M716,532 C751.346224,532 780,560.653776 780,596 C780,631.346224 751.346224,660 716,660 L692,660 C687.581722,660 684,656.418278 684,652 C684,647.581722 687.581722,644 692,644 L716,644 C742.509668,644 764,622.509668 764,596 C764,569.490332 742.509668,548 716,548 L692,548 C687.581722,548 684,544.418278 684,540 C684,535.581722 687.581722,532 692,532 L716,532 Z M468,532 C472.418278,532 476,535.581722 476,540 L476,652 C476,656.418278 472.418278,660 468,660 L444,660 C408.653776,660 380,631.346224 380,596 C380,560.653776 408.653776,532 444,532 L468,532 Z M332,532 C336.418278,532 340,535.581722 340,540 L340,652 C340,656.418278 336.418278,660 332,660 L252,660 C247.581722,660 244,656.418278 244,652 L244,540 C244,535.581722 247.581722,532 252,532 L332,532 Z M580,548 C553.490332,548 532,569.490332 532,596 C532,622.509668 553.490332,644 580,644 C606.509668,644 628,622.509668 628,596 C628,569.490332 606.509668,548 580,548 Z M461,548 L444,548 C417.490332,548 396,569.490332 396,596 C396,622.509668 417.490332,644 444,644 L461,644 L461,548 Z M444,364 C479.346224,364 508,392.653776 508,428 C508,463.346224 479.346224,492 444,492 C408.653776,492 380,463.346224 380,428 C380,392.653776 408.653776,364 444,364 Z M332,364 C336.418278,364 340,367.581722 340,372 C340,376.418278 336.418278,380 332,380 L308,380 C281.490332,380 260,401.490332 260,428 C260,454.509668 281.490332,476 308,476 L332,476 C336.418278,476 340,479.581722 340,484 C340,488.418278 336.418278,492 332,492 L308,492 C272.653776,492 244,463.346224 244,428 C244,392.653776 272.653776,364 308,364 L332,364 Z M580,364 C615.346224,364 644,392.653776 644,428 C644,463.346224 615.346224,492 580,492 L556,492 C551.581722,492 548,488.418278 548,484 L548,372 C548,367.581722 551.581722,364 556,364 L580,364 Z M772,364 C776.418278,364 780,367.581722 780,372 C780,376.418278 776.418278,380 772,380 L700,380 L700,420 L772,420 C776.418278,420 780,423.581722 780,428 C780,432.418278 776.418278,436 772,436 L700,436 L700,476 L772,476 C776.418278,476 780,479.581722 780,484 C780,488.418278 776.418278,492 772,492 L692,492 C687.581722,492 684,488.418278 684,484 L684,372 C684,367.581722 687.581722,364 692,364 L772,364 Z M444,380 C417.490332,380 396,401.490332 396,428 C396,454.509668 417.490332,476 444,476 C470.509668,476 492,454.509668 492,428 C492,401.490332 470.509668,380 444,380 Z M580,380 L563,380 L563,476 L580,476 C606.509668,476 628,454.509668 628,428 C628,401.490332 606.509668,380 580,380 Z"></path></g></svg></a></div><div id="-codedoc-container" class="container"><h1 id="powershell-objekt-erweitern---2-einfache-möglichkeiten" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>PowerShell Objekt erweitern - 2 einfache Möglichkeiten</h1><marker><!-- vscode-markdown-toc -->
</marker><ul><li><ol><li><a href="#berblick">Überblick</a></li></ol></li><li><ol><li><a href="#ObjektMemberanalysieren">Objekt Member analysieren</a></li></ol></li><li><ol><li><a href="#VierMglichkeiteneigeneObjektezuerschaffen">Vier Möglichkeiten eigene Objekte zu erschaffen</a><ul><li>3.1. <a href="#PSCustomObjectperHashTableerzeugen">PSCustomObject per HashTable erzeugen</a></li><li>3.2. <a href="#PSCustomObjectperAdd-Membererzeugen">PSCustomObject per Add-Member erzeugen</a></li><li>3.3. <a href="#EigeneTypen-DefinitionperPowerShell">Eigene Typen-Definition per PowerShell</a></li><li>3.4. <a href="#EigeneTypen-DefinitionperC">Eigene Typen-Definition per C#</a></li></ul></li></ol></li><li><ol><li><a href="#Epilog">Epilog</a></li></ol></li></ul><marker><!-- vscode-markdown-toc-config
    numbering=true
    autoSave=true
    /vscode-markdown-toc-config -->
</marker><marker><!-- /vscode-markdown-toc -->

</marker><h2 id="1-überblick" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>1. <a></a>Überblick</h2><p>Die <a href="https://de.wikipedia.org/wiki/Objektorientierte_Programmierung">objektorientierte Programmierung</a> (OOP) ist ein, nicht wegzudenkender Bestandteil der PowerShell. Wenn wir mit Objekten in der Shell arbeiten, nutzen wir deren Eigenschaften und Methoden, um Werte auszulesen oder Aktionen auszulösen. Dieser Informations- und Actionsumfang (Member =&gt; Eigenschaften, Methoden und Ereignisse) ist auf den jeweiligen Objekt-Typ beschränkt.</p><p>Diese Objekt-Erweiterung ist immer dann sinnvoll, <strong>wenn wir zusätzliche Daten über die Pipe transportieren wollen</strong> oder dauerhaft in der Sitzung eigene Aktionen in Objekten anstoßen möchten.</p><p>Neben vorhanden Objekte können neue Objekte über den Typ <code>[PSCustomObject]</code> erzeugt werden. Dieses leere Objekt kann, um einen Satz von eigenen Eigenschaften und Ereignisse ergänzt werden.</p><p>Mit <code>Add-Member</code> können Sie ein konkretes Objekt, um neue Eigenschaften und Methoden ergänzen. Mit <code>Update-TypeData</code> können Sie einen Typen in der aktuellen Session ergänzen, so dass alle Objekte von diesem Typ von der Erweiterung profitieren können. Das sind 2 einfache Möglichkeiten der Objekt-Erweiterung, um Individualität im Pipeline-Fluss zu bekommen.</p><p><img src="images/PowerShell-Objekt-Erweitern-Beispiel-1.png" alt=""></p><blockquote><p>TIPP - Zwei weitere spannende Artikel die gut zu diesem Thema passen sind: "<a href="https://attilakrick.com/powershell/powershell-tutorial/">PowerShell Einstieg für Anfänger und Profis</a>" "<a href="https://attilakrick.com/powershell/powershell-objekt-analyse/">PowerShell Objekte in 3 Schritten erfolgreich analysieren</a>", und "<a href="https://attilakrick.com/powershell/funktionsweise-powershell-pipeline/">PowerShell Pipeline Sinn &amp; Nutzen erklärt</a>".</p></blockquote><h2 id="2-objekt-member-analysieren" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>2. <a></a>Objekt Member analysieren</h2><p>Zuerst versschafen wir uns einen Überblick (IST-Aufnahme), <strong>welche Eigenschaften, Methoden und Ereignisse ein Object besitzt</strong>. U.a. erfahren wir auch so, wie das Objekt bereits für die PowerShell erweitert wurde.</p><p><img src="images/PowerShell-MemberTypes.png" alt=""></p><p>Die folgende Code-Zeile ...</p><pre class=""><code class="powershell -codedoc-code-snippet code-0-0-12" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span></span></span><div class="line-0-0-16  -codedoc-code-line" data-content="Get-Process | Get-Member -View 'Adapted'" id="code1-l1"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">1<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token function">Get-Process</span> <span class="token punctuation">|</span> <span class="token function">Get-Member</span> <span class="token operator">-</span>View <span class="token string">'Adapted'</span></div><br></code></pre><p>... zeigt eine Liste von Eigenschaften, Methoden und Ereignisse die native (<code>Adapted</code>) im .NET-Typen <code>[System.Diagnostics.Process]</code> implementiert wurden. Das heißt dass diese Member in jeder .NET Programmiersprache aber auch in der PowerShell zur Verfügung steht und seitens <a href="https://docs.microsoft.com/de-de/dotnet/api/system.diagnostics.process">Microsoft supported und dokumentiert</a> wird.</p><p>Neben diesen nativen .NET-Eigenschaften, -Methoden und -Ereignisse lassen wir uns nun die Member anzeigen die <strong>bereits per PowerShell Erweiterungen hinzugefügt <code>Extended</code> wurden</strong>.</p><pre class=""><code class="powershell -codedoc-code-snippet code-0-0-12" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span></span></span><div class="line-0-0-16  -codedoc-code-line" data-content="Get-Process | Get-Member -View 'Extended'" id="code2-l1"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">1<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token function">Get-Process</span> <span class="token punctuation">|</span> <span class="token function">Get-Member</span> <span class="token operator">-</span>View <span class="token string">'Extended'</span></div><br></code></pre><p>Diese Member können nur in der PowerShell gesehen und verwendet werden.</p><p>Hier nun eine Zusammenfassung gruppiert nach Eigenschaften, Methoden und Ereignisse-Typ:</p><pre class=""><code class="powershell -codedoc-code-snippet code-0-0-12" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span></span></span><div class="line-0-0-16  -codedoc-code-line" data-content="Get-Process | Get-Member -View 'All' | Group-Object -Property 'MemberType' -NoElement | Sort-Object -Property 'Count' -Descending" id="code3-l1"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">1<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token function">Get-Process</span> <span class="token punctuation">|</span> <span class="token function">Get-Member</span> <span class="token operator">-</span>View <span class="token string">'All'</span> <span class="token punctuation">|</span> <span class="token function">Group-Object</span> <span class="token operator">-</span>Property <span class="token string">'MemberType'</span> <span class="token operator">-</span>NoElement <span class="token punctuation">|</span> <span class="token function">Sort-Object</span> <span class="token operator">-</span>Property <span class="token string">'Count'</span> <span class="token operator">-</span>Descending</div><br></code></pre><blockquote><p>TIPP - Wenn Sie mehrt über Objekt-Analyse verstehen wollen, dann lesen Sie: <a href="https://attilakrick.com/powershell/powershell-objekt-analyse/">PowerShell Objekte in 3 Schritten erfolgreich analysieren</a>.</p></blockquote><p><strong>Wenn nun die benötigte Eigenschaft oder Methode nicht vorhanden ist?</strong> Kein Problem! Das Typen-System der PowerShell ist flexibel. Wir ergänzen das aktuelle Objekt mit <code>Add-Member</code>. Dieses Verfahren hat den Vorteil, dass wir nicht komplett neue Typen definieren müssen und so redundanten Code implementieren würden.</p><p>Vorhandene Objekte oder eigene Objekte, um weitere Member zu erweitern ist immer dann sinnvoll, wenn a) weitere Daten oder Aktionen "huckepack" tranportiert werden sollen oder b) Objekte aus unterschiedlichen anderen Objekten und Informationen zusammengeführt werden sollen.</p><p>Ein Objekt kann auf unterschiedlichste Weise erweitert werden. Zum Beispiel soll in einem Anwendungsfall das Ergebnis unmittelbar nach der Berechnung einmalig in eine neue <code>NoteProperty</code>-Eigenschaft gespeichert werden. In einem anderen Fall erfolgt diese Berechnung jedes Mal beim Lesen der zuvor neu geschaffenen <code>ScriptProperty</code>-Eigenschaft. Folgende Objekt Erweiterungen stehen zur Verfügung:</p><table><thead><th>Art</th><th>Beschreibung</th></thead><tbody><tr><td><code>AliasProperty</code></td><td>Alias-Eigenschaft für eine andere vorhandene Property.</td></tr><tr><td><code>NoteProperty</code></td><td>Eine einfache Read/Write Property.</td></tr><tr><td><code>ScriptProperty</code></td><td>ScriptBlock-Code der jedesmal beim Lesen der Eigenschaft ausgeführt wird.</td></tr><tr><td><code>PropertySet</code></td><td>Eine Gruppe von Properties die über den Set-Namen angesprochen wird.</td></tr><tr><td><code>ScriptMethode</code></td><td>ScriptBlock-Code der beim Aufruf ausgeführt wird inkl. Argumenten-Übergabe</td></tr></tbody></table><p>Um Objekte erweitern zu können verwende ich für den weiteren Verlauf ein Windows Dienst-Objekt <code>$spooler</code>:</p><pre class=""><code class="powershell -codedoc-code-snippet code-0-0-12" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span></span></span><div class="line-0-0-16  -codedoc-code-line" data-content="$spooler = Get-Service -Name 'Spooler'" id="code4-l1"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">1<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token variable">$spooler</span> = <span class="token function">Get-Service</span> <span class="token operator">-</span>Name <span class="token string">'Spooler'</span></div><br></code></pre><p>Das <code>$p1</code>-Objekt wird nun um einen <code>NoteProperty</code>-, <code>ScriptProperty</code>- und <code>ScriptMethod</code>-Member erweitert:</p><pre class="with-bar"><code class="powershell -codedoc-code-snippet code-0-0-12" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span></span></span><div class="line-0-0-16  -codedoc-code-line" data-content="# ? Dem Dienst-Objekt eine NoteProperty hinzufügen" id="code5-l1"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">1<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token comment"># ? Dem Dienst-Objekt eine NoteProperty hinzufügen</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="$spooler | Add-Member -Name 'HelpdeskAufgabe' -Value 'Der Spooler muss immer laufen und bei Problem Dienst neu starten.' -MemberType 'NoteProperty'" id="code5-l2"><span class="lineCounter-0-0-13 -codedoc-line-counter">2<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token variable">$spooler</span> <span class="token punctuation">|</span> <span class="token function">Add-Member</span> <span class="token operator">-</span>Name <span class="token string">'HelpdeskAufgabe'</span> <span class="token operator">-</span>Value <span class="token string">'Der Spooler muss immer laufen und bei Problem Dienst neu starten.'</span> <span class="token operator">-</span>MemberType <span class="token string">'NoteProperty'</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="" id="code5-l3"><span class="lineCounter-0-0-13 -codedoc-line-counter">3<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="# ? Dem Dienst-Objekt eine ScriptProperty hinzufügen" id="code5-l4"><span class="lineCounter-0-0-13 -codedoc-line-counter">4<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token comment"># ? Dem Dienst-Objekt eine ScriptProperty hinzufügen</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="$spooler | Add-Member -Name 'ProzessId' -Value { Get-CimInstance -ClassName 'Win32_Service' -Filter &quot;Name LIKE '$($this.ServiceName)'&quot; | Select-Object -ExpandProperty 'ProcessId' } -MemberType 'ScriptProperty'" id="code5-l5"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">5<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token variable">$spooler</span> <span class="token punctuation">|</span> <span class="token function">Add-Member</span> <span class="token operator">-</span>Name <span class="token string">'ProzessId'</span> <span class="token operator">-</span>Value <span class="token punctuation">{</span> <span class="token function">Get-CimInstance</span> <span class="token operator">-</span>ClassName <span class="token string">'Win32_Service'</span> <span class="token operator">-</span><span class="token keyword">Filter</span> <span class="token string">"Name LIKE '<span class="token function">$<span class="token punctuation">(</span><span class="token variable">$this</span><span class="token punctuation">.</span>ServiceName<span class="token punctuation">)</span></span>'"</span> <span class="token punctuation">|</span> <span class="token function">Select-Object</span> <span class="token operator">-</span>ExpandProperty <span class="token string">'ProcessId'</span> <span class="token punctuation">}</span> <span class="token operator">-</span>MemberType <span class="token string">'ScriptProperty'</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="$spooler | Add-Member -Name 'Laufzeit' -Value { Get-Process -Id $this.ProzessId | Select-Object -ExpandProperty 'StartTime' | New-TimeSpan } -MemberType 'ScriptProperty'" id="code5-l6"><span class="lineCounter-0-0-13 -codedoc-line-counter">6<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token variable">$spooler</span> <span class="token punctuation">|</span> <span class="token function">Add-Member</span> <span class="token operator">-</span>Name <span class="token string">'Laufzeit'</span> <span class="token operator">-</span>Value <span class="token punctuation">{</span> <span class="token function">Get-Process</span> <span class="token operator">-</span>Id <span class="token variable">$this</span><span class="token punctuation">.</span>ProzessId <span class="token punctuation">|</span> <span class="token function">Select-Object</span> <span class="token operator">-</span>ExpandProperty <span class="token string">'StartTime'</span> <span class="token punctuation">|</span> <span class="token function">New-TimeSpan</span> <span class="token punctuation">}</span> <span class="token operator">-</span>MemberType <span class="token string">'ScriptProperty'</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="" id="code5-l7"><span class="lineCounter-0-0-13 -codedoc-line-counter">7<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="# ? Dem Dienst-Objekt eine ScriptMethod hinzufügen" id="code5-l8"><span class="lineCounter-0-0-13 -codedoc-line-counter">8<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token comment"># ? Dem Dienst-Objekt eine ScriptMethod hinzufügen</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="$spooler | Add-Member -Name 'Restart' -Value { $this.Stop() ; $this.Start() } -MemberType 'ScriptMethod'" id="code5-l9"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">9<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token variable">$spooler</span> <span class="token punctuation">|</span> <span class="token function">Add-Member</span> <span class="token operator">-</span>Name <span class="token string">'Restart'</span> <span class="token operator">-</span>Value <span class="token punctuation">{</span> <span class="token variable">$this</span><span class="token punctuation">.</span>Stop<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">;</span> <span class="token variable">$this</span><span class="token punctuation">.</span><span class="token function">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span> <span class="token operator">-</span>MemberType <span class="token string">'ScriptMethod'</span></div><br></code></pre><p>Jetzt können wir die neuen Objekt-Erweiterung verwenden:</p><pre class="with-bar"><code class="powershell -codedoc-code-snippet code-0-0-12" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span></span></span><div class="line-0-0-16  -codedoc-code-line" data-content="# ? Die neuen Properties und Methods anzeigen" id="code6-l1"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">1<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token comment"># ? Die neuen Properties und Methods anzeigen</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="$spooler | Get-Member -View 'Extended'" id="code6-l2"><span class="lineCounter-0-0-13 -codedoc-line-counter">2<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token variable">$spooler</span> <span class="token punctuation">|</span> <span class="token function">Get-Member</span> <span class="token operator">-</span>View <span class="token string">'Extended'</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="" id="code6-l3"><span class="lineCounter-0-0-13 -codedoc-line-counter">3<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="# * Beispiel testen:" id="code6-l4"><span class="lineCounter-0-0-13 -codedoc-line-counter">4<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token comment"># * Beispiel testen:</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="$spooler.HelpdeskAufgabe # ? NoteProperty   aufrufen => statisches Datum" id="code6-l5"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">5<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token variable">$spooler</span><span class="token punctuation">.</span>HelpdeskAufgabe <span class="token comment"># ? NoteProperty   aufrufen =&gt; statisches Datum</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="$spooler.ProzessId       # ? ScriptProperty aufrufen => dynamisches Datum" id="code6-l6"><span class="lineCounter-0-0-13 -codedoc-line-counter">6<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token variable">$spooler</span><span class="token punctuation">.</span>ProzessId       <span class="token comment"># ? ScriptProperty aufrufen =&gt; dynamisches Datum</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="$spooler.Laufzeit        # ? ScriptProperty aufrufen => dynamisches Datum" id="code6-l7"><span class="lineCounter-0-0-13 -codedoc-line-counter">7<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token variable">$spooler</span><span class="token punctuation">.</span>Laufzeit        <span class="token comment"># ? ScriptProperty aufrufen =&gt; dynamisches Datum</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="$spooler.Restart()       # ? ScriptMethod   aufrufen => dynamisches Datum" id="code6-l8"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">8<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token variable">$spooler</span><span class="token punctuation">.</span>Restart<span class="token punctuation">(</span><span class="token punctuation">)</span>       <span class="token comment"># ? ScriptMethod   aufrufen =&gt; dynamisches Datum</span></div><br></code></pre><p>Hier ein anderes Beispiel einer ScriptMethod-Erweiterung. Die neue Methode <code>SyncCreationLastTime</code> nimmt ein <code>datetime</code>-Objekt als Argument entgegen:</p><pre class="with-bar"><code class="powershell -codedoc-code-snippet code-0-0-12" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span></span></span><div class="line-0-0-16  -codedoc-code-line" data-content="$datei = New-Item -Path 'C:\temp\Test.txt' -Force" id="code7-l1"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">1<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token variable">$datei</span> = <span class="token function">New-Item</span> <span class="token operator">-</span>Path <span class="token string">'C:\temp\Test.txt'</span> <span class="token operator">-</span>Force</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="$datei | Add-Member -Name 'SyncCreationLastTime' -Value {" id="code7-l2"><span class="lineCounter-0-0-13 -codedoc-line-counter">2<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token variable">$datei</span> <span class="token punctuation">|</span> <span class="token function">Add-Member</span> <span class="token operator">-</span>Name <span class="token string">'SyncCreationLastTime'</span> <span class="token operator">-</span>Value <span class="token punctuation">{</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="        param(" id="code7-l3"><span class="lineCounter-0-0-13 -codedoc-line-counter">3<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>        <span class="token keyword">param</span><span class="token punctuation">(</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="            [datetime]$newDateTime" id="code7-l4"><span class="lineCounter-0-0-13 -codedoc-line-counter">4<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>            <span class="token namespace">[datetime]</span><span class="token variable">$newDateTime</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="        )" id="code7-l5"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">5<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>        <span class="token punctuation">)</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="        $this.CreationTime   = $newDateTime" id="code7-l6"><span class="lineCounter-0-0-13 -codedoc-line-counter">6<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>        <span class="token variable">$this</span><span class="token punctuation">.</span>CreationTime   = <span class="token variable">$newDateTime</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="        $this.LastWriteTime  = $newDateTime" id="code7-l7"><span class="lineCounter-0-0-13 -codedoc-line-counter">7<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>        <span class="token variable">$this</span><span class="token punctuation">.</span>LastWriteTime  = <span class="token variable">$newDateTime</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="        $this.LastAccessTime = $newDateTime" id="code7-l8"><span class="lineCounter-0-0-13 -codedoc-line-counter">8<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>        <span class="token variable">$this</span><span class="token punctuation">.</span>LastAccessTime = <span class="token variable">$newDateTime</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="    } -MemberType 'ScriptMethod'" id="code7-l9"><span class="lineCounter-0-0-13 -codedoc-line-counter">9<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span class="token punctuation">}</span> <span class="token operator">-</span>MemberType <span class="token string">'ScriptMethod'</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="$datei.SyncCreationLastTime('2020-12-31')" id="code7-l10"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">10<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token variable">$datei</span><span class="token punctuation">.</span>SyncCreationLastTime<span class="token punctuation">(</span><span class="token string">'2020-12-31'</span><span class="token punctuation">)</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="$datei | Select-Object -Property Name, CreationTime, LastWriteTime, LastAccessTime" id="code7-l11"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">11<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token variable">$datei</span> <span class="token punctuation">|</span> <span class="token function">Select-Object</span> <span class="token operator">-</span>Property Name<span class="token punctuation">,</span> CreationTime<span class="token punctuation">,</span> LastWriteTime<span class="token punctuation">,</span> LastAccessTime</div><br></code></pre><p><strong>Wie können sämtliche Objekte eines Typs erweitert werden?.</strong> Bis hierhin erweiterte <code>Add-Member</code> nur die Objekte direkt in der Pipeline oder eine Variable. Sollte jedoch Pipeline-Übergreifend sämtliche Objekte von einem Typ in der aktuellen Session erweitert werden, so müssen wir dies anders implementieren. In diesem Fall nehmen wir die Objekt Erweiterung direkt am Typ mittels <code>Update-TypeData</code> vor. Diese Art der Erweiterung wirkt sich nur in der Session auf alle Objekte vom gleichen Typ aus.</p><pre class="with-bar"><code class="powershell -codedoc-code-snippet code-0-0-12" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span></span></span><div class="line-0-0-16  -codedoc-code-line" data-content="# ? Session-weite Erweiterungen" id="code8-l1"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">1<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token comment"># ? Session-weite Erweiterungen</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="Update-TypeData -TypeName 'System.Diagnostics.Process' -MemberName 'WorkingSet64MB' -Value { [int]($this.WorkingSet64 / 1MB) } -MemberType 'ScriptProperty' -Force" id="code8-l2"><span class="lineCounter-0-0-13 -codedoc-line-counter">2<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token function">Update-TypeData</span> <span class="token operator">-</span>TypeName <span class="token string">'System.Diagnostics.Process'</span> <span class="token operator">-</span>MemberName <span class="token string">'WorkingSet64MB'</span> <span class="token operator">-</span>Value <span class="token punctuation">{</span> <span class="token namespace">[int]</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token punctuation">.</span>WorkingSet64 <span class="token operator">/</span> 1MB<span class="token punctuation">)</span> <span class="token punctuation">}</span> <span class="token operator">-</span>MemberType <span class="token string">'ScriptProperty'</span> <span class="token operator">-</span>Force</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="" id="code8-l3"><span class="lineCounter-0-0-13 -codedoc-line-counter">3<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="# ? Alle Process-Objects haben jetzt eine neue Property WorkingSet64MB" id="code8-l4"><span class="lineCounter-0-0-13 -codedoc-line-counter">4<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token comment"># ? Alle Process-Objects haben jetzt eine neue Property WorkingSet64MB</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="Get-Process | Get-Member -View 'Extended'" id="code8-l5"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">5<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token function">Get-Process</span> <span class="token punctuation">|</span> <span class="token function">Get-Member</span> <span class="token operator">-</span>View <span class="token string">'Extended'</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="Get-Process | Select-Object -Property 'Name', 'WorkingSet64MB'" id="code8-l6"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">6<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token function">Get-Process</span> <span class="token punctuation">|</span> <span class="token function">Select-Object</span> <span class="token operator">-</span>Property <span class="token string">'Name'</span><span class="token punctuation">,</span> <span class="token string">'WorkingSet64MB'</span></div><br></code></pre><p>Im folgenden Beispiel sollen alle Objects der PowerShell eine Methode <code>OpenTypeNameSearch</code> bekommen. Wird diese Methode aufgerufen öffnet sich im Browser die Google-Suche die nach dem konkreten Typennamen sucht, um so mehr über diesen Typ in Erfahrung zu bringen.</p><pre class="with-bar"><code class="powershell -codedoc-code-snippet code-0-0-12" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span></span></span><div class="line-0-0-16  -codedoc-code-line" data-content="Update-TypeData -TypeName 'System.Object' -MemberName 'OpenTypeNameSearch' -MemberType 'ScriptMethod' -Force -Value {" id="code9-l1"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">1<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token function">Update-TypeData</span> <span class="token operator">-</span>TypeName <span class="token string">'System.Object'</span> <span class="token operator">-</span>MemberName <span class="token string">'OpenTypeNameSearch'</span> <span class="token operator">-</span>MemberType <span class="token string">'ScriptMethod'</span> <span class="token operator">-</span>Force <span class="token operator">-</span>Value <span class="token punctuation">{</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="    $FullTypeName = $this.GetType().FullName" id="code9-l2"><span class="lineCounter-0-0-13 -codedoc-line-counter">2<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span class="token variable">$FullTypeName</span> = <span class="token variable">$this</span><span class="token punctuation">.</span>GetType<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>FullName</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="    $SearchUrl = &quot;https://www.google.com/search?q=$FullTypeName&quot;" id="code9-l3"><span class="lineCounter-0-0-13 -codedoc-line-counter">3<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span class="token variable">$SearchUrl</span> = <span class="token string">"https://www.google.com/search?q=<span class="token variable">$FullTypeName</span>"</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="    Start-Process -FilePath $SearchUrl" id="code9-l4"><span class="lineCounter-0-0-13 -codedoc-line-counter">4<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span class="token function">Start-Process</span> <span class="token operator">-</span>FilePath <span class="token variable">$SearchUrl</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="}" id="code9-l5"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">5<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token punctuation">}</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="" id="code9-l6"><span class="lineCounter-0-0-13 -codedoc-line-counter">6<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="# .OpenTypeNameSearch() testen" id="code9-l7"><span class="lineCounter-0-0-13 -codedoc-line-counter">7<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token comment"># .OpenTypeNameSearch() testen</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="" id="code9-l8"><span class="lineCounter-0-0-13 -codedoc-line-counter">8<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="$p1 = Get-Process | Select-Object -First 1" id="code9-l9"><span class="lineCounter-0-0-13 -codedoc-line-counter">9<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token variable">$p1</span> = <span class="token function">Get-Process</span> <span class="token punctuation">|</span> <span class="token function">Select-Object</span> <span class="token operator">-</span>First 1</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="$p1.OpenTypeNameSearch() # Google-Suche nach System.Diagnostics.Process startet" id="code9-l10"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">10<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token variable">$p1</span><span class="token punctuation">.</span>OpenTypeNameSearch<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># Google-Suche nach System.Diagnostics.Process startet</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="" id="code9-l11"><span class="lineCounter-0-0-13 -codedoc-line-counter">11<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="$s1 = Get-Service | Select-Object -First 1" id="code9-l12"><span class="lineCounter-0-0-13 -codedoc-line-counter">12<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token variable">$s1</span> = <span class="token function">Get-Service</span> <span class="token punctuation">|</span> <span class="token function">Select-Object</span> <span class="token operator">-</span>First 1</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="$s1.OpenTypeNameSearch() # Google-Suche nach System.ServiceProcess.ServiceController" id="code9-l13"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">13<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token variable">$s1</span><span class="token punctuation">.</span>OpenTypeNameSearch<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># Google-Suche nach System.ServiceProcess.ServiceController</span></div><br></code></pre><p>In diesem Beispiel wird der Type <code>[System.Object]</code> bereichert. Sämtliche anderen Typen wurden früher oder später von Object abgeleitet was zu folge hat das die Methode <code>OpenTypeNameSearch</code> an allen Objekten, egal von welchem Typ vorhanden ist.</p><p><img src="images/PowerShell-Update-TypeData.png" alt=""></p><h2 id="3-vier-möglichkeiten-eigene-objekte-zu-erschaffen" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>3. <a></a>Vier Möglichkeiten eigene Objekte zu erschaffen</h2><p>Die oben beschriebenen Methoden kürzen vorhandene Objekte, um deren Member und fügen eigene Member hinzu so dass der ursprüngliche Sinn des Typen verloren geht. Im weiteren Verlauf der Objektverwertung können die Objekte nicht mehr auseinander gehalterden werden. In kurzen Pipeline-Verknüpfung-Ketten ist, das noch ein legitimes Mittel aber darüber hinauskommt, der Wunsch auf eigene Typen kreieren zu können. Hierzu stehen uns 4 Möglichkeiten zur Verfügung.</p><ul><li><code>PSCustomObject</code> per <code>HashTable</code> erzeugen</li><li><code>PSCustomObject</code> per <code>Add-Member</code> erzeugen</li><li>Eigene Typen-Definition per PowerShell</li><li>Eigene Typen-Definition per C#</li></ul><h3 id="31-pscustomobject-per-hashtable-erzeugen" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>3.1. <a></a>PSCustomObject per HashTable erzeugen</h3><p>Ein effizienter Weg, um einfache Daten-Transport-Container schnell zu erschaffen ist das Konvertieren eines <code>HashTable</code>-Objekte in ein <code>PSCustomObject</code>-Objekt.</p><p><strong>Nachteile:</strong></p><ol><li>Unterschiedlich erzeugte <code>PSCustomObject</code>-Objekte können nicht auseinandergehalten werden.</li><li>Methoden und und Script-Eigenschaften können nicht implementiert werden.</li></ol><pre class="with-bar"><code class="powershell -codedoc-code-snippet code-0-0-12" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span></span></span><div class="line-0-0-16  -codedoc-code-line" data-content="# PSCustomObject erzeugen" id="code10-l1"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">1<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token comment"># PSCustomObject erzeugen</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="$PassivesObjekt = [PSCustomObject]@{" id="code10-l2"><span class="lineCounter-0-0-13 -codedoc-line-counter">2<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token variable">$PassivesObjekt</span> = <span class="token namespace">[PSCustomObject]</span>@<span class="token punctuation">{</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="    Ermittler      = 'Attila Krick'" id="code10-l3"><span class="lineCounter-0-0-13 -codedoc-line-counter">3<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    Ermittler      = <span class="token string">'Attila Krick'</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="    ComputerName   = $env:COMPUTERNAME" id="code10-l4"><span class="lineCounter-0-0-13 -codedoc-line-counter">4<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    ComputerName   = <span class="token variable">$env</span>:COMPUTERNAME</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="    ErstelltAm     = ( Get-Date )" id="code10-l5"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">5<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    ErstelltAm     = <span class="token punctuation">(</span> <span class="token function">Get-Date</span> <span class="token punctuation">)</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="    BelegterRam    = [int]((Get-Process | Measure-Object -Property WorkingSet64 -Sum | Select-Object -ExpandProperty Sum) / 1GB)" id="code10-l6"><span class="lineCounter-0-0-13 -codedoc-line-counter">6<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    BelegterRam    = <span class="token namespace">[int]</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">Get-Process</span> <span class="token punctuation">|</span> <span class="token function">Measure-Object</span> <span class="token operator">-</span>Property WorkingSet64 <span class="token operator">-</span>Sum <span class="token punctuation">|</span> <span class="token function">Select-Object</span> <span class="token operator">-</span>ExpandProperty Sum<span class="token punctuation">)</span> <span class="token operator">/</span> 1GB<span class="token punctuation">)</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="    AktiveProzesse = Get-Process" id="code10-l7"><span class="lineCounter-0-0-13 -codedoc-line-counter">7<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    AktiveProzesse = <span class="token function">Get-Process</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="}" id="code10-l8"><span class="lineCounter-0-0-13 -codedoc-line-counter">8<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token punctuation">}</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="" id="code10-l9"><span class="lineCounter-0-0-13 -codedoc-line-counter">9<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="# PSCustomObject nutzen" id="code10-l10"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">10<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token comment"># PSCustomObject nutzen</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="$PassivesObjekt | Get-Member" id="code10-l11"><span class="lineCounter-0-0-13 -codedoc-line-counter">11<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token variable">$PassivesObjekt</span> <span class="token punctuation">|</span> <span class="token function">Get-Member</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="$PassivesObjekt.Ermittler" id="code10-l12"><span class="lineCounter-0-0-13 -codedoc-line-counter">12<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token variable">$PassivesObjekt</span><span class="token punctuation">.</span>Ermittler</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="$PassivesObjekt.ComputerName" id="code10-l13"><span class="lineCounter-0-0-13 -codedoc-line-counter">13<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token variable">$PassivesObjekt</span><span class="token punctuation">.</span>ComputerName</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="$PassivesObjekt.ErstelltAm" id="code10-l14"><span class="lineCounter-0-0-13 -codedoc-line-counter">14<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token variable">$PassivesObjekt</span><span class="token punctuation">.</span>ErstelltAm</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="$PassivesObjekt.BelegterRam" id="code10-l15"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">15<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token variable">$PassivesObjekt</span><span class="token punctuation">.</span>BelegterRam</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="$PassivesObjekt.AktiveProzesse" id="code10-l16"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">16<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token variable">$PassivesObjekt</span><span class="token punctuation">.</span>AktiveProzesse</div><br></code></pre><h3 id="32-pscustomobject-per-add-member-erzeugen" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>3.2. <a></a>PSCustomObject per Add-Member erzeugen</h3><p>Die resultierenden Objekte sind identisch wie bei 1.. Zusätzlich können wir die <code>PSCustomObject</code>-Objekte mittels <code>Add-Member</code>, um dynamischen Member wie <code>ScriptProperty</code> und <code>ScriptMethod</code> bereichern.</p><p><strong>Nachteile:</strong></p><ol><li>Siehe Nachteile A.</li><li>Erhöhter Erstellungsaufwand.</li><li>Lesbarkeit könnte leide da Komplexer und Abstrakter.</li></ol><pre class="with-bar"><code class="powershell -codedoc-code-snippet code-0-0-12" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span></span></span><div class="line-0-0-16  -codedoc-code-line" data-content="# PSCustomObject erzeugen" id="code11-l1"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">1<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token comment"># PSCustomObject erzeugen</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="$AktivesObjekt = New-Object -TypeName 'PSCustomObject'" id="code11-l2"><span class="lineCounter-0-0-13 -codedoc-line-counter">2<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token variable">$AktivesObjekt</span> = <span class="token function">New-Object</span> <span class="token operator">-</span>TypeName <span class="token string">'PSCustomObject'</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="$AktivesObjekt | Add-Member -Name 'ErstelltAm' -MemberType 'NoteProperty' -Value ( Get-Date )" id="code11-l3"><span class="lineCounter-0-0-13 -codedoc-line-counter">3<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token variable">$AktivesObjekt</span> <span class="token punctuation">|</span> <span class="token function">Add-Member</span> <span class="token operator">-</span>Name <span class="token string">'ErstelltAm'</span> <span class="token operator">-</span>MemberType <span class="token string">'NoteProperty'</span> <span class="token operator">-</span>Value <span class="token punctuation">(</span> <span class="token function">Get-Date</span> <span class="token punctuation">)</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="$AktivesObjekt | Add-Member -Name 'JetztIst' -MemberType 'ScriptProperty' -Value { Get-Date }" id="code11-l4"><span class="lineCounter-0-0-13 -codedoc-line-counter">4<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token variable">$AktivesObjekt</span> <span class="token punctuation">|</span> <span class="token function">Add-Member</span> <span class="token operator">-</span>Name <span class="token string">'JetztIst'</span> <span class="token operator">-</span>MemberType <span class="token string">'ScriptProperty'</span> <span class="token operator">-</span>Value <span class="token punctuation">{</span> <span class="token function">Get-Date</span> <span class="token punctuation">}</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="$AktivesObjekt | Add-Member -Name 'PasswortGenerieren' -MemberType 'ScriptMethod' -Value {" id="code11-l5"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">5<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token variable">$AktivesObjekt</span> <span class="token punctuation">|</span> <span class="token function">Add-Member</span> <span class="token operator">-</span>Name <span class="token string">'PasswortGenerieren'</span> <span class="token operator">-</span>MemberType <span class="token string">'ScriptMethod'</span> <span class="token operator">-</span>Value <span class="token punctuation">{</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="    param([Byte]$AnzahlZeichen = 10)" id="code11-l6"><span class="lineCounter-0-0-13 -codedoc-line-counter">6<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span class="token keyword">param</span><span class="token punctuation">(</span><span class="token namespace">[Byte]</span><span class="token variable">$AnzahlZeichen</span> = 10<span class="token punctuation">)</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="    return [Convert]::ToBase64String((0..255 | Get-Random -Count 255)).SubString(0, $AnzahlZeichen)" id="code11-l7"><span class="lineCounter-0-0-13 -codedoc-line-counter">7<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span class="token keyword">return</span> <span class="token namespace">[Convert]</span>::ToBase64String<span class="token punctuation">(</span><span class="token punctuation">(</span>0<span class="token punctuation">.</span><span class="token punctuation">.</span>255 <span class="token punctuation">|</span> <span class="token function">Get-Random</span> <span class="token operator">-</span>Count 255<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>SubString<span class="token punctuation">(</span>0<span class="token punctuation">,</span> <span class="token variable">$AnzahlZeichen</span><span class="token punctuation">)</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="}" id="code11-l8"><span class="lineCounter-0-0-13 -codedoc-line-counter">8<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token punctuation">}</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="" id="code11-l9"><span class="lineCounter-0-0-13 -codedoc-line-counter">9<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="# PSCustomObject nutzen" id="code11-l10"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">10<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token comment"># PSCustomObject nutzen</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="$AktivesObjekt | Get-Member" id="code11-l11"><span class="lineCounter-0-0-13 -codedoc-line-counter">11<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token variable">$AktivesObjekt</span> <span class="token punctuation">|</span> <span class="token function">Get-Member</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="$AktivesObjekt.ErstelltAm" id="code11-l12"><span class="lineCounter-0-0-13 -codedoc-line-counter">12<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token variable">$AktivesObjekt</span><span class="token punctuation">.</span>ErstelltAm</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="$AktivesObjekt.JetztIst" id="code11-l13"><span class="lineCounter-0-0-13 -codedoc-line-counter">13<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token variable">$AktivesObjekt</span><span class="token punctuation">.</span>JetztIst</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="$AktivesObjekt.PasswortGenerieren(12)" id="code11-l14"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">14<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token variable">$AktivesObjekt</span><span class="token punctuation">.</span>PasswortGenerieren<span class="token punctuation">(</span>12<span class="token punctuation">)</span></div><br></code></pre><h3 id="33-eigene-typen-definition-per-powershell" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>3.3. <a></a>Eigene Typen-Definition per PowerShell</h3><p>Per Definition können einfache Klassen erzeugt werden die Eigenschaften und Methoden besitzen. Anschließend können Objekte erzeugt werden, die sich klar von anderen Objekten und deren Typen abgrenzen. Weiterhin ist nur ein geringes Grundverständnis der objektorientierten Programmierung (OOP) nötig. Alles was Sie dazu benötigen finden Sie unter: <code>Get-Help -Name 'about_Classes' -ShowWindow</code>.</p><p><strong>Nachteil:</strong></p><ol><li>Es stehen nicht alle Möglichkeiten der OOP für diese Art der Implementierung zur Verfügung.</li></ol><pre class="with-bar"><code class="powershell -codedoc-code-snippet code-0-0-12" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span></span></span><div class="line-0-0-16  -codedoc-code-line" data-content="# Eigene Klasse XAkte definieren" id="code12-l1"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">1<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token comment"># Eigene Klasse XAkte definieren</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="class XAkte {" id="code12-l2"><span class="lineCounter-0-0-13 -codedoc-line-counter">2<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token keyword">class</span> XAkte <span class="token punctuation">{</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="" id="code12-l3"><span class="lineCounter-0-0-13 -codedoc-line-counter">3<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="    # Private Variable" id="code12-l4"><span class="lineCounter-0-0-13 -codedoc-line-counter">4<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span class="token comment"># Private Variable</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="    # Nur innerhalb des Objektes, kann auf sie zugegriffen werden." id="code12-l5"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">5<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span class="token comment"># Nur innerhalb des Objektes, kann auf sie zugegriffen werden.</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="    hidden [string]$_Titel" id="code12-l6"><span class="lineCounter-0-0-13 -codedoc-line-counter">6<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    hidden <span class="token namespace">[string]</span><span class="token variable">$_Titel</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="" id="code12-l7"><span class="lineCounter-0-0-13 -codedoc-line-counter">7<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="    # Eine Read/Write-Property vom Typ Byte" id="code12-l8"><span class="lineCounter-0-0-13 -codedoc-line-counter">8<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span class="token comment"># Eine Read/Write-Property vom Typ Byte</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="    # mit einem gültigen Wertbereich von 10 bis 100 und dem Default-Wert 10." id="code12-l9"><span class="lineCounter-0-0-13 -codedoc-line-counter">9<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span class="token comment"># mit einem gültigen Wertbereich von 10 bis 100 und dem Default-Wert 10.</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="    [ValidateRange(10, 1000)]" id="code12-l10"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">10<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span class="token namespace">[ValidateRange(10, 1000)]</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="    [Byte]$AufwandStunden = 10" id="code12-l11"><span class="lineCounter-0-0-13 -codedoc-line-counter">11<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span class="token namespace">[Byte]</span><span class="token variable">$AufwandStunden</span> = 10</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="" id="code12-l12"><span class="lineCounter-0-0-13 -codedoc-line-counter">12<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="    # Konstruktor" id="code12-l13"><span class="lineCounter-0-0-13 -codedoc-line-counter">13<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span class="token comment"># Konstruktor</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="    # Code der einmalig beim Erzeugen eines neuen Objektes ausgeführt wird." id="code12-l14"><span class="lineCounter-0-0-13 -codedoc-line-counter">14<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span class="token comment"># Code der einmalig beim Erzeugen eines neuen Objektes ausgeführt wird.</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="    XAkte([string]$titel) {" id="code12-l15"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">15<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    XAkte<span class="token punctuation">(</span><span class="token namespace">[string]</span><span class="token variable">$titel</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="        $this._Titel = $titel" id="code12-l16"><span class="lineCounter-0-0-13 -codedoc-line-counter">16<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>        <span class="token variable">$this</span><span class="token punctuation">.</span>_Titel = <span class="token variable">$titel</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="    }" id="code12-l17"><span class="lineCounter-0-0-13 -codedoc-line-counter">17<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span class="token punctuation">}</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="" id="code12-l18"><span class="lineCounter-0-0-13 -codedoc-line-counter">18<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="    # Eine Methode mit Rückgabe" id="code12-l19"><span class="lineCounter-0-0-13 -codedoc-line-counter">19<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span class="token comment"># Eine Methode mit Rückgabe</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="    # und ohne Argumenten Übergabe." id="code12-l20"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">20<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span class="token comment"># und ohne Argumenten Übergabe.</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="    [string]GetTitel() {" id="code12-l21"><span class="lineCounter-0-0-13 -codedoc-line-counter">21<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span class="token namespace">[string]</span>GetTitel<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="        return $this._Titel" id="code12-l22"><span class="lineCounter-0-0-13 -codedoc-line-counter">22<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token punctuation">.</span>_Titel</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="    }" id="code12-l23"><span class="lineCounter-0-0-13 -codedoc-line-counter">23<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span class="token punctuation">}</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="" id="code12-l24"><span class="lineCounter-0-0-13 -codedoc-line-counter">24<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="    # Eine Methode mit Argumenten Übergabe" id="code12-l25"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">25<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span class="token comment"># Eine Methode mit Argumenten Übergabe</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="    # und ohne Rückgabe." id="code12-l26"><span class="lineCounter-0-0-13 -codedoc-line-counter">26<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span class="token comment"># und ohne Rückgabe.</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="    [void]AkteSchließen([string]$autorisierungcode) {" id="code12-l27"><span class="lineCounter-0-0-13 -codedoc-line-counter">27<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span class="token namespace">[void]</span>AkteSchließen<span class="token punctuation">(</span><span class="token namespace">[string]</span><span class="token variable">$autorisierungcode</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="        &quot;Die XAkte $($this._Titel) wurde am $(Get-Date -Format 'dd.MM.yyyy') nach $($this.AufwandStunden) Stunden geschlossen. Autorisierungcode: $autorisierungcode&quot; | Add-Content -Path 'C:\Temp\XAkten.log'" id="code12-l28"><span class="lineCounter-0-0-13 -codedoc-line-counter">28<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>        <span class="token string">"Die XAkte <span class="token function">$<span class="token punctuation">(</span><span class="token variable">$this</span><span class="token punctuation">.</span>_Titel<span class="token punctuation">)</span></span> wurde am <span class="token function">$<span class="token punctuation">(</span><span class="token function">Get-Date</span> <span class="token operator">-</span>Format <span class="token string">'dd.MM.yyyy'</span><span class="token punctuation">)</span></span> nach <span class="token function">$<span class="token punctuation">(</span><span class="token variable">$this</span><span class="token punctuation">.</span>AufwandStunden<span class="token punctuation">)</span></span> Stunden geschlossen. Autorisierungcode: <span class="token variable">$autorisierungcode</span>"</span> <span class="token punctuation">|</span> <span class="token function">Add-Content</span> <span class="token operator">-</span>Path <span class="token string">'C:\Temp\XAkten.log'</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="    }" id="code12-l29"><span class="lineCounter-0-0-13 -codedoc-line-counter">29<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    <span class="token punctuation">}</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="}" id="code12-l30"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">30<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token punctuation">}</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="" id="code12-l31"><span class="lineCounter-0-0-13 -codedoc-line-counter">31<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="# XAkte-Objekt(e) nutzen" id="code12-l32"><span class="lineCounter-0-0-13 -codedoc-line-counter">32<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token comment"># XAkte-Objekt(e) nutzen</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="$x = [XAkte]::new('TH34X')" id="code12-l33"><span class="lineCounter-0-0-13 -codedoc-line-counter">33<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token variable">$x</span> = <span class="token namespace">[XAkte]</span>::new<span class="token punctuation">(</span><span class="token string">'TH34X'</span><span class="token punctuation">)</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="$x.AufwandStunden = 99" id="code12-l34"><span class="lineCounter-0-0-13 -codedoc-line-counter">34<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token variable">$x</span><span class="token punctuation">.</span>AufwandStunden = 99</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="'Titel der $x XAkte ist {0}' -f $x.GetTitel() | Write-Warning" id="code12-l35"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">35<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token string">'Titel der $x XAkte ist {0}'</span> <span class="token operator">-</span>f <span class="token variable">$x</span><span class="token punctuation">.</span>GetTitel<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">|</span> <span class="token function">Write-Warning</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="$x.AkteSchließen('08-15-47-11')" id="code12-l36"><span class="lineCounter-0-0-13 -codedoc-line-counter">36<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token variable">$x</span><span class="token punctuation">.</span>AkteSchließen<span class="token punctuation">(</span><span class="token string">'08-15-47-11'</span><span class="token punctuation">)</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="Get-Content -Path 'C:\Temp\XAkten.log'" id="code12-l37"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">37<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token function">Get-Content</span> <span class="token operator">-</span>Path <span class="token string">'C:\Temp\XAkten.log'</span></div><br></code></pre><h3 id="34-eigene-typen-definition-per-c" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>3.4. <a></a>Eigene Typen-Definition per C#</h3><p>Per C#-Definition können komplexe Klassen erzeugt werden die Eigenschaften, Methoden, Ereignisse etc. besitzen. Anschließend können Objekte erzeugt werden, die sich klar von anderen Objekten und deren Typen abgrenzen. Es stehen <strong>ALLE Möglichkeiten der OOP</strong> für diese Art der Implementierung zur Verfügung.</p><p><strong>Nachteile:</strong></p><ol><li>Es ein ausführliches Wissen der objektorientierten Programmierung (OOP) nötig.</li><li>Die Entwicklung solch einer komplexen Klasse benötigt eine C# Entwicklungsumgebung.</li></ol><pre class="with-bar"><code class="powershell -codedoc-code-snippet code-0-0-12" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span></span></span><div class="line-0-0-16  -codedoc-code-line" data-content="Add-Type -Language 'CSharp' -TypeDefinition @'" id="code13-l1"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">1<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token function">Add-Type</span> <span class="token operator">-</span>Language <span class="token string">'CSharp'</span> <span class="token operator">-</span>TypeDefinition @<span class="token string">'</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="using System;" id="code13-l2"><span class="lineCounter-0-0-13 -codedoc-line-counter">2<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>using System;</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="" id="code13-l3"><span class="lineCounter-0-0-13 -codedoc-line-counter">3<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="public class YAkte" id="code13-l4"><span class="lineCounter-0-0-13 -codedoc-line-counter">4<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>public class YAkte</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="{" id="code13-l5"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">5<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>{</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="    // Private Variable (Feld)" id="code13-l6"><span class="lineCounter-0-0-13 -codedoc-line-counter">6<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    // Private Variable (Feld)</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="    // Nur innerhalb des Objektes, kann auf sie zugegriffen werden." id="code13-l7"><span class="lineCounter-0-0-13 -codedoc-line-counter">7<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    // Nur innerhalb des Objektes, kann auf sie zugegriffen werden.</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="    private byte _AufwandStunden = 10;" id="code13-l8"><span class="lineCounter-0-0-13 -codedoc-line-counter">8<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    private byte _AufwandStunden = 10;</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="" id="code13-l9"><span class="lineCounter-0-0-13 -codedoc-line-counter">9<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="    // Eine Read/Write-Property vom Typ Byte" id="code13-l10"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">10<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    // Eine Read/Write-Property vom Typ Byte</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="    // mit einem gültigen Wertbereich von 10 bis 100 und dem Default-Wert 10" id="code13-l11"><span class="lineCounter-0-0-13 -codedoc-line-counter">11<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    // mit einem gültigen Wertbereich von 10 bis 100 und dem Default-Wert 10</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="    // sowie das nur Stunden hinzugebucht aber nicht abgezogen werden können." id="code13-l12"><span class="lineCounter-0-0-13 -codedoc-line-counter">12<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    // sowie das nur Stunden hinzugebucht aber nicht abgezogen werden können.</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="    public byte AufwandStunden" id="code13-l13"><span class="lineCounter-0-0-13 -codedoc-line-counter">13<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    public byte AufwandStunden</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="    {" id="code13-l14"><span class="lineCounter-0-0-13 -codedoc-line-counter">14<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    {</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="        get { return _AufwandStunden; }" id="code13-l15"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">15<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>        get { return _AufwandStunden; }</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="        set" id="code13-l16"><span class="lineCounter-0-0-13 -codedoc-line-counter">16<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>        set</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="        {" id="code13-l17"><span class="lineCounter-0-0-13 -codedoc-line-counter">17<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>        {</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="            if (value < _AufwandStunden)" id="code13-l18"><span class="lineCounter-0-0-13 -codedoc-line-counter">18<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>            if (value &lt; _AufwandStunden)</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="                throw new ArgumentOutOfRangeException(&quot;value&quot;, &quot;Der Stunden-Aufwand kann nachträglich nicht vermindert werden.&quot;);" id="code13-l19"><span class="lineCounter-0-0-13 -codedoc-line-counter">19<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>                throw new ArgumentOutOfRangeException("value", "Der Stunden-Aufwand kann nachträglich nicht vermindert werden.");</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="            if (value < 10 || value > 100)" id="code13-l20"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">20<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>            if (value &lt; 10 || value &gt; 100)</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="                throw new ArgumentOutOfRangeException(&quot;value&quot;, &quot;Der Stunden-Aufwand muss >= 10 und <= 100 Stunden sein.&quot;);" id="code13-l21"><span class="lineCounter-0-0-13 -codedoc-line-counter">21<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>                throw new ArgumentOutOfRangeException("value", "Der Stunden-Aufwand muss &gt;= 10 und &lt;= 100 Stunden sein.");</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="            _AufwandStunden = value;" id="code13-l22"><span class="lineCounter-0-0-13 -codedoc-line-counter">22<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>            _AufwandStunden = value;</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="        }" id="code13-l23"><span class="lineCounter-0-0-13 -codedoc-line-counter">23<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>        }</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="    }" id="code13-l24"><span class="lineCounter-0-0-13 -codedoc-line-counter">24<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    }</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="" id="code13-l25"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">25<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="    // Eine ReadOnly-Property vom Typ String" id="code13-l26"><span class="lineCounter-0-0-13 -codedoc-line-counter">26<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    // Eine ReadOnly-Property vom Typ String</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="    public string Titel { get; private set; }" id="code13-l27"><span class="lineCounter-0-0-13 -codedoc-line-counter">27<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    public string Titel { get; private set; }</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="" id="code13-l28"><span class="lineCounter-0-0-13 -codedoc-line-counter">28<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="    // Konstruktor" id="code13-l29"><span class="lineCounter-0-0-13 -codedoc-line-counter">29<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    // Konstruktor</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="    // Code der einmalig beim Erzeugen eins neuen Objekts ausgeführt wird." id="code13-l30"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">30<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    // Code der einmalig beim Erzeugen eins neuen Objekts ausgeführt wird.</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="    public YAkte(string titel)" id="code13-l31"><span class="lineCounter-0-0-13 -codedoc-line-counter">31<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    public YAkte(string titel)</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="    {" id="code13-l32"><span class="lineCounter-0-0-13 -codedoc-line-counter">32<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    {</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="        Titel = titel;" id="code13-l33"><span class="lineCounter-0-0-13 -codedoc-line-counter">33<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>        Titel = titel;</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="    }" id="code13-l34"><span class="lineCounter-0-0-13 -codedoc-line-counter">34<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>    }</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="}" id="code13-l35"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">35<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>}</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="'@" id="code13-l36"><span class="lineCounter-0-0-13 -codedoc-line-counter">36<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span>'@</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="" id="code13-l37"><span class="lineCounter-0-0-13 -codedoc-line-counter">37<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="# YAkte-Objekt(e) nutzen" id="code13-l38"><span class="lineCounter-0-0-13 -codedoc-line-counter">38<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token comment"># YAkte-Objekt(e) nutzen</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="$y = [YAkte]::new('DF88G')" id="code13-l39"><span class="lineCounter-0-0-13 -codedoc-line-counter">39<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token variable">$y</span> = <span class="token namespace">[YAkte]</span>::new<span class="token punctuation">(</span><span class="token string">'DF88G'</span><span class="token punctuation">)</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="$y.AufwandStunden = 11" id="code13-l40"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">40<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token variable">$y</span><span class="token punctuation">.</span>AufwandStunden = 11</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="$y.AufwandStunden = 10 # ! Nicht möglich" id="code13-l41"><span class="lineCounter-0-0-13 -codedoc-line-counter">41<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token variable">$y</span><span class="token punctuation">.</span>AufwandStunden = 10 <span class="token comment"># ! Nicht möglich</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="'Titel der $y YAkte ist {0}' -f $y.Titel | Write-Warning" id="code13-l42"><span class="lineCounter-0-0-13 -codedoc-line-counter">42<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token string">'Titel der $y YAkte ist {0}'</span> <span class="token operator">-</span>f <span class="token variable">$y</span><span class="token punctuation">.</span>Titel <span class="token punctuation">|</span> <span class="token function">Write-Warning</span></div><br><div class="line-0-0-16  -codedoc-code-line" data-content="$y.Titel = 'Neuer Titel' # ! Nicht möglich" id="code13-l43"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">43<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token variable">$y</span><span class="token punctuation">.</span>Titel = <span class="token string">'Neuer Titel'</span> <span class="token comment"># ! Nicht möglich</span></div><br></code></pre><h2 id="4-epilog" class="heading-0-0-1"><span class="anchor-0-0-2" data-ignore-text=""><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span>4. <a></a>Epilog</h2><p>Wollen Sie dauerhaft von diesen Typen-Erweiterungen profitieren so könnten Sie diesen Code in einer der <code>profile.ps1</code> Dateien speichern:</p><pre class="with-bar"><code class="powershell -codedoc-code-snippet code-0-0-12" tabindex="0"><span class="wmbar-0-0-17"><span></span><span></span><span></span><span></span></span><div class="line-0-0-16  -codedoc-code-line" data-content="$profile.AllUsersAllHosts" id="code14-l1"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">1<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token variable">$profile</span><span class="token punctuation">.</span>AllUsersAllHosts</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="$profile.AllUsersCurrentHost" id="code14-l2"><span class="lineCounter-0-0-13 -codedoc-line-counter">2<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token variable">$profile</span><span class="token punctuation">.</span>AllUsersCurrentHost</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="$profile.CurrentUserAllHosts" id="code14-l3"><span class="lineCounter-0-0-13 -codedoc-line-counter">3<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token variable">$profile</span><span class="token punctuation">.</span>CurrentUserAllHosts</div><br><div class="line-0-0-16  -codedoc-code-line" data-content="$profile.CurrentUserCurrentHost" id="code14-l4"><span class="lineCounter-0-0-13 prim -codedoc-line-counter">4<span class="-codedoc-line-link"><span class="icon-font" data-ignore-text="" style="vertical-align: sub">link</span></span></span><span class="token variable">$profile</span><span class="token punctuation">.</span>CurrentUserCurrentHost</div><br></code></pre><p>Oder Sie implementieren den Code in ein eigenes Modul (<code>.PSM1</code>).</p><div class="contentnav-0-0-11" data-no-search=""><a href="#powershell-objekt-erweitern---2-einfache-möglichkeiten" class="h1" data-content-highlight="powershell-objekt-erweitern---2-einfache-möglichkeiten">PowerShell Objekt erweitern - 2 einfache Möglichkeiten</a><a href="#1-überblick" class="h2" data-content-highlight="1-überblick">1. Überblick</a><a href="#2-objekt-member-analysieren" class="h2" data-content-highlight="2-objekt-member-analysieren">2. Objekt Member analysieren</a><a href="#3-vier-möglichkeiten-eigene-objekte-zu-erschaffen" class="h2" data-content-highlight="3-vier-möglichkeiten-eigene-objekte-zu-erschaffen">3. Vier Möglichkeiten eigene Objekte zu erschaffen</a><a href="#31-pscustomobject-per-hashtable-erzeugen" class="h3" data-content-highlight="31-pscustomobject-per-hashtable-erzeugen">3.1. PSCustomObject per HashTable erzeugen</a><a href="#32-pscustomobject-per-add-member-erzeugen" class="h3" data-content-highlight="32-pscustomobject-per-add-member-erzeugen">3.2. PSCustomObject per Add-Member erzeugen</a><a href="#33-eigene-typen-definition-per-powershell" class="h3" data-content-highlight="33-eigene-typen-definition-per-powershell">3.3. Eigene Typen-Definition per PowerShell</a><a href="#34-eigene-typen-definition-per-c" class="h3" data-content-highlight="34-eigene-typen-definition-per-c">3.4. Eigene Typen-Definition per C#</a><a href="#4-epilog" class="h2" data-content-highlight="4-epilog">4. Epilog</a></div></div><div id="-codedoc-toc" class="toc-0-0-8"><div class="content-0-0-9"><div class="heading-0-0-3">Index</div><p><a href="/codedoc/">Home</a>
<a href="/codedoc/README">Index</a>
<a href="/codedoc/docs/Kostwein">Kostwein</a></p><div class="collapse-0-0-4 "><script id="sPBBsSSptZ">(function(){function load(){if (window.__sdh_transport){window.__sdh_transport("sPBBsSSptZ", "yAdNJkOJGbj52dvfV+HpdQ==", {});} }; if (document.readyState == 'complete') load(); else window.addEventListener('load', load); window.setImmediate = window.setImmediate || function(f){setTimeout(f, 0)}; })()</script><div class="label" onclick="this.parentElement.classList.toggle('open')"><span class="text">PSModulesHelp</span><span class="icon-font closed">chevron_right</span></div><div class="content"><p><a href="/codedoc/docs/PSModulesHelp/ModuleDoku">PS Modules Help</a></p><hr></div></div><div class="collapse-0-0-4 "><script id="V_qPNaIJDo">(function(){function load(){if (window.__sdh_transport){window.__sdh_transport("V_qPNaIJDo", "yAdNJkOJGbj52dvfV+HpdQ==", {});} }; if (document.readyState == 'complete') load(); else window.addEventListener('load', load); window.setImmediate = window.setImmediate || function(f){setTimeout(f, 0)}; })()</script><div class="label" onclick="this.parentElement.classList.toggle('open')"><span class="text">KnowledgeBase</span><span class="icon-font closed">chevron_right</span></div><div class="content"><blockquote><p><a href="/codedoc/docs/Knowledge/PowerShell/Index">PowerShell</a></p></blockquote></div></div><div class="collapse-0-0-4 "><script id="BENTlvFyIr">(function(){function load(){if (window.__sdh_transport){window.__sdh_transport("BENTlvFyIr", "yAdNJkOJGbj52dvfV+HpdQ==", {});} }; if (document.readyState == 'complete') load(); else window.addEventListener('load', load); window.setImmediate = window.setImmediate || function(f){setTimeout(f, 0)}; })()</script><div class="label" onclick="this.parentElement.classList.toggle('open')"><span class="text">Links</span><span class="icon-font closed">chevron_right</span></div><div class="content"><blockquote><p><a href="/codedoc/docs/Links/LinksWiki">Index</a></p></blockquote></div></div><div class="collapse-0-0-4 "><script id="kXlrhODdaO">(function(){function load(){if (window.__sdh_transport){window.__sdh_transport("kXlrhODdaO", "yAdNJkOJGbj52dvfV+HpdQ==", {});} }; if (document.readyState == 'complete') load(); else window.addEventListener('load', load); window.setImmediate = window.setImmediate || function(f){setTimeout(f, 0)}; })()</script><div class="label" onclick="this.parentElement.classList.toggle('open')"><span class="text">Veeam</span><span class="icon-font closed">chevron_right</span></div><div class="content"><blockquote><p><a href="/codedoc/docs/Knowledge/Veeam/Best%20Practices/index">Best Practices</a></p></blockquote></div></div><p><a href="/codedoc/docs/cheat-sheet">Markdown Cheat Sheet</a>
<a href="/codedoc/docs/code-features">Code Features</a></p><p><br><br></p><p>To add links to your other documents, simply
modify contents of <code>docs/md/_toc.md</code>.</p></div><div class="search-0-0-10"><script id="UDNKwwLok_">(function(){function load(){if (window.__sdh_transport){window.__sdh_transport("UDNKwwLok_", "EKtVWhWp+AfK3O64A4+bOg==", {"repo":"codedoc","user":"In-Pro-Org","root":"docs/md","pick":"\\.md$","drop":"(^_)|(\\/_)"});} }; if (document.readyState == 'complete') load(); else window.addEventListener('load', load); window.setImmediate = window.setImmediate || function(f){setTimeout(f, 0)}; })()</script></div></div><div class="footer-0-0-7"><div class="left"><script id="geqdmrhQOH">(function(){function load(){if (window.__sdh_transport){window.__sdh_transport("geqdmrhQOH", "wCsMx1XMyC4jNi3FxvjU4g==", {});} }; if (document.readyState == 'complete') load(); else window.addEventListener('load', load); window.setImmediate = window.setImmediate || function(f){setTimeout(f, 0)}; })()</script></div><div class="main"><div class="inside"><a href="https://github.com/In-Pro-Org/codedoc/" target="_blank">GitHub</a></div></div><div class="right"><script id="ZBCYH_zFkQ">(function(){function load(){if (window.__sdh_transport){window.__sdh_transport("ZBCYH_zFkQ", "6W59GcSTLBVXRr/Nl/rTkw==", {});} }; if (document.readyState == 'complete') load(); else window.addEventListener('load', load); window.setImmediate = window.setImmediate || function(f){setTimeout(f, 0)}; })()</script></div></div><script id="jufLrbewbF">(function(){function load(){if (window.__sdh_transport){window.__sdh_transport("jufLrbewbF", "zKXJ5zf13oJGCwAAI3JIIA==", {"namespace":"/codedoc"});} }; if (document.readyState == 'complete') load(); else window.addEventListener('load', load); window.setImmediate = window.setImmediate || function(f){setTimeout(f, 0)}; })()</script></body></html>